var tipuesearch = {"pages":[{"title":"Calendars","text":"pre { background-color: #F5F5F5; display: block; font-family: monospace; font-size: 14px; white-space: pre; border-color: #999999; border-width: 1px; border-style: solid; border-radius: 6px; margin: 1em 0; padding: 5px; white-space: pre-wrap; } .containerMain { display: flex; width: 100%; height: 300px; } Select full calendar or weekly schedule tab from the spreadsheet below.","tags":"pages","url":"pages/calendars.html"},{"title":"FAQ","text":"pre { background-color: #F5F5F5; display: block; font-family: monospace; font-size: 14px; white-space: pre; border-color: #999999; border-width: 1px; border-style: solid; border-radius: 6px; margin: 1em 0; padding: 5px; white-space: pre-wrap; } .containerMain { display: flex; width: 100%; height: 300px; } General Does the individual HW mean I have to submit on my own but can I still work with my HW partner? Individual CS109A HW means you are supposed to work on your own, without any human intervention, assistance, or input. You are not allowed to work with partner. You are allowed to use OHs to ask questions, but we may not be able to answer all of your questions or help with all of your coding. You are allowed to use all of your materials from the course up to the HW, look at problem resolution online, and look at libraries documentation. Do I have access to the video recorded materials if I am not an Extension School student? Yes. All CS109A students have access to all video captured materials. Extension School students also have access to live-streaming due to the nature of some members of the student body of that school. If you have any issues accessing the video content, please send an email to our helpline with your name and HUID. Can I access live streaming? Only Harvard Extension School students have access to live-streaming of CS109A lectures, labs, and sections. However, our Friday Standard Section will be live-streamed to all the students that wish to participate in the Helix classroom, so you can attend in person or live online. Can I make-up quizzes? No. Only 50% of quiz grades will count towards your final grade. This policy is to reduce stress and is in place so that missing a quiz on occasion should not affect your final grade. Auditors Can I audit this course? What can I and cannot do? Yes, you are welcome to audit this course and attend lecture, sections and lab. However, auditors should not submit HWs or participate in projects, and should refrain from using any course TF resources that are destined and created for our registered students like Ed. Extension School I am an Extension School Student, can I take the quizzes? And do they count towards my grade? All CS109A students have access to quizzes. If you are a Harvard Extension School student, the quizzes will not be considered towards your final grade. I am an Extension School student, can I attend lectures and OH in person? Yes, as a student from a Harvard School you are welcome to attend all learning instances (lecture, OH, Sections, and Labs) in person. Given the distance nature of the student body of Harvard Extension School, we also provide live streaming and video capture of our learning instances.","tags":"pages","url":"pages/faq.html"},{"title":"Homework Policies & Submission Instructions","text":"pre { background-color: #F5F5F5; display: block; font-family: monospace; font-size: 14px; white-space: pre; border-color: #999999; border-width: 1px; border-style: solid; border-radius: 6px; margin: 1em 0; padding: 5px; white-space: pre-wrap; } .containerMain { display: flex; width: 100%; height: 300px; } V. September 16, 2019 General Policies Colaboration Except for HW4 and HW7 which will be done by each student individually , you're allowed and encouraged to work with a fellow student on the homework. This does not mean that you are to divide and conquer. In the spirit of learning and getting the most out of this course and out of collaborating with your peer, you should solve each problem on your own, compare with your partner, and decide on a common solution. Importing Libraries As much as possible, try and stick to the hints and functions we import at the top of the homework, as those are the ideas and tools the class supports and is aiming to teach. And if a problem specifies a particular library you're required to use that library, and possibly others from the import list. You are allowed to use other libraries such as seaborn. Late Submissions will not be accepted Extensions are provided only for medical reasons with a doctor's note. If there are issues, send an email to the Helpline . Submitting HW Homework assignments will be done in Python in the Jupyter Notebook environment. When you are finished editing your notebook, re-run all the cells to make sure they work . Normally, you need only submit the .ipynb file with one caveat: If your notebook references other files such as images which are necessary for interpreting your work, they must be uploaded as well. You may also choose to \"attach\" the images to the notebook itself. See the section on markdown attachments under \"other additions\" here for details. File Naming Convention Name your file as follows: cs109a_hw#_?09_submit.ipynb (replace the # with the number of the assignment and replace ? with 1 or 2 depending if you are submitting the 109 or 209 hw). Do not include your name in the paper or the filename as we are doing anonymous grading. Making a HW Group in Canvas DO NOT make new groups. Look for an empty group among the pre-made groups for each assignment and join it. Follow instructions below. Click \"People\" in the navbar Click the \"Groups\" tab Type in the search box: \"HW#\" (replace # with the homework number, e.g. HW3) then wait a long time for the groups to load Choose an empty group and have both members in your pair click \"Join\". Again, this must be done before you submit and before the homework deadline. If you haven't joined a group before the homework deadline, we will assume you are working alone. Groups do not persist across assignments. You need to make a group for every assignment. Warning: If you are submitting in a pair: both members must join a Canvas group BEFORE they submit and BEFORE the homework deadline, whichever is earlier. If your group is not in place when you submit or if you submit after the assignment deadline, then you are submitting alone. This is a Canvas limitation. Making a HW Group in Canvas Video","tags":"pages","url":"pages/hw.html"},{"title":"Videos","text":"pre { background-color: #F5F5F5; display: block; font-family: monospace; font-size: 14px; white-space: pre; border-color: #999999; border-width: 1px; border-style: solid; border-radius: 6px; margin: 1em 0; padding: 5px; white-space: pre-wrap; } .containerMain { display: flex; width: 100%; height: 300px; } Lecture recordings can be viewed here","tags":"pages","url":"pages/videos.html"},{"title":"Projects","text":"pre { background-color: #F5F5F5; display: block; font-family: monospace; font-size: 14px; white-space: pre; border-color: #999999; border-width: 1px; border-style: solid; border-radius: 6px; margin: 1em 0; padding: 5px; white-space: pre-wrap; } .containerMain { display: flex; width: 100%; height: 300px; } More material coming soon!","tags":"pages","url":"pages/projects.html"},{"title":"Resources","text":"pre { background-color: #F5F5F5; display: block; font-family: monospace; font-size: 14px; white-space: pre; border-color: #999999; border-width: 1px; border-style: solid; border-radius: 6px; margin: 1em 0; padding: 5px; white-space: pre-wrap; } .containerMain { display: flex; width: 100%; height: 300px; } GitHub Repo Online OH Zoom Link Ed Homework Policies & Submission Instructions Setting up Anaconda & Git for Windows Forking a Repo","tags":"pages","url":"pages/resources.html"},{"title":"Schedule","text":"Week Lecture (Mon) Lecture (Wed) Lab (Thu) Advanced Section (Wed) Assignment (R:Released Tue - D:Due Wed) 1 Lecture 1: What is Data Science? Lab 1: Intro to Python (numpy, graphing libraries, program structure, Jupyter Notebook) R:HW0 2 Lecture 2: Data, Stats, and Visualization Lecture 3: Pandas and Scraping Lab 2: Python: sklearn, matplotlib R:HW1 - D:HW0 3 Lecture 4: Introduction to Regression amd kNN Regression Lecture 5: Linnear Regression, Bootstrap and Confidence Intervals Lab 3: Scikit-learn for Simple Linear Regression Advanced Section 1:: Linear Algebra and Hypothesis Testing R:HW2 - D:HW1 4 Lecture 6: Cross-Validation & Model Selection Lecture 7: Regularization: Ridge & Lasso Lab 4: Multiple Linear Regression and Cross Validation Advanced Section 2: Regularization Methods and Their Justifications R:HW3 - D:HW2 5 Lecture 8: EDA Lecture 9: Visualization for Communication Lab 5: Matplotlib & Seaborn No Advanced Section No Assignment 6 Lecture 10: kNN Classification & Logistic Regression I Lecture 11: Loistic Regression II Lab 6: Logistic Regression Advanced Section 3: Generalized Linear Models R:HW4 (individual) - D:HW3 7 No Lecture (Holiday) Lecture 12: Dealing with Missing Data, Imputation Lab 7: KNN Classification & Imputation No Advanced Section No Assignment 8 Lecture 13: EthiCS Lecture 14: PCA Lab 8: PCA Advanced Section 4: PCA R:HW5 - D:HW4 9 Lecture 15: Classification Trees Lecture 16: Regression Trees, Bagging, & Random Forest Lab 9: Random Forests and Boosting No Advanced Section R:HW6 - D:HW5 10 Lecture 17: Boosting Methods & Stacking Lecture 18: Neural Networks I - Perceptron, Back Propagation, SGD Lab 10: Intro to Neural Networks & Keras No Advanced Section No Assignment 11 Lecture 19: Neural Networks II - NN as Function Approximation; Design Choices Lecture 20: Neural Networks III - Dropout & Regularization Lab 11: Dropout Advanced Section 5: Decision Trees & Ensemble Methods R:HW7 (individual) - D:HW6 12 Lecture 21: Neural Networks IV - Solvers Lecture 22: Visulization for Model Interpretation Lab 12: VIZ Advanced Section 6: SGD No Assignment 13 Lecture 23: Experimental Design & Testing I No Lecture (Thanksgiving) No Lab R:HW8 - D:HW7 [Due on Tuesday] 14 Lecture 24: Experimental Design & Testing II Lab 13: Experimental Design D:HW8 15 Reading Period 16 Finals Week","tags":"pages","url":"pages/schedule.html"},{"title":"Syllabus","text":"pre { background-color: #F5F5F5; display: block; font-family: monospace; font-size: 14px; white-space: pre; border-color: #999999; border-width: 1px; border-style: solid; border-radius: 6px; margin: 1em 0; padding: 5px; white-space: pre-wrap; } .containerMain { display: flex; width: 100%; height: 300px; } Introduction to Data Science CS 109A, STAT 121A, AC 209A, CSCI E-109A Syllabus - Fall 2019 Welcome to CS109a/STAT121a/AC209a, also offered by the DCE as CSCI E-109a, Introduction to Data Science. This course is the first half of a one‐year introduction to data science. The course focuses on the analysis of messy, real life data to perform predictions using statistical and machine learning methods. The material of the course is divided into 3 modules. Each module will integrate the five key facets of an investigation using data: 1. data collection ‐ data wrangling, cleaning, and sampling to get a suitable data set; 2. data management ‐ accessing data quickly and reliably; 3. exploratory data analysis – generating hypotheses and building intuition; 4. prediction or statistical learning; and 5. communication – summarizing results through visualization, stories, and interpretable summaries. Only one of CS 109a, AC 209a, or Stat 121a can be taken for credit. Students who have previously taken CS 109, AC 209, or Stat 121 cannot take CS 109a, AC 209a, or Stat 121a for credit. Course Logistics Prerequisites You are expected to have programming experience at the level of CS 50 or above, and statistics knowledge at the level of Stat 100 or above (Stat 110 recommended). HW0 is designed to test your knowledge on the prerequisites. Successful completion of this assignment will show that this course is suitable for you. HW0 will not be graded but you are required to submit. Course Components Lectures The class consists of two weekly lectures. Lectures are held Mon and Wed 1:30pm ‐ 2:45 pm in Northwest Building (NW), Lecture Hall B-103. Attendance to lectures is mandatory for FAS students. We will have in class quizzes to assess your understanding of the material and to help us identify gaps. Labs Labs are designed as hands-on in-class activities. The instructor will go over practice problems similar to the homework problems and review difficult material. Attendance to labs is optional but strongly encouraged . Lab sessions are held Thur 4:30-5:45 pm in Pierce 301 . Sections Lectures and labs are supplemented by 1 hour sections led by teaching fellows. There are two types of sections: a) Standard Sections : which will be a mix of review of material and practice problems similar to the HW Standard Sections are held Fri 10:30-11:45 am at 1 Story St. Room 306 and Mon 4:30-5:45 pm in Science Center 110 Note: Sections are not held every week. Consult the course calendar for exact dates. The material covered on Friday and Monday is identical. b) Advanced Sections which will cover advanced topics like the mathematical underpinnings of the methods seen in lecture and lab and extensions of those methods. The material covered in the Advanced Sections is required for all AC 209A students. Advanced Sections are held Weds 4:30-5:45 pm at Maxwell Dworkin G115 Note: Advanced Sections are not held every week. Consult the course calendar for exact dates. Video Recordings All learning instances—lectures, labs, and sections—will be recorded. DCE students can stream these events in real time with a TF monitoring the accompanying chat room. Recordings will then be made available to all students within 24 hours via Canvas. Instructor Office Hours Pavlos & Kevin : Monday 3-5pm, IACS lobby Chris : Wednesday 3-4pm, Maxwell-Dworkin B125 Assignments There will be an initial self-assessment homework called HW0 and 8 more graded homework assignments. Some of them will be due in a week (1, 2, 5, 8) and some of them in two weeks (3, 4, 6, 7). You have the option to work and submit in pairs for all the assignments except HW4 and HW7 which you will do individually. You will be working in Jupyter Notebooks which you can run in your own environment or in the SEAS JupyterHub cloud. Instructions for Setting up Your Environment Instructions for Using JupyterHub On weeks with new assignments they will be released by Wednesday 3 pm. Standard assignments are graded out of 5 points. AC209a students will have additional homework content for most assignments worth 1 point. Quizzes Quizzes will be taken at the end of class and the material will be based on what was discussed in lecture; there will be no AC209a content in the quizzes. DCE students' quizzes will not count toward their final grade. 50% of the quizzes will be dropped from your grade. Final Project There will be a final group project (2-4 students) due during Exams period. See Calendar for specific dates. Participation Students as expected to be actively engaged with the course. This includes: attending lectures making use of resources such as office hours, labs, and sections participating in the Ed discussion forum — both through asking thoughtful questions and by answering the questions of others DCE students will not be penalized for the inability to attend lectures, labs, etc. live. Recommended Textbook An Introduction to Statistical Learning by James, Witten, Hastie, Tibshirani. The book is available here: Free electronic version : http://www-bcf.usc.edu/~gareth/ISL/ (Links to an external site). HOLLIS : http://link.springer.com.ezp-prod1.hul.harvard.edu/book/10.1007%2F978-1-4614-7138-7 Amazon: https://www.amazon.com/Introduction-Statistical-Learning-Applications-Statistics/dp/1461471370 (Links to an external site) . Course Policies Getting Help For questions about homework, course content, package installation, JupyterHub, and after you have tried to troubleshoot yourselves, the process to get help is: 1. Post the question in Ed and hopefully your peers will answer. Note that in Ed questions are visible to everyone. The TFs monitor the posts. 2. Go to Office Hours , this is the best way to get help. 3. For private matters send an email to the Helpline: cs109a2019@gmail.com . The Helpline is monitored by TFs. 4. For personal and confidential matters send an email to the instructors . Grading Guidelines and Regrading Policy Homework will be graded based on: 1. How correct your code is (the Notebook cells should run, we are not troubleshooting code) 2. How you have interpreted the results — we want text not just code. It should be a report. 3. How well you present the results. The scale is 1-5. For more details, check out The CS109A Grade . Questions on Graded Homework and Regrading Policy We take great care in making sure all homework assignments are graded properly. However, if you find that your assignment has grading oversights/errors you may: Contact the grader by emailing the helpline with subject line \"Regrade HW1: Grader=johnsmith\" within 48 hours of the grade release (the grader's name can be found at the end of your notebook). If still unsatisfied with first regrading outcome, you may submit a reason via email to the Helpline with subject line \"Regrade HW1: Second request\" within 2 days of receiving the initial regarding response. NOTE: once regrading is done, you may receive a grade that could be lower than the initial grade. Collaboration Policy We encourage you to talk and discuss the assignments with your fellow students (and on Piazza), but you are not allowed to look at any other student's assignment or code outside of your pair. Discussion is encouraged; copying is not allowed. Please refer to the Academic Honesty section in The CS109A Grade . Late Day Policy Homework is due on Wednesdays. There are no late days. Late submissions will not be accepted. Communication from Staff to Students Class announcements will be through Canvas . All homework and quizzes will be posted and submitted through Canvas, as well as all feedback forms. NOTE: make sure you adjust your account settings so you can receive emails from Canvas. Submitting an assignment Please consult Homework Policies & Submission Instructions Course Grade Your final score for the course will be computed using the following weights: Non-Extension Students Assignment Final Grade Weight Homework0 1% Paired Homework (6) 39% Individual Homework (2) 17 % Quizzes 10% Project 30% Participation 3% Total 100% Extension Students Assignment Final Grade Weight Homework0 1% Paired Homework (6) 43% Individual Homework (2) 19% Project 33% Participation 4% Total 100% Software We will be using Jupyter Notebooks, Python 3, and various python modules. You can access the notebook viewer either on your own machine by installing the Anaconda platform (Links to an external site) which includes Jupyter/IPython as well all packages that will be required for the course, or by using the SEAS JupyterHub from Canvas. Details in class. Accommodations for Students with Disabilities Students needing academic adjustments or accommodations because of a documented disability must present their Faculty Letter from the Accessible Education Office (AEO) and speak with Kevin by the end of the third week of the term: Friday, September 15. Failure to do so may result in us being unable to respond in a timely manner. All discussions will remain confidential. Diversity and Inclusion Statement Data Science, like many fields of science, has historically only been represented by a small sliver of the population. This is despite some of the early computer scientist pioneers being women (see Ada Lovelace and Grace Hopper for two examples). Recent initiatives have attempted to overcome some barriers to entry: Made /w Code . We would like to attempt to discuss diversity in data science from time to time where appropriate and possible. Please contact us (in person or electronically) or submit anonymous feedback if you have any suggestions to improve the diversity of the course materials. Furthermore, we would like to create a learning environment for our students that supports a diversity of thoughts, perspectives and experiences, and honors your identities (including race, gender, class, sexuality, religion, ability, etc.) To help accomplish this:If you have a name and/or set of pronouns that differ from those that appear in your official Harvard records, please let us know! If you feel like your performance in the class is being impacted by your experiences outside of class, please don't hesitate to come and talk with us. We want to be a resource for you. Remember that you can also submit anonymous feedback (which will lead to me making a general announcement to the class, if necessary to address your concerns). If you prefer to speak with someone outside of the course, you may find helpful resources at the Harvard Office of Diversity and Inclusion. We (like many people) are still in the process of learning about diverse perspectives and identities. If something was said in class (by anyone) that made you feel uncomfortable, please talk to us about it. (Again, anonymous feedback is always an option.) As a participant in course discussions, you should also strive to honor the diversity of your classmates. Academic Honesty Ethical behavior is an important trait of a Data Scientist, from ethically handling data to attribution of code and work of others. Thus, in CS109 we give a strong emphasis to Academic Honesty. As a student your best guidelines are to be reasonable and fair. We encourage teamwork for problem sets and allow submission in pairs for most problem sets, but you should not split the homework and you should work on all the problems together. For more detailed expectations, please refer to the Academic Honesty section in The CS109A Grade .","tags":"pages","url":"pages/syllabus.html"},{"title":"S-Section 02: kNN and Linear Regression","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Standard Section 2: kNN and Linear Regression Harvard University Fall 2019 Instructors : Pavlos Protopapas, Kevin Rader, and Chris Tanner Section Leaders : Marios Mattheakis, Abhimanyu (Abhi) Vasishth, Robbert (Rob) Struyven In [ ]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"http://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) For this section, our goal is to get you familiarized with k-Nearest Neighbors (kNN) and Linear Regression. We have learned how some aspects of dealing with data (loading in data files, scraping data from the web, visualizing data) and now we're moving to data modeling. Specifically, we will: Load in the Bikeshare dataset Do some basic exploratory data analysis (EDA) of the dataset Split it into a training and test dataset and understand why this is needed Learn to use kNN using the sklearn package (bonus: we will also look at writing the algorithm without sklearn) Learn to use the statsmodels and sklearn packages for Linear Regression. Learn about confidence intervals and how to extract them. For this section we will be using the following packages: In [ ]: #Matrices, Dataframe and Plotting Operations import numpy as np import pandas as pd import seaborn as sns import matplotlib import matplotlib.pyplot as plt % matplotlib inline Working with Dataframes Load in the Bikeshare dataset and perform EDA: The task is to build a regression model for a bike share system to predict the total number of bike rentals in a given day , based on attributes about the day. Such a demand forecasting model would be useful in planning the number of bikes that need to be available in the system on any given day, and also in monitoring traffic in the city. The data for this problem was collected from the Capital Bikeshare program in Washington D.C. over two years. The data set is provided in the file 'bikeshare.csv'. Each row in these files contains 10 attributes describing a day and its weather. Description of variables season (1 = spring, 2 = summer, 3 = fall, 4 = winter) month (1 through 12, with 1 denoting Jan) holiday (1 = the day is a holiday, 0 = otherwise) day_of_week (0 through 6, with 0 denoting Sunday) workingday (1 = the day is neither a holiday or weekend, 0 = otherwise) weather 1: Clear, Few clouds, Partly cloudy, Partly cloudy 2: Mist + Cloudy, Mist + Broken clouds, Mist + Few clouds, Mist 3: Light Snow, Light Rain + Thunderstorm + Scattered clouds, Light Rain + Scattered clouds 4: Heavy Rain + Ice Pallets + Thunderstorm + Mist, Snow + Fog temp (temperature in Celsius) atemp (apparent, or relative outdoor, or real feel temperature, in Celsius) humidity (relative humidity) windspeed (wind speed) count (response variable i.e. total number of bike rentals on the day) Load the BikeShare dataset and drop the unnecessary columns In [ ]: bikeshare = pd . read_csv ( '../data/bikeshare.csv' ) . drop ( columns = [ 'Unnamed: 0' ]) print ( \"Length of Dataset:\" , len ( bikeshare )) display ( bikeshare . head ()) In [ ]: display ( bikeshare . describe ()) We can also use the groupby function to look at mean stats aggregated by month In [ ]: # Your code here In [ ]: # %load '../solutions/sol1.py' Let's plot the variation of count with month. Is there a seasonal change? In [ ]: # Your code here In [ ]: # %load '../solutions/sol2.py' What is temp, a_temp, is there a difference? Let us plot them both In [ ]: # Your code here In [ ]: # %load '../solutions/sol3.py' What did we do wrong here? Why does the plot look like this? Sorting! Whenever your plot makes zig-zag changes across the scale, it is because matplotlib is trying to connect the points sequentially from the top (using a line plot) and skipping across the scale when $x_{i+1}$ is lower than $x_{i}$. So let's sort. In [ ]: # Sorting new = bikeshare . sort_values ([ 'temp' ]) plt . plot ( new [ 'temp' ], new [ 'atemp' ], '-b' , alpha = 1 ) plt . xlabel ( 'Temp' ) plt . ylabel ( 'A - Temp' ) plt . title ( 'A - Temp vs Temp' ) plt . show () It still looks weird, why? Let's have a closer look at the dataframe: In [ ]: display ( new . head ( 10 )) There are multiple atemp values for each temp value, which if not sorted will bounce around at the same x-value. Thus, we need to sort both axes simultaneously. In [ ]: new = bikeshare . sort_values ([ 'temp' , 'atemp' ]) plt . plot ( new [ 'temp' ], new [ 'atemp' ], '-b' ) plt . xlabel ( 'Temp' ) plt . ylabel ( 'A - Temp' ) plt . title ( 'A - Temp vs Temp' ) plt . show () By plotting efficiently, we found an anomaly we would have otherwise overlooked. It looks like there is a problem with the data around temp greater than 30 and atemp less than 10 . Show all rows in the dataframe where the temp is greater than 30 and the atemp is less than 10 In [ ]: # Your code here In [ ]: # %load '../solutions/sol4.py' Anomaly! atemp and temp are usually lineary related except at this one datapoint. Now, we get to make a judgement call as to whether we should keep the datapoint? We'll come back to this question after the lecture on Missing Data and Imputation. Worth a thought though. In [ ]: bikeshare = bikeshare . drop ([ 188 ]) We can now try what we wrote and we should end up with no rows in the dataframe where the temp is greater than 30 and the atemp is less than 10 In [ ]: # %load '../solutions/sol4.py' Split up the data into a training set and a test set using the 'train_test_split' function from sklearn: Having an idea of what the data looks like, we want to predict count. We will be breaking up the data into a training and a testing set. The training set will be used to train the model, while the testing set will be used to quantify how well our model does. The testing set is a way for us to ensure our model doesn't overfit our training data. Let us first create a function that will randomly split the data up into a 70-30 split, with 70% of the data going into the training set: In [ ]: from sklearn.model_selection import train_test_split train_data , test_data = train_test_split ( bikeshare , test_size = 0.30 , random_state = 42 ) print ( \"Length of Training set = \" , len ( train_data )) print ( \"Length of Testing set = \" , len ( test_data )) Calculate the ratio of the number of points in the training set to the number of points in the testing set to see if we have split the data correctly In [ ]: # Your code here In [ ]: # %load '../solutions/sol5.py' kNN Regression Using sklearn to implement kNN: We will now use the scikit learn (sklearn) package to implement kNN. Then, we can fit the model and use various metrics to assess our accuracy. General sklearn model fitting code-structure : #Split Data into Train and Test Set x_train, y_train = training_data.drop('Response_Variable', axis=1), training_data['Response_Variable'] x_test, y_test = test_data.drop('Response_Variable', axis=1), test_data['Response_Variable'] #Define Model model = sklearn_model_name(hyper_parameter1 = value1, hyper_parameter2 = value2) #Fit Model model.fit(x_train, y_train) #Get Prediction y_pred_train = model.predict(x_train) y_pred_test = model.predict(x_test) #Evaluate Model r2_train = model.score(y_train, y_pred_train) r2_test = model.score(y_test, y_pred_test) #Print Results print(\"Score for Model (Training):\", r2_train) print(\"Score for Model (Testing) :\", r2_test) Every model has a list of hyperparameters that can be set using sklearn for the specific problem. In practice it is advisable to cross-validate a list of values to find best model fit. model.fit calculates the parameters of your model corresponding to the training data and hyperparameters you provided. model.predict(X) is the standard method called to make the model predict values for a specific X. Depending on if you feed x_train or x_test, you will get a y_prediction_train or y_prediction_test respectively. Evaluation of model can vary according to the task at hand i.e. Regression or Classification. For Regression, $R&#94;2$ Score is standard while for Classification, Accuracy (%) is standard. In [ ]: from sklearn.neighbors import KNeighborsRegressor # Set kNN parameter: k = 5 # Now we can fit the model, predict our variable of interest, and then evaluate our fit: # First, we create the classifier object: neighbors = KNeighborsRegressor ( n_neighbors = k ) # Then, we fit the model using x_train as training data and y_train as target values: neighbors . fit ( train_data [[ 'temp' ]], train_data [ 'count' ]) # Retreieve our predictions: prediction_knn = neighbors . predict ( test_data [[ 'temp' ]]) # This returns the mean accuracy on the given test data and labels, or in other words, # the R squared value -- A constant model that always predicts the expected value of y, # disregarding the input features, would get a R&#94;2 score of 1. r2_train = neighbors . score ( train_data [[ 'temp' ]], train_data [ 'count' ]) r2_test = neighbors . score ( test_data [[ 'temp' ]], test_data [ 'count' ]) print ( \"Length of Test Data:\" , len ( test_data [ 'count' ])) print ( \"R&#94;2 Score of kNN on training set:\" , r2_train ) print ( \"R&#94;2 Score of kNN on testing set: \" , r2_test ) In [ ]: # SubPlots fig , axes = plt . subplots ( nrows = 1 , ncols = 2 , figsize = ( 20 , 6 )) axes [ 0 ] . set_ylim ([ 0 , 10000 ]) axes [ 0 ] . plot ( train_data [ 'temp' ], train_data [ 'count' ], 'o' , label = 'Data' ) sorted_temp = train_data . sort_values ([ 'temp' ]) prediction_knn = neighbors . predict ( sorted_temp [[ 'temp' ]]) axes [ 0 ] . plot ( sorted_temp [ 'temp' ], prediction_knn , '*-' , label = 'Prediction' ) axes [ 0 ] . set_xlabel ( 'Temperature' ) axes [ 0 ] . set_ylabel ( '# of Rides' ) axes [ 0 ] . set_title ( \"Temp vs Count kNN Regression Training Set (k= {} )\" . format ( k )) axes [ 0 ] . legend () axes [ 1 ] . set_ylim ([ 0 , 10000 ]) axes [ 1 ] . plot ( test_data [ 'temp' ], test_data [ 'count' ], 'o' , label = 'Data' ) #, '*') sorted_temp = test_data . sort_values ([ 'temp' ]) prediction_knn = neighbors . predict ( sorted_temp [[ 'temp' ]]) axes [ 1 ] . plot ( sorted_temp [ 'temp' ], prediction_knn , '*-' , label = 'Prediction' ) axes [ 1 ] . set_xlabel ( 'Temperature' ) axes [ 1 ] . set_ylabel ( '# of Rides' ) axes [ 1 ] . set_title ( \"Temp vs Count kNN Regression Test Set (k= {} )\" . format ( k )) axes [ 1 ] . legend () fig . suptitle ( \"Bike Rides\" ); Linear Regression We just went over the kNN prediction method. Now, we will fit the same data with Linear Regression model. We will use a the same training/testing dataset as before and create our linear regression objects. In [ ]: from sklearn.linear_model import LinearRegression from statsmodels.api import OLS import statsmodels.api as sm #Split Data into X,Y x_train , y_train = train_data [ 'temp' ], train_data [ 'count' ] x_test , y_test = test_data [ 'temp' ], test_data [ 'count' ] #Add constant x_train_ca = sm . add_constant ( x_train ) x_test_ca = sm . add_constant ( x_test ) Fit a Linear Regression (OLS) model using statsmodels and print out the coefficients of temp and const Hint : StatsModels use a Y followed by X structure while feeding data in contrast to sklearn that uses X followed by Y. Give the name results to your fit model In [ ]: # Your code here In [ ]: # %load '../solutions/sol6.py' In [ ]: # Plotting our model fig , axes = plt . subplots ( 1 , 2 , figsize = ( 20 , 6 )) axes = axes . ravel () axes [ 0 ] . plot ( x_train , y_train , 'o' ) sorted_temp = train_data . sort_values ([ 'temp' ]) prediction_lr = results . predict ( sm . add_constant ( sorted_temp [[ 'temp' ]])) axes [ 0 ] . plot ( sorted_temp [ 'temp' ], prediction_lr , '*-' , label = 'Prediction' ) axes [ 0 ] . set_title ( 'Temp vs Count Linear Regression for Training Set' ) axes [ 1 ] . plot ( x_test , y_test , 'o' ) sorted_temp = test_data . sort_values ([ 'temp' ]) prediction_lr = results . predict ( sm . add_constant ( sorted_temp [[ 'temp' ]])) axes [ 1 ] . plot ( sorted_temp [ 'temp' ], prediction_lr , '*-' , label = 'Prediction' ) axes [ 1 ] . set_title ( 'Temp vs Count Linear Regression for Test Set' ) for i , ax in enumerate ( axes ): ax . set_ylim ( 0 , 10000 ) ax . set_xlabel ( 'Temperature' ) ax . set_ylabel ( '# of Rides' ) ax . legend () In [ ]: # Metrics, Performance Evaluation and Helpful functions from sklearn import metrics # To compute the mean squared error (notice that we are now using the TEST set): print ( \"R&#94;2 Score for Linear Regression (Training):\" , metrics . r2_score ( y_train , results . predict ( x_train_ca ))) print ( \"R&#94;2 Score for Linear Regression (Testing) :\" , metrics . r2_score ( y_test , results . predict ( x_test_ca ))) Check out results.summary() and pay close attention to the table that shows up In [ ]: results . summary () Confidence Intervals In Data Science, a confidence interval (CI) is a type of interval estimate, computed from the statistics of the observed data, that might contain the true value of an unknown population parameter. Simply speaking, a Confidence Interval is a range of values we are fairly sure our true value lies in. It is important to remind ourselves here that Confidence Intervals belong to a parameter and not a statistic. Thus, they represent the window in which the true value exists for the entire population when all we have is a sample. See if you can implement a 95% confidence interval using statsmodels In [ ]: # Your code here In [ ]: # %load '../solutions/sol7.py' # Confidence Interval using Stats Model Summary thresh = 0.05 intervals = results . conf_int ( alpha = thresh ) # Renaming column names first_col = str ( thresh / 2 * 100 ) + \"%\" second_col = str (( 1 - thresh / 2 ) * 100 ) + \"%\" intervals = intervals . rename ( columns = { 0 : first_col , 1 : second_col }) display ( intervals ) In the above block of code, results.conf_int(alpha=thresh) returns a dataframe with columns 0 and 1. We explained Confidence Intervals above where because we assume normal symetric distribution of data, the 95% Confidence Interval means there's 2.5% chance of the true value lying below the values in Column 0 and 2.5% chance of the true value lying above Column 1. End of Standard Section Extra: Train-Test Split using a mask In [ ]: #Function to Split data into Train and Test Set def split_data ( data ): #Calculate Length of Dataset length = len ( data ) #Define Split split = 0.7 #Set a random Seed For Shuffling np . random . seed ( 9001 ) #Generate a Mask with a X:Y Split mask = np . random . rand ( length ) < split #Separate train and test data data_train = data [ mask ] data_test = data [ ~ mask ] #Return Separately return data_train , data_test In [ ]: #Split data using defined function train_data_manual , test_data_manual = split_data ( bikeshare ) print ( \"Length of Training set:\" , len ( train_data_manual )) print ( \"Length of Testing set:\" , len ( test_data_manual )) In [ ]: ## Check that the ratio between test and train sets is right test_data_manual . shape [ 0 ] / ( test_data_manual . shape [ 0 ] + train_data_manual . shape [ 0 ]) Extra: Implementing the kNN Algorithm by hand To really understand how the kNN algorithm works, it helps to go through the algorithm line by line in code. In [ ]: #kNN Algorithm def knn_algorithm ( train , test , k ): #Create any empty list to store our predictions in predictions = [] #Separate the response and predictor variables from training and test set: train_x = train [ 'temp' ] train_y = train [ 'count' ] test_x = test [ 'temp' ] test_y = test [ 'count' ] for i , ele in enumerate ( test_x ): #For each test point, store the distance between all training points and test point distances = pd . DataFrame (( train_x . values - ele ) ** 2 , index = train . index ) distances . columns = [ 'dist' ] #display(distances) #Then, we sum across the columns per row to obtain the Euclidean distance squared ##distances = vec_distances.sum(axis = 1) #Sort the distances to training points (in ascending order) and take first k points nearest_k = distances . sort_values ( by = 'dist' ) . iloc [: k ] #For simplicity, we omitted the square rooting of the Euclidean distance because the #square root function preserves order. #Take the mean of the y-values of training set corresponding to the nearest k points k_mean = train_y [ nearest_k . index ] . mean () #Add on the mean to our predicted y-value list predictions . append ( k_mean ) #Create a dataframe with the x-values from test and predicted y-values predict = test . copy () predict [ 'predicted_count' ] = pd . Series ( predictions , index = test . index ) return predict Now to run the algorithm on our dataset with $k = 5$: In [ ]: #Run the kNN function k = 5 predicted_knn = knn_algorithm ( train_data , test_data , k ) predicted_knn . head () We want to have a way to evaluate our predictions from the kNN algorithm with $k=5$. One way is to compute the $R&#94;2$ coefficient. Let's create a function for that: In [ ]: #Test predictions in comparison to true value of test set def evaluate ( predicted , true ): #Find the squared error: squared_error = ( predicted [ 'predicted_count' ] - true [ 'count' ]) ** 2 #Finding the mean squared error: error_var = squared_error . sum () sample_var = (( true [ 'count' ] - true [ 'count' ] . mean ()) ** 2 ) . sum () r = ( 1 - ( error_var / sample_var )) return r Then let's apply this function to our predictions: In [ ]: print ( \"Length of Test Data:\" , len ( test_data )) print ( \"R&#94;2 Score of kNN test:\" , evaluate ( predicted_knn , test_data )) In [ ]: predicted_knn_train = knn_algorithm ( test_data , train_data , k ) print ( \"R&#94;2 Score of kNN train:\" , evaluate ( predicted_knn_train , train_data )) Extra: Computing different performance metrics by hand Now, we will compute metrics that can be used to assess fit. Note: sklearn.metrics is class of functions that consists of all the metrics we care about to evaluate our models. While it is not hard to implement them yourself, it is helpful to go through http://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics . In [ ]: model = sm . OLS ( y_train , x_train_ca ) results = model . fit () #Find the squared error: y_pred_train = results . predict ( x_train_ca ) squared_error_train = ( y_pred_train - y_train ) ** 2 #Finding the mean squared error: error_var_train = squared_error_train . mean () sample_var_train = (( y_train - y_train . mean ()) ** 2 ) . mean () y_pred_test = results . predict ( x_test_ca ) squared_error_test = ( y_pred_test - y_test ) ** 2 #Finding the mean squared error: error_var_test = squared_error_test . mean () sample_var_test = (( y_test - y_test . mean ()) ** 2 ) . mean () print ( error_var_train , sample_var_train , 1 - error_var_train / sample_var_train ) print ( error_var_test , sample_var_test , 1 - error_var_test / sample_var_test ) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/sec_2/"},{"title":"S-Section 02: kNN and Linear Regression","text":"Jupyter Notebooks S-Section 2: kNN and Linear Regression","tags":"sections","url":"sections/section2/"},{"title":"Lab 3: Matplotlib, Simple Linear Regression, kNN, array reshape","text":"Jupyter Notebooks Lab 3: Matplotlib, Simple Linear Regression, kNN, array reshape Lab 3: Matplotlib, Simple Linear Regression, kNN, array reshape - extended edition Lab 3: Matplotlib, Prelab","tags":"labs","url":"labs/lab-3/"},{"title":"Lab 03: Extended Matplotlib, Simple Linear Regression, kNN, array reshape","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A/STAT121A/AC209A/CSCIE109A Introduction to Data Science Lab 3: plotting, K-NN Regression, Simple Linear Regression Harvard University Fall 2019 Instructors: Pavlos Protopapas, Kevin Rader, and Chris Tanner Material prepared by : David Sondak, Will Claybaugh, Pavlos Protopapas, and Eleni Kaxiras. Extended Edition Same as the one done in class with the following additions/clarifications: I added another example to illustrate the difference between .iloc and .loc in pandas -- > here How to run the solutions: Uncomment the following line and run the cell: # %load solutions/knn_regression.py This will bring up the code in the cell but WILL NOT RUN it. You need to run the cell again in order to actually run the code In [1]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } Learning Goals By the end of this lab, you should be able to: Review numpy including 2-D arrays and understand array reshaping Use matplotlib to make plots Feel comfortable with simple linear regression Feel comfortable with $k$ nearest neighbors This lab corresponds to lectures 4 and 5 and maps on to homework 2 and beyond. Table of Contents HIGHLIGHTS FROM PRE-LAB 1 - Review of numpy 2 - Intro to matplotlib plus more LAB 3 MATERIAL 3 - Simple Linear Regression 4 - Building a model with statsmodels and sklearn 5 - Example: Simple linear regression with automobile data 6 - $k$Nearest Neighbors In [ ]: import numpy as np import scipy as sp import matplotlib as mpl import matplotlib.cm as cm import matplotlib.pyplot as plt import pandas as pd import time pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) pd . set_option ( 'display.notebook_repr_html' , True ) #import seaborn as sns import warnings warnings . filterwarnings ( 'ignore' ) # Displays the plots for us. % matplotlib inline In [ ]: # Use this as a variable to load solutions: %load PATHTOSOLUTIONS/exercise1.py. It will be substituted in the code # so do not worry if it disappears after you run the cell. PATHTOSOLUTIONS = 'solutions' 1 - Review of the numpy Python library In lab1 we learned about the numpy library (documentation) and its fast array structure, called the numpy array . In [ ]: # import numpy import numpy as np In [ ]: # make an array my_array = np . array ([ 1 , 4 , 9 , 16 ]) my_array In [ ]: print ( f 'Size of my array: {my_array.size} , or length of my array: {len(my_array)}' ) print ( f 'Shape of my array: {my_array.shape} ' ) Notice the way the shape appears in numpy arrays For a 1D array, .shape returns a tuple with 1 element (n,) For a 2D array, .shape returns a tuple with 2 elements (n,m) For a 3D array, .shape returns a tuple with 3 elements (n,m,p) In [ ]: # How to reshape a 1D array to a 2D my_array . reshape ( - 1 , 2 ) Numpy arrays support the same operations as lists! Below we slice and iterate. In [ ]: print ( \"array[2:4]:\" , my_array [ 2 : 4 ]) # A slice of the array # Iterate over the array for ele in my_array : print ( \"element:\" , ele ) Remember numpy gains a lot of its efficiency from being strongly typed (all elements are of the same type, such as integer or floating point). If the elements of an array are of a different type, numpy will force them into the same type (the longest in terms of bytes) In [ ]: mixed = np . array ([ 1 , 2.3 , 'eleni' , True ]) print ( type ( 1 ), type ( 2.3 ), type ( 'eleni' ), type ( True )) mixed # all elements will become strings Next, we push ahead to two-dimensional arrays and begin to dive into some of the deeper aspects of numpy . In [ ]: # create a 2d-array by handing a list of lists my_array2d = np . array ([ [ 1 , 2 , 3 , 4 ], [ 5 , 6 , 7 , 8 ], [ 9 , 10 , 11 , 12 ] ]) my_array2d Array Slicing (a reminder...) Numpy arrays can be sliced, and can be iterated over with loops. Below is a schematic illustrating slicing two-dimensional arrays. Notice that the list slicing syntax still works! array[2:,3] says \"in the array, get rows 2 through the end, column 3]\" array[3,:] says \"in the array, get row 3, all columns\". Pandas Slicing (a reminder...) .iloc is by position (position is unique), .loc is by label (label is not unique) In [ ]: # import cast dataframe cast = pd . read_csv ( '../data/cast.csv' , encoding = 'utf_8' ) cast . head () In [ ]: # get me rows 10 to 13 (python slicing style : exclusive of end) cast . iloc [ 10 : 13 ] In [ ]: # get me columns 0 to 2 but all rows - use head() cast . iloc [:, 0 : 2 ] . head () In [ ]: # get me rows 10 to 13 AND only columns 0 to 2 cast . iloc [ 10 : 13 , 0 : 2 ] In [ ]: # COMPARE: get me rows 10 to 13 (pandas slicing style : inclusive of end) cast . loc [ 10 : 13 ] In [ ]: # give me columns 'year' and 'type' by label but only for rows 5 to 10 cast . loc [ 5 : 10 ,[ 'year' , 'type' ]] Another example of positioning with .iloc and loc Look at the following data frame. It is a bad example because we have duplicate values for the index but that is legal in pandas. It's just a bad practice and we are doing it to illustrate the difference between positioning with .iloc and loc . To keep rows unique, though, internally, pandas has its own index which in this dataframe runs from 0 to 2 . In [ ]: index = [ 'A' , 'Z' , 'A' ] famous = pd . DataFrame ({ 'Elton' : [ 'singer' , 'Candle in the wind' , 'male' ], 'Maraie' : [ 'actress' , 'Do not know' , 'female' ], 'num' : np . random . randn ( 3 )}, index = index ) famous In [ ]: # accessing elements by label can bring up duplicates!! famous . loc [ 'A' ] # since we want all rows is the same as famous.loc['A',:] In [ ]: # accessing elements by position is unique - brings up only one row famous . iloc [ 1 ] 2 - Plotting with matplotlib and beyond matplotlib is a very powerful python library for making scientific plots. We will not focus too much on the internal aspects of matplotlib in today's lab. There are many excellent tutorials out there for matplotlib . For example, matplotlib homepage matplotlib tutorial Conveying your findings convincingly is an absolutely crucial part of any analysis. Therefore, you must be able to write well and make compelling visuals. Creating informative visuals is an involved process and we won't cover that in this lab. However, part of creating informative data visualizations means generating readable figures. If people can't read your figures or have a difficult time interpreting them, they won't understand the results of your work. Here are some non-negotiable commandments for any plot: Label $x$ and $y$ axes Axes labels should be informative Axes labels should be large enough to read Make tick labels large enough Include a legend if necessary Include a title if necessary Use appropriate line widths Use different line styles for different lines on the plot Use different markers for different lines There are other important elements, but that list should get you started on your way. We will work with matplotlib and seaborn for plotting in this class. matplotlib is a very powerful python library for making scientific plots. seaborn is a little more specialized in that it was developed for statistical data visualization. We will cover some seaborn later in class. In the meantime you can look at the seaborn documentation First, let's generate some data. Let's plot some functions We will use the following three functions to make some plots: Logistic function: \\begin{align*} f\\left(z\\right) = \\dfrac{1}{1 + be&#94;{-az}} \\end{align*} where $a$ and $b$ are parameters. Hyperbolic tangent: \\begin{align*} g\\left(z\\right) = b\\tanh\\left(az\\right) + c \\end{align*} where $a$, $b$, and $c$ are parameters. Rectified Linear Unit: \\begin{align*} h\\left(z\\right) = \\left{ \\begin{array}{lr} z, \\quad z > 0 \\\\ \\epsilon z, \\quad z\\leq 0 \\end{array} \\right. \\end{align*} where $\\epsilon < 0$ is a small, positive parameter. You are given the code for the first two functions. Notice that $z$ is passed in as a numpy array and that the functions are returned as numpy arrays. Parameters are passed in as floats. You should write a function to compute the rectified linear unit. The input should be a numpy array for $z$ and a positive float for $\\epsilon$. In [ ]: import numpy as np def logistic ( z : np . ndarray , a : float , b : float ) -> np . ndarray : \"\"\" Compute logistic function Inputs: a: exponential parameter b: exponential prefactor z: numpy array; domain Outputs: f: numpy array of floats, logistic function \"\"\" den = 1.0 + b * np . exp ( - a * z ) return 1.0 / den def stretch_tanh ( z : np . ndarray , a : float , b : float , c : float ) -> np . ndarray : \"\"\" Compute stretched hyperbolic tangent Inputs: a: horizontal stretch parameter (a>1 implies a horizontal squish) b: vertical stretch parameter c: vertical shift parameter z: numpy array; domain Outputs: g: numpy array of floats, stretched tanh \"\"\" return b * np . tanh ( a * z ) + c def relu ( z : np . ndarray , eps : float = 0.01 ) -> np . ndarray : \"\"\" Compute rectificed linear unit Inputs: eps: small positive parameter z: numpy array; domain Outputs: h: numpy array; relu \"\"\" return np . fmax ( z , eps * z ) Now let's make some plots. First, let's just warm up and plot the logistic function. In [ ]: x = np . linspace ( - 5.0 , 5.0 , 100 ) # Equally spaced grid of 100 pts between -5 and 5 f = logistic ( x , 1.0 , 1.0 ) # Generate data In [ ]: plt . plot ( x , f ) plt . xlabel ( 'x' ) plt . ylabel ( 'f' ) plt . title ( 'Logistic Function' ) plt . grid ( True ) Figures with subplots Let's start thinking about the plots as objects. We have the figure object which is like a matrix of smaller plots named axes . You can use array notation when handling it. In [ ]: fig , ax = plt . subplots ( 1 , 1 ) # Get figure and axes objects ax . plot ( x , f ) # Make a plot # Create some labels ax . set_xlabel ( 'x' ) ax . set_ylabel ( 'f' ) ax . set_title ( 'Logistic Function' ) # Grid ax . grid ( True ) Wow, it's exactly the same plot! Notice, however, the use of ax.set_xlabel() instead of plt.xlabel() . The difference is tiny, but you should be aware of it. I will use this plotting syntax from now on. What else do we need to do to make this figure better? Here are some options: Make labels bigger! Make line fatter Make tick mark labels bigger Make the grid less pronounced Make figure bigger Let's get to it. In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Make figure bigger # Make line plot ax . plot ( x , f , lw = 4 ) # Update ticklabel size ax . tick_params ( labelsize = 24 ) # Make labels ax . set_xlabel ( r '$x$' , fontsize = 24 ) # Use TeX for mathematical rendering ax . set_ylabel ( r '$f(x)$' , fontsize = 24 ) # Use TeX for mathematical rendering ax . set_title ( 'Logistic Function' , fontsize = 24 ) ax . grid ( True , lw = 1.5 , ls = '--' , alpha = 0.75 ) Notice: lw stands for linewidth . We could also write ax.plot(x, f, linewidth=4) ls stands for linestyle . alpha stands for transparency. The only thing remaining to do is to change the $x$ limits. Clearly these should go from $-5$ to $5$. In [ ]: #fig.savefig('logistic.png') # Put this in a markdown cell and uncomment this to check what you saved. # ![](../images/logistic.png) Resources If you want to see all the styles available, please take a look at the documentation. Line styles Marker styles Everything you could ever want We haven't discussed it yet, but you can also put a legend on a figure. You'll do that in the next exercise. Here are some additional resources: Legend Grid ax.legend(loc='best', fontsize=24); Exercise Do the following: Make a figure with the logistic function, hyperbolic tangent, and rectified linear unit. Use different line styles for each plot Put a legend on your figure Here's an example of a figure: In [ ]: # your code here # First get the data f = logistic ( x , 2.0 , 1.0 ) g = stretch_tanh ( x , 2.0 , 0.5 , 0.5 ) h = relu ( x ) fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Create figure object # Make actual plots # (Notice the label argument!) ax . plot ( x , f , lw = 4 , ls = '-' , label = r '$L(x;1)$' ) ax . plot ( x , g , lw = 4 , ls = '--' , label = r '$\\tanh(2x)$' ) ax . plot ( x , h , lw = 4 , ls = '-.' , label = r '$relu(x; 0.01)$' ) # Make the tick labels readable ax . tick_params ( labelsize = 24 ) # Set axes limits to make the scale nice ax . set_xlim ( x . min (), x . max ()) ax . set_ylim ( h . min (), 1.1 ) # Make readable labels ax . set_xlabel ( r '$x$' , fontsize = 24 ) ax . set_ylabel ( r '$h(x)$' , fontsize = 24 ) ax . set_title ( 'Activation Functions' , fontsize = 24 ) # Set up grid ax . grid ( True , lw = 1.75 , ls = '--' , alpha = 0.75 ) # Put legend on figure ax . legend ( loc = 'best' , fontsize = 24 ); fig . savefig ( '../images/nice_plots.png' ) Exercise These figures look nice in the plot and it makes sense for comparison. Now let's put the 3 different figures in separate plots. Make a separate plot for each figure and line them up on the same row. In [ ]: # your code here In [ ]: # %load solutions/three_subplots.py Exercise Make a grid of 2 x 3 separate plots, 3 will be empty. Just plot the functions and do not worry about cosmetics. We just want you ro see the functionality. In [ ]: # your code here In [ ]: # %load solutions/six_subplots.py 3 - Simple Linear Regression Linear regression and its many extensions are a workhorse of the statistics and data science community, both in application and as a reference point for other models. Most of the major concepts in machine learning can be and often are discussed in terms of various linear regression models. Thus, this section will introduce you to building and fitting linear regression models and some of the process behind it, so that you can 1) fit models to data you encounter 2) experiment with different kinds of linear regression and observe their effects 3) see some of the technology that makes regression models work. Linear regression with a toy dataset We first examine a toy problem, focusing our efforts on fitting a linear model to a small dataset with three observations. Each observation consists of one predictor $x_i$ and one response $y_i$ for $i = 1, 2, 3$, \\begin{align*} (x , y) = \\{(x_1, y_1), (x_2, y_2), (x_3, y_3)\\}. \\end{align*} To be very concrete, let's set the values of the predictors and responses. \\begin{equation*} (x , y) = \\{(1, 2), (2, 2), (3, 4)\\} \\end{equation*} There is no line of the form $\\beta_0 + \\beta_1 x = y$ that passes through all three observations, since the data are not collinear. Thus our aim is to find the line that best fits these observations in the least-squares sense , as discussed in lecture. Exercise (for home) Make two numpy arrays out of this data, x_train and y_train Check the dimentions of these arrays Try to reshape them into a different shape Make points into a very simple scatterplot Make a better scatterplot In [ ]: # your code here In [ ]: # solution x_train = np . array ([ 1 , 2 , 3 ]) y_train = np . array ([ 2 , 3 , 6 ]) type ( x_train ) In [ ]: x_train . shape In [ ]: x_train = x_train . reshape ( 3 , 1 ) x_train . shape In [ ]: # %load solutions/simple_scatterplot.py # Make a simple scatterplot plt . scatter ( x_train , y_train ) # check dimensions print ( x_train . shape , y_train . shape ) In [ ]: # %load solutions/nice_scatterplot.py def nice_scatterplot ( x , y , title ): # font size f_size = 18 # make the figure fig , ax = plt . subplots ( 1 , 1 , figsize = ( 8 , 5 )) # Create figure object # set axes limits to make the scale nice ax . set_xlim ( np . min ( x ) - 1 , np . max ( x ) + 1 ) ax . set_ylim ( np . min ( y ) - 1 , np . max ( y ) + 1 ) # adjust size of tickmarks in axes ax . tick_params ( labelsize = f_size ) # remove tick labels ax . tick_params ( labelbottom = False , bottom = False ) # adjust size of axis label ax . set_xlabel ( r '$x$' , fontsize = f_size ) ax . set_ylabel ( r '$y$' , fontsize = f_size ) # set figure title label ax . set_title ( title , fontsize = f_size ) # you may set up grid with this ax . grid ( True , lw = 1.75 , ls = '--' , alpha = 0.15 ) # make actual plot (Notice the label argument!) #ax.scatter(x, y, label=r'$my points$') #ax.scatter(x, y, label='$my points$') ax . scatter ( x , y , label = r '$my\\,points$' ) ax . legend ( loc = 'best' , fontsize = f_size ); return ax nice_scatterplot ( x_train , y_train , 'hello nice plot' ) Formulae Linear regression is special among the models we study because it can be solved explicitly. While most other models (and even some advanced versions of linear regression) must be solved itteratively, linear regression has a formula where you can simply plug in the data. For the single predictor case it is: \\begin{align} \\beta_1 &= \\frac{\\sum_{i=1}&#94;n{(x_i-\\bar{x})(y_i-\\bar{y})}}{\\sum_{i=1}&#94;n{(x_i-\\bar{x})&#94;2}}\\\\ \\beta_0 &= \\bar{y} - \\beta_1\\bar{x}\\ \\end{align} Where $\\bar{y}$ and $\\bar{x}$ are the mean of the y values and the mean of the x values, respectively. Building a model from scratch In this part, we will solve the equations for simple linear regression and find the best fit solution to our toy problem. The snippets of code below implement the linear regression equations on the observed predictors and responses, which we'll call the training data set. Let's walk through the code. We have to reshape our arrrays to 2D. We will see later why. Exercise make an array with shape (2,3) reshape it to a size that you want In [ ]: # your code here In [ ]: #solution xx = np . array ([[ 1 , 2 , 3 ],[ 4 , 6 , 8 ]]) xxx = xx . reshape ( - 1 , 2 ) xxx . shape In [ ]: # Reshape to be a proper 2D array x_train = x_train . reshape ( x_train . shape [ 0 ], 1 ) y_train = y_train . reshape ( y_train . shape [ 0 ], 1 ) print ( x_train . shape ) In [ ]: # first, compute means y_bar = np . mean ( y_train ) x_bar = np . mean ( x_train ) # build the two terms numerator = np . sum ( ( x_train - x_bar ) * ( y_train - y_bar ) ) denominator = np . sum (( x_train - x_bar ) ** 2 ) print ( numerator . shape , denominator . shape ) #check shapes Why the empty brackets? (The numerator and denominator are scalars, as expected.) In [ ]: #slope beta1 beta_1 = numerator / denominator #intercept beta0 beta_0 = y_bar - beta_1 * x_bar print ( \"The best-fit line is {0:3.2f} + {1:3.2f} * x\" . format ( beta_0 , beta_1 )) print ( f 'The best fit is {beta_0} ' ) Exercise Turn the code from the above cells into a function called simple_linear_regression_fit , that inputs the training data and returns beta0 and beta1 . To do this, copy and paste the code from the above cells below and adjust the code as needed, so that the training data becomes the input and the betas become the output. def simple_linear_regression_fit ( x_train : np . ndarray , y_train : np . ndarray ) -> np . ndarray : return Check your function by calling it with the training data from above and printing out the beta values. In [ ]: # Your code here In [ ]: # %load solutions/simple_linear_regression_fit.py def simple_linear_regression_fit ( x_train : np . ndarray , y_train : np . ndarray ) -> np . ndarray : \"\"\" Inputs: x_train: a (num observations by 1) array holding the values of the predictor variable y_train: a (num observations by 1) array holding the values of the response variable Returns: beta_vals: a (num_features by 1) array holding the intercept and slope coeficients \"\"\" # Check input array sizes if len ( x_train . shape ) < 2 : print ( \"Reshaping features array.\" ) x_train = x_train . reshape ( x_train . shape [ 0 ], 1 ) if len ( y_train . shape ) < 2 : print ( \"Reshaping observations array.\" ) y_train = y_train . reshape ( y_train . shape [ 0 ], 1 ) # first, compute means y_bar = np . mean ( y_train ) x_bar = np . mean ( x_train ) # build the two terms numerator = np . sum ( ( x_train - x_bar ) * ( y_train - y_bar ) ) denominator = np . sum (( x_train - x_bar ) ** 2 ) #slope beta1 beta_1 = numerator / denominator #intercept beta0 beta_0 = y_bar - beta_1 * x_bar return np . array ([ beta_0 , beta_1 ]) Let's run this function and see the coefficients In [ ]: x_train = np . array ([ 1 , 2 , 3 ]) y_train = np . array ([ 2 , 2 , 4 ]) betas = simple_linear_regression_fit ( x_train , y_train ) beta_0 = betas [ 0 ] beta_1 = betas [ 1 ] print ( \"The best-fit line is {0:8.6f} + {1:8.6f} * x\" . format ( beta_0 , beta_1 )) Exercise Do the values of beta0 and beta1 seem reasonable? Plot the training data using a scatter plot. Plot the best fit line with beta0 and beta1 together with the training data. In [ ]: # Your code here In [ ]: # %load solutions/best_fit_scatterplot.py fig_scat , ax_scat = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Plot best-fit line x_train = np . array ([[ 1 , 2 , 3 ]]) . T best_fit = beta_0 + beta_1 * x_train ax_scat . scatter ( x_train , y_train , s = 300 , label = 'Training Data' ) ax_scat . plot ( x_train , best_fit , ls = '--' , label = 'Best Fit Line' ) ax_scat . set_xlabel ( r '$x_ {train} $' ) ax_scat . set_ylabel ( r '$y$' ); The values of beta0 and beta1 seem roughly reasonable. They capture the positive correlation. The line does appear to be trying to get as close as possible to all the points. 4 - Building a model with statsmodels and sklearn Now that we can concretely fit the training data from scratch, let's learn two python packages to do it all for us: statsmodels and scikit-learn (sklearn) . Our goal is to show how to implement simple linear regression with these packages. For an important sanity check, we compare the $\\beta$ values from statsmodels and sklearn to the $\\beta$ values that we found from above with our own implementation. For the purposes of this lab, statsmodels and sklearn do the same thing. More generally though, statsmodels tends to be easier for inference [finding the values of the slope and intercept and dicussing uncertainty in those values], whereas sklearn has machine-learning algorithms and is better for prediction [guessing y values for a given x value]. (Note that both packages make the same guesses, it's just a question of which activity they provide more support for. Note: statsmodels and sklearn are different packages! Unless we specify otherwise, you can use either one. Below is the code for statsmodels . Statsmodels does not by default include the column of ones in the $X$ matrix, so we include it manually with sm.add_constant . In [ ]: import statsmodels.api as sm In [ ]: # create the X matrix by appending a column of ones to x_train X = sm . add_constant ( x_train ) # this is the same matrix as in our scratch problem! print ( X ) # build the OLS model (ordinary least squares) from the training data toyregr_sm = sm . OLS ( y_train , X ) # do the fit and save regression info (parameters, etc) in results_sm results_sm = toyregr_sm . fit () # pull the beta parameters out from results_sm beta0_sm = results_sm . params [ 0 ] beta1_sm = results_sm . params [ 1 ] print ( f 'The regression coef from statsmodels are: beta_0 = {beta0_sm:8.6f} and beta_1 = {beta1_sm:8.6f} ' ) Besides the beta parameters, results_sm contains a ton of other potentially useful information. In [ ]: import warnings warnings . filterwarnings ( 'ignore' ) print ( results_sm . summary ()) Now let's turn our attention to the sklearn library. In [ ]: from sklearn import linear_model In [ ]: # build the least squares model toyregr = linear_model . LinearRegression () # save regression info (parameters, etc) in results_skl results = toyregr . fit ( x_train , y_train ) # pull the beta parameters out from results_skl beta0_skl = toyregr . intercept_ beta1_skl = toyregr . coef_ [ 0 ] print ( \"The regression coefficients from the sklearn package are: beta_0 = {0:8.6f} and beta_1 = {1:8.6f} \" . format ( beta0_skl , beta1_skl )) We should feel pretty good about ourselves now, and we're ready to move on to a real problem! The scikit-learn library and the shape of things Before diving into a \"real\" problem, let's discuss more of the details of sklearn . Scikit-learn is the main Python machine learning library. It consists of many learners which can learn models from data, as well as a lot of utility functions such as train_test_split() . Use the following to add the library into your code: import sklearn In scikit-learn , an estimator is a Python object that implements the methods fit(X, y) and predict(T) Let's see the structure of scikit-learn needed to make these fits. fit() always takes two arguments: estimator . fit ( Xtrain , ytrain ) We will consider two estimators in this lab: LinearRegression and KNeighborsRegressor . It is very important to understand that Xtrain must be in the form of a 2x2 array with each row corresponding to one sample, and each column corresponding to the feature values for that sample. ytrain on the other hand is a simple array of responses. These are continuous for regression problems. Practice with sklearn and a real dataset We begin by loading up the mtcars dataset. This data was extracted from the 1974 Motor Trend US magazine, and comprises of fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973–74 models). We will load this data to a dataframe with 32 observations on 11 (numeric) variables. Here is an explanation of the features: mpg is Miles/(US) gallon cyl is Number of cylinders, disp is Displacement (cu.in.), hp is Gross horsepower, drat is Rear axle ratio, wt is the Weight (1000 lbs), qsec is 1/4 mile time, vs is Engine (0 = V-shaped, 1 = straight), am is Transmission (0 = automatic, 1 = manual), gear is the Number of forward gears, carb is Number of carburetors. In [ ]: import pandas as pd #load mtcars dfcars = pd . read_csv ( \"../data/mtcars.csv\" ) dfcars . head () In [ ]: # Fix the column title dfcars = dfcars . rename ( columns = { \"Unnamed: 0\" : \"car name\" }) dfcars . head () In [ ]: dfcars . shape Searching for values: how many cars have 4 gears? In [ ]: len ( dfcars [ dfcars . gear == 4 ] . drop_duplicates ( subset = 'car name' , keep = 'first' )) Next, let's split the dataset into a training set and test set. In [ ]: # split into training set and testing set from sklearn.model_selection import train_test_split #set random_state to get the same split every time traindf , testdf = train_test_split ( dfcars , test_size = 0.2 , random_state = 42 ) In [ ]: # testing set is around 20% of the total data; training set is around 80% print ( \"Shape of full dataset is: {0} \" . format ( dfcars . shape )) print ( \"Shape of training dataset is: {0} \" . format ( traindf . shape )) print ( \"Shape of test dataset is: {0} \" . format ( testdf . shape )) Now we have training and test data. We still need to select a predictor and a response from this dataset. Keep in mind that we need to choose the predictor and response from both the training and test set. You will do this in the exercises below. However, we provide some starter code for you to get things going. In [ ]: traindf . head () In [ ]: # Extract the response variable that we're interested in y_train = traindf . mpg y_train Exercise Use slicing to get the same vector y_train Now, notice the shape of y_train . In [ ]: y_train . shape , type ( y_train ) Array reshape This is a 1D array as should be the case with the Y array. Remember, sklearn requires a 2D array only for the predictor array. You will have to pay close attention to this in the exercises later. Sklearn doesn't care too much about the shape of y_train . The whole reason we went through that whole process was to show you how to reshape your data into the correct format. IMPORTANT: Remember that your response variable ytrain can be a vector but your predictor variable xtrain must be an array! 5 - Example: Simple linear regression with automobile data We will now use sklearn to predict automobile mileage per gallon (mpg) and evaluate these predictions. We already loaded the data and split them into a training set and a test set. We need to choose the variables that we think will be good predictors for the dependent variable mpg . Exercise in pairs Pick one variable to use as a predictor for simple linear regression. Discuss your reasons with the person next to you. Justify your choice with some visualizations. Is there a second variable you'd like to use? For example, we're not doing multiple linear regression here, but if we were, is there another variable you'd like to include if we were using two predictors? In [ ]: x_wt = dfcars . wt x_wt . shape In [ ]: # Your code here In [ ]: # %load solutions/cars_simple_EDA.py Exercise Use sklearn to fit the training data using simple linear regression. Use the model to make mpg predictions on the test set. Plot the data and the prediction. Print out the mean squared error for the training set and the test set and compare. In [ ]: from sklearn.linear_model import LinearRegression from sklearn.model_selection import train_test_split from sklearn.metrics import mean_squared_error dfcars = pd . read_csv ( \"../data/mtcars.csv\" ) dfcars = dfcars . rename ( columns = { \"Unnamed: 0\" : \"name\" }) dfcars . head () In [ ]: traindf , testdf = train_test_split ( dfcars , test_size = 0.2 , random_state = 42 ) y_train = np . array ( traindf . mpg ) X_train = np . array ( traindf . wt ) X_train = X_train . reshape ( X_train . shape [ 0 ], 1 ) In [ ]: y_test = np . array ( testdf . mpg ) X_test = np . array ( testdf . wt ) X_test = X_test . reshape ( X_test . shape [ 0 ], 1 ) In [ ]: # Let's take another look at our data dfcars . head () In [ ]: # And out train and test sets y_train . shape , X_train . shape In [ ]: y_test . shape , X_test . shape In [ ]: #create linear model regression = LinearRegression () #fit linear model regression . fit ( X_train , y_train ) predicted_y = regression . predict ( X_test ) r2 = regression . score ( X_test , y_test ) print ( f 'R&#94;2 = {r2:.5} ' ) In [ ]: print ( regression . score ( X_train , y_train )) print ( mean_squared_error ( predicted_y , y_test )) print ( mean_squared_error ( y_train , regression . predict ( X_train ))) print ( 'Coefficients: \\n ' , regression . coef_ [ 0 ], regression . intercept_ ) In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( y_test , predicted_y , 'o' ) grid = np . linspace ( np . min ( dfcars . mpg ), np . max ( dfcars . mpg ), 100 ) ax . plot ( grid , grid , color = \"black\" ) # 45 degree line ax . set_xlabel ( \"actual y\" ) ax . set_ylabel ( \"predicted y\" ) fig1 , ax1 = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax1 . plot ( dfcars . wt , dfcars . mpg , 'o' ) xgrid = np . linspace ( np . min ( dfcars . wt ), np . max ( dfcars . wt ), 100 ) ax1 . plot ( xgrid , regression . predict ( xgrid . reshape ( 100 , 1 ))) 6 - $k$-nearest neighbors Now that you're familiar with sklearn , you're ready to do a KNN regression. Sklearn's regressor is called sklearn.neighbors.KNeighborsRegressor . Its main parameter is the number of nearest neighbors . There are other parameters such as the distance metric (default for 2 order is the Euclidean distance). For a list of all the parameters see the Sklearn kNN Regressor Documentation . Let's use $5$ nearest neighbors. In [ ]: # Import the library from sklearn.neighbors import KNeighborsRegressor In [ ]: # Set number of neighbors k = 5 knnreg = KNeighborsRegressor ( n_neighbors = k ) In [ ]: # Fit the regressor - make sure your numpy arrays are the right shape knnreg . fit ( X_train , y_train ) # Evaluate the outcome on the train set using R&#94;2 r2_train = knnreg . score ( X_train , y_train ) # Print results print ( f 'kNN model with {k} neighbors gives R&#94;2 on the train set: {r2_train:.5} ' ) In [ ]: knnreg . predict ( X_test ) Exercise Calculate and print the $R&#94;{2}$ score on the test set In [ ]: # Your code here Not so good? Lets vary the number of neighbors and see what we get. In [ ]: # Make our lives easy by storing the different regressors in a dictionary regdict = {} # Make our lives easier by entering the k values from a list k_list = [ 1 , 2 , 4 , 15 ] # Do a bunch of KNN regressions for k in k_list : knnreg = KNeighborsRegressor ( n_neighbors = k ) knnreg . fit ( X_train , y_train ) # Store the regressors in a dictionary regdict [ k ] = knnreg # Print the dictionary to see what we have regdict Now let's plot all the k values in same plot. In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( dfcars . wt , dfcars . mpg , 'o' , label = \"data\" ) xgrid = np . linspace ( np . min ( dfcars . wt ), np . max ( dfcars . wt ), 100 ) # let's unpack the dictionary to its elements (items) which is the k and Regressor for k , regressor in regdict . items (): predictions = regressor . predict ( xgrid . reshape ( - 1 , 1 )) ax . plot ( xgrid , predictions , label = \" {} -NN\" . format ( k )) ax . legend (); Exercise Explain what you see in the graph. Hint Notice how the $1$-NN goes through every point on the training set but utterly fails elsewhere. Lets look at the scores on the training set. In [ ]: ks = range ( 1 , 15 ) # Grid of k's scores_train = [] # R2 scores for k in ks : # Create KNN model knnreg = KNeighborsRegressor ( n_neighbors = k ) # Fit the model to training data knnreg . fit ( X_train , y_train ) # Calculate R&#94;2 score score_train = knnreg . score ( X_train , y_train ) scores_train . append ( score_train ) # Plot fig , ax = plt . subplots ( 1 , 1 , figsize = ( 12 , 8 )) ax . plot ( ks , scores_train , 'o-' ) ax . set_xlabel ( r '$k$' ) ax . set_ylabel ( r '$R&#94; {2} $' ) Exercise Why do we get a perfect $R&#94;2$ at k=1 for the training set? Make the same plot as above on the test set. What is the best $k$? In [ ]: # Your code here In [ ]: # %load solutions/knn_regression.py In [ ]: # solution to previous exercise r2_test = knnreg . score ( X_test , y_test ) print ( f 'kNN model with {k} neighbors gives R&#94;2 on the test set: {r2_test:.5} ' ) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab03-ex/notebook/"},{"title":"Lab 03: Prelab","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A/STAT121A/AC209A/CSCIE109A Introduction to Data Science Pre - Lab 3: numpy , plotting PRE-LAB : DO THIS PART BEFORE COMING TO LAB Harvard University Fall 2019 Instructors: Pavlos Protopapas, Kevin Rader, and Chris Tanner Material prepared by : David Sondak, Will Claybaugh, Pavlos Protopapas, and Eleni Kaxiras In [1]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } Numerical Python: numpy Review the concepts on numpy: Scientific Python code uses a fast array structure, called the numpy array. Those who have worked in Matlab will find this very natural. For reference, the numpy documention can be found here: numpy . Let's make a numpy array. In [2]: import numpy as np In [3]: my_array = np . array ([ 1 , 4 , 9 , 16 ]) my_array Out[3]: array([ 1, 4, 9, 16]) Numpy arrays support the same operations as lists! Below we compute length, slice, and iterate. In [4]: print ( \"len(array):\" , len ( my_array )) # Length of array print ( \"array[2:4]:\" , my_array [ 2 : 4 ]) # A slice of the array # Iterate over the array for ele in my_array : print ( \"element:\" , ele ) len(array): 4 array[2:4]: [ 9 16] element: 1 element: 4 element: 9 element: 16 In general you should manipulate numpy arrays by using numpy module functions (e.g. np.mean ). This is for efficiency purposes, and a discussion follows below this section. You can calculate the mean of the array elements either by calling the method .mean on a numpy array or by applying the function np.mean with the numpy array as an argument. In [5]: # Two ways of calculating the mean print ( my_array . mean ()) print ( np . mean ( my_array )) 7.5 7.5 The way we constructed the numpy array above seems redundant. After all we already had a regular python list. Indeed, it is the other ways we have to construct numpy arrays that make them super useful. There are many such numpy array constructors . Here are some commonly used constructors. Look them up in the documentation. In [6]: zeros = np . zeros ( 10 ) # generates 10 floating point zeros zeros Out[6]: array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]) Numpy gains a lot of its efficiency from being strongly typed. That is, all elements in the array have the same type, such as integer or floating point. The default type, as can be seen above, is a float of size appropriate for the machine (64 bit on a 64 bit machine). In [7]: zeros . dtype Out[7]: dtype('float64') In [8]: np . ones ( 10 , dtype = 'int' ) # generates 10 integer ones Out[8]: array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1]) If the elements of an array are of a different type, numpy will force them into the same type (the longest in terms of bytes) In [9]: mixed = np . array ([ 1 , 2.3 , 'eleni' , True ]) #elements are of different type print ( type ( 1 ), type ( 2.3 ), type ( 'eleni' ), type ( True )) # all elements will become strings mixed Out[9]: array(['1', '2.3', 'eleni', 'True'], dtype=' Often you will want random numbers. Use the random constructor! In [10]: np . random . rand ( 10 ) # uniform on [0,1] Out[10]: array([0.07359295, 0.33989615, 0.339845 , 0.34741826, 0.69905879, 0.92948342, 0.66938911, 0.73665704, 0.77827516, 0.51589419]) You can generate random numbers from a normal distribution with mean $0$ and variance $1$ using np.random.randn : In [11]: normal_array = np . random . randn ( 10000 ) print ( \"The sample mean and standard devation are {0:17.16f} and {1:17.16f} , respectively.\" . format ( np . mean ( normal_array ), np . std ( normal_array ))) The sample mean and standard devation are 0.0030851544698295 and 1.0045760620230031, respectively. numpy supports vector operations What does this mean? It means that to add two arrays instead of looping ovr each element (e.g. via a list comprehension as in base Python) you get to simply put a plus sign between the two arrays. In [12]: ones_array = np . ones ( 5 ) twos_array = 2 * np . ones ( 5 ) ones_array + twos_array Out[12]: array([3., 3., 3., 3., 3.]) Note that this behavior is very different from python lists, which just get longer when you try to + them. In [13]: first_list = [ 1. , 1. , 1. , 1. , 1. ] second_list = [ 2. , 2. , 2. , 2. , 2. ] first_list + second_list # not what you want Out[13]: [1.0, 1.0, 1.0, 1.0, 1.0, 2.0, 2.0, 2.0, 2.0, 2.0] On some computer chips nunpy's addition actually happens in parallel, so speedups can be high. But even on regular chips, the advantage of greater readability is important. Numpy supports a concept known as broadcasting , which dictates how arrays of different sizes are combined together. There are too many rules to list all of them here. Here are two important rules: Multiplying an array by a number multiplies each element by the number Adding a number adds the number to each element. In [14]: ones_array + 1 Out[14]: array([2., 2., 2., 2., 2.]) In [15]: 5 * ones_array Out[15]: array([5., 5., 5., 5., 5.]) This means that if you wanted the distribution $N(5, 7)$ you could do: In [16]: normal_5_7 = 5.0 + 7.0 * normal_array np . mean ( normal_5_7 ), np . std ( normal_5_7 ) Out[16]: (5.021596081288807, 7.032032434161021) Now you have seen how to create and work with simple one dimensional arrays in numpy . You have also been introduced to some important numpy functionality (e.g. mean and std ). Next, we push ahead to two-dimensional arrays and begin to dive into some of the deeper aspects of numpy . 2D arrays We can create two-dimensional arrays without too much fuss. In [17]: # create a 2d-array by handing a list of lists my_array2d = np . array ([ [ 1 , 2 , 3 , 4 ], [ 5 , 6 , 7 , 8 ], [ 9 , 10 , 11 , 12 ] ]) # you can do the same without the pretty formatting (decide which style you like better) my_array2d = np . array ([ [ 1 , 2 , 3 , 4 ], [ 5 , 6 , 7 , 8 ], [ 9 , 10 , 11 , 12 ] ]) # 3 x 4 array of ones ones_2d = np . ones ([ 3 , 4 ]) print ( ones_2d , \" \\n \" ) # 3 x 4 array of ones with random noise ones_noise = ones_2d + 0.01 * np . random . randn ( 3 , 4 ) print ( ones_noise , \" \\n \" ) # 3 x 3 identity matrix my_identity = np . eye ( 3 ) print ( my_identity , \" \\n \" ) [[1. 1. 1. 1.] [1. 1. 1. 1.] [1. 1. 1. 1.]] [[0.9816037 1.00872872 0.99508861 1.00498201] [0.99632911 0.99093433 1.00719243 0.99397629] [1.00862567 1.0086024 1.01792008 1.01248539]] [[1. 0. 0.] [0. 1. 0.] [0. 0. 1.]] Like lists, numpy arrays are $0$-indexed. Thus we can access the $n$th row and the $m$th column of a two-dimensional array with the indices $[n - 1, m - 1]$. In [18]: print ( my_array2d ) print ( \"element [2,3] is:\" , my_array2d [ 2 , 3 ]) [[ 1 2 3 4] [ 5 6 7 8] [ 9 10 11 12]] element [2,3] is: 12 Numpy arrays can be sliced, and can be iterated over with loops. Below is a schematic illustrating slicing two-dimensional arrays. Notice that the list slicing syntax still works! array[2:,3] says \"in the array, get rows 2 through the end, column 3]\" array[3,:] says \"in the array, get row 3, all columns\". Numpy functions will by default work on the entire array: In [19]: np . sum ( ones_2d ) Out[19]: 12.0 The axis 0 is the one going downwards (i.e. the rows), whereas axis 1 is the one going across (the columns). You will often use functions such as mean or sum along a particular axis. If you sum along axis 0 you are summing across the rows and will end up with one value per column. As a rule, any axis you list in the axis argument will dissapear. In [20]: np . sum ( ones_2d , axis = 0 ) Out[20]: array([3., 3., 3., 3.]) In [21]: np . sum ( ones_2d , axis = 1 ) Out[21]: array([4., 4., 4.]) Exercise Create a two-dimensional array of size $3\\times 5$ and do the following: Print out the array Print out the shape of the array Create two slices of the array: The first slice should be the last row and the third through last column The second slice should be rows $1-3$ and columns $3-5$ Square each element in the array and print the result ( solutions follow but try not to look at them! ) In [22]: # your code here In [23]: # Solution A = np . array ([ [ 5 , 4 , 3 , 2 , 1 ], [ 1 , 2 , 3 , 4 , 5 ], [ 1.1 , 2.2 , 3.3 , 4.4 , 5.5 ] ]) print ( A , \" \\n \" ) # set length(shape) dims = A . shape print ( dims , \" \\n \" ) # slicing print ( A [ - 1 , 2 :], \" \\n \" ) print ( A [ 1 : 3 , 3 : 5 ], \" \\n \" ) # squaring A2 = A * A print ( A2 ) [[5. 4. 3. 2. 1. ] [1. 2. 3. 4. 5. ] [1.1 2.2 3.3 4.4 5.5]] (3, 5) [3.3 4.4 5.5] [[4. 5. ] [4.4 5.5]] [[25. 16. 9. 4. 1. ] [ 1. 4. 9. 16. 25. ] [ 1.21 4.84 10.89 19.36 30.25]] numpy supports matrix operations 2d arrays are numpy's way of representing matrices. As such there are lots of built-in methods for manipulating them Earlier when we generated the one-dimensional arrays of ones and random numbers, we gave ones and random the number of elements we wanted in the arrays. In two dimensions, we need to provide the shape of the array, i.e., the number of rows and columns of the array. In [24]: three_by_four = np . ones ([ 3 , 4 ]) three_by_four Out[24]: array([[1., 1., 1., 1.], [1., 1., 1., 1.], [1., 1., 1., 1.]]) You can transpose the array: In [25]: three_by_four . shape Out[25]: (3, 4) In [26]: four_by_three = three_by_four . T In [27]: four_by_three . shape Out[27]: (4, 3) Matrix multiplication is accomplished by np.dot . The * operator will do element-wise multiplication. In [28]: print ( np . dot ( three_by_four , four_by_three )) # 3 x 3 matrix np . dot ( four_by_three , three_by_four ) # 4 x 4 matrix [[4. 4. 4.] [4. 4. 4.] [4. 4. 4.]] Out[28]: array([[3., 3., 3., 3.], [3., 3., 3., 3.], [3., 3., 3., 3.], [3., 3., 3., 3.]]) Numpy Arrays vs. Python Lists? Why the need for numpy arrays? Can't we just use Python lists? Iterating over numpy arrays is slow. Slicing is faster. Python lists may contain items of different types. This flexibility comes at a price: Python lists store pointers to memory locations. On the other hand, numpy arrays are typed, where the default type is floating point. Because of this, the system knows how much memory to allocate, and if you ask for an array of size $100$, it will allocate one hundred contiguous spots in memory, where the size of each spot is based on the type. This makes access extremely fast. (image from Jake Vanderplas's Data Science Handbook) Unfortunately, looping over an array slows things down. In general you should not access numpy array elements by iteration. This is because of type conversion. Numpy stores integers and floating points in C -language format. When you operate on array elements through iteration, Python needs to convert that element to a Python int or float , which is a more complex beast (a struct in C jargon). This has a cost. (image from Jake Vanderplas's Data Science Handbook) If you want to know more, we will suggest that you read Jake Vanderplas's Data Science Handbook . Wes McKinney's Python for Data Analysis (HOLLIS) You will find them both incredible resources for this class. Why is slicing faster? The reason is technical: slicing provides a view onto the memory occupied by a numpy array, instead of creating a new array. That is the reason the code above this cell works nicely as well. However, if you iterate over a slice, then you have gone back to the slow access. By contrast, functions such as np.dot are implemented at C -level, do not do this type conversion, and access contiguous memory. If you want this kind of access in Python , use the struct module or Cython . Indeed many fast algorithms in numpy , pandas , and C are either implemented at the C -level, or employ Cython . 2 - Plotting with matplot lib (and beyond) Conveying your findings convincingly is an absolutely crucial part of any analysis. Therefore, you must be able to write well and make compelling visuals. Creating informative visuals is an involved process and we won't cover that in this lab. However, part of creating informative data visualizations means generating readable figures. If people can't read your figures or have a difficult time interpreting them, they won't understand the results of your work. Here are some non-negotiable commandments for any plot: Label $x$ and $y$ axes Axes labels should be informative Axes labels should be large enough to read Make tick labels large enough Include a legend if necessary Include a title if necessary Use appropriate line widths Use different line styles for different lines on the plot Use different markers for different lines There are other important elements, but that list should get you started on your way. Here is the anatomy of a figure: taken from showcase example code: anatomy.py . Before diving in, one more note should be made. We will not focus on the internal aspects of matplotlib . Today's lab will really only focus on the basics and developing good plotting practices. There are many excellent tutorials out there for matplotlib . For example, matplotlib homepage matplotlib tutorial matplotlib First, let's generate some data. Exercise Use the following three functions to make some plots: Logistic function: \\begin{align*} f\\left(z\\right) = \\dfrac{1}{1 + be&#94;{-az}} \\end{align*} where $a$ and $b$ are parameters. Hyperbolic tangent: \\begin{align*} g\\left(z\\right) = b\\tanh\\left(az\\right) + c \\end{align*} where $a$, $b$, and $c$ are parameters. Rectified Linear Unit: \\begin{align*} h\\left(z\\right) = \\left{ \\begin{array}{lr} z, \\quad z > 0 \\\\ \\epsilon z, \\quad z\\leq 0 \\end{array} \\right. \\end{align*} where $\\epsilon < 0$ is a small, positive parameter. You are given the code for the first two functions. Notice that $z$ is passed in as a numpy array and that the functions are returned as numpy arrays. Parameters are passed in as floats. You should write a function to compute the rectified linear unit. The input should be a numpy array for $z$ and a positive float for $\\epsilon$. In [29]: # Your code here In [30]: # solution import numpy as np def logistic ( z : np . ndarray , a : float , b : float ) -> np . ndarray : \"\"\" Compute logistic function Inputs: a: exponential parameter b: exponential prefactor z: numpy array; domain Outputs: f: numpy array of floats, logistic function \"\"\" den = 1.0 + b * np . exp ( - a * z ) return 1.0 / den def stretch_tanh ( z : np . ndarray , a : float , b : float , c : float ) -> np . ndarray : \"\"\" Compute stretched hyperbolic tangent Inputs: a: horizontal stretch parameter (a>1 implies a horizontal squish) b: vertical stretch parameter c: vertical shift parameter z: numpy array; domain Outputs: g: numpy array of floats, stretched tanh \"\"\" return b * np . tanh ( a * z ) + c def relu ( z : np . ndarray , eps : float = 0.01 ) -> np . ndarray : \"\"\" Compute rectificed linear unit Inputs: eps: small positive parameter z: numpy array; domain Outputs: h: numpy array; relu \"\"\" return np . fmax ( z , eps * z ) Now let's make some plots. First, let's just warm up and plot the logistic function. In [31]: x = np . linspace ( - 5.0 , 5.0 , 100 ) # Equally spaced grid of 100 pts between -5 and 5 f = logistic ( x , 1.0 , 1.0 ) # Generate data In [32]: import matplotlib.pyplot as plt # This is only needed in Jupyter notebooks! Displays the plots for us. % matplotlib inline plt . plot ( x , f ); # Use the semicolon to suppress some iPython output (not needed in real Python scripts) Wonderful! We have a plot. Let's clean it up a bit by putting some labels on it. In [33]: plt . plot ( x , f ) plt . xlabel ( 'x' ) plt . ylabel ( 'f' ) plt . title ( 'Logistic Function' ); Okay, it's getting better. Still super ugly. I see these kinds of plots at conferences all the time. Unreadable. We can do better. Much, much better. First, let's throw on a grid. In [34]: plt . plot ( x , f ) plt . xlabel ( 'x' ) plt . ylabel ( 'f' ) plt . title ( 'Logistic Function' ) plt . grid ( True ) At this point, our plot is starting to get a little better but also a little crowded. A note on gridlines Gridlines can be very helpful in many scientific disciplines. They help the reader quickly pick out important points and limiting values. On the other hand, they can really clutter the plot. Some people recommend never using gridlines, while others insist on them being present. The correct approach is probably somewhere in between. Use gridlines when necessary, but dispense with them when they take away more than they provide. Ask yourself if they help bring out some important conclusion from the plot. If not, then best just keep them away. Before proceeding any further, I'm going to change notation. The plotting interface we've been working with so far is okay, but not as flexible as it can be. In fact, I don't usually generate my plots with this interface. I work with slightly lower-level methods, which I will introduce to you now. The reason I need to make a big deal about this is because the lower-level methods have a slightly different API. This will become apparent in my next example. In [35]: fig , ax = plt . subplots ( 1 , 1 ) # Get figure and axes objects ax . plot ( x , f ) # Make a plot # Create some labels ax . set_xlabel ( 'x' ) ax . set_ylabel ( 'f' ) ax . set_title ( 'Logistic Function' ) # Grid ax . grid ( True ) Wow, it's exactly the same plot! Notice, however, the use of ax.set_xlabel() instead of plt.xlabel() . The difference is tiny, but you should be aware of it. I will use this plotting syntax from now on. What else do we need to do to make this figure better? Here are some options: Make labels bigger! Make line fatter Make tick mark labels bigger Make the grid less pronounced Make figure bigger Let's get to it. In [36]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Make figure bigger ax . plot ( x , f , lw = 4 ) # Linewidth bigger ax . set_xlabel ( 'x' , fontsize = 24 ) # Fontsize bigger ax . set_ylabel ( 'f' , fontsize = 24 ) # Fontsize bigger ax . set_title ( 'Logistic Function' , fontsize = 24 ) # Fontsize bigger ax . grid ( True , lw = 1.5 , ls = '--' , alpha = 0.75 ) # Update grid Notice: lw stands for linewidth . We could also write ax.plot(x, f, linewidth=4) ls stands for linestyle . alpha stands for transparency. Things are looking good now! Unfortunately, people still can't read the tick mark labels. Let's remedy that presently. In [37]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Make figure bigger # Make line plot ax . plot ( x , f , lw = 4 ) # Update ticklabel size ax . tick_params ( labelsize = 24 ) # Make labels ax . set_xlabel ( r '$x$' , fontsize = 24 ) # Use TeX for mathematical rendering ax . set_ylabel ( r '$f(x)$' , fontsize = 24 ) # Use TeX for mathematical rendering ax . set_title ( 'Logistic Function' , fontsize = 24 ) ax . grid ( True , lw = 1.5 , ls = '--' , alpha = 0.75 ) The only thing remaining to do is to change the $x$ limits. Clearly these should go from $-5$ to $5$. In [38]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Make figure bigger # Make line plot ax . plot ( x , f , lw = 4 ) # Set axes limits ax . set_xlim ( x . min (), x . max ()) # Update ticklabel size ax . tick_params ( labelsize = 24 ) # Make labels ax . set_xlabel ( r '$x$' , fontsize = 24 ) # Use TeX for mathematical rendering ax . set_ylabel ( r '$f(x)$' , fontsize = 24 ) # Use TeX for mathematical rendering ax . set_title ( 'Logistic Function' , fontsize = 24 ) ax . grid ( True , lw = 1.5 , ls = '--' , alpha = 0.75 ) You can play around with figures forever making them perfect. At this point, everyone can read and interpret this figure just fine. Don't spend your life making the perfect figure. Make it good enough so that you can convey your point to your audience. Then save if it for later. In [39]: fig . savefig ( 'logistic.png' ) Done! Let's take a look. Resources If you want to see all the styles available, please take a look at the documentation. Line styles Marker styles Everything you could ever want We haven't discussed it yet, but you can also put a legend on a figure. You'll do that in the next exercise. Here are some additional resources: Legend Grid Exercise Do the following: Make a figure with the logistic function, hyperbolic tangent, and rectified linear unit. Use different line styles for each plot Put a legend on your figure Here's an example of a figure: You don't need to make the exact same figure, but it should be just as nice and readable. In [40]: # your code here # First get the data f = logistic ( x , 2.0 , 1.0 ) g = stretch_tanh ( x , 2.0 , 0.5 , 0.5 ) h = relu ( x ) fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Create figure object # Make actual plots # (Notice the label argument!) ax . plot ( x , f , lw = 4 , ls = '-' , label = r '$L(x;1)$' ) ax . plot ( x , g , lw = 4 , ls = '--' , label = r '$\\tanh(2x)$' ) ax . plot ( x , h , lw = 4 , ls = '-.' , label = r '$relu(x; 0.01)$' ) # Make the tick labels readable ax . tick_params ( labelsize = 24 ) # Set axes limits to make the scale nice ax . set_xlim ( x . min (), x . max ()) ax . set_ylim ( h . min (), 1.1 ) # Make readable labels ax . set_xlabel ( r '$x$' , fontsize = 24 ) ax . set_ylabel ( r '$h(x)$' , fontsize = 24 ) ax . set_title ( 'Activation Functions' , fontsize = 24 ) # Set up grid ax . grid ( True , lw = 1.75 , ls = '--' , alpha = 0.75 ) # Put legend on figure ax . legend ( loc = 'best' , fontsize = 24 ); fig . savefig ( 'nice_plots.png' ) There a many more things you can do to the figure to spice it up. Remember, there must be a tradeoff between making a figure look good and the time you put into it. The guiding principle should be that your audience needs to easily read and understand your figure. There are of course other types of figures including, but not limited to, Scatter plots (you will use these all the time) Bar charts Histograms Contour plots Surface plots Heatmaps We will learn more about these different types of plotting in Lab5. Before moving on, we will discuss another way to make your plots look good without all the hassle. I'll make a beautiful plot without having to specify annoying arguments every single time. In [41]: # First get the data f1 = logistic ( x , 1.0 , 1.0 ) f2 = logistic ( x , 2.0 , 1.0 ) f3 = logistic ( x , 3.0 , 1.0 ) fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Create figure object # Make actual plots # (Notice the label argument!) ax . plot ( x , f1 , ls = '-' , label = r '$L(x;-1)$' ) ax . plot ( x , f2 , ls = '--' , label = r '$L(x;-2)$' ) ax . plot ( x , f3 , ls = '-.' , label = r '$L(x;-3)$' ) # Set axes limits to make the scale nice ax . set_xlim ( x . min (), x . max ()) ax . set_ylim ( h . min (), 1.1 ) # Make readable labels ax . set_xlabel ( r '$x$' ) ax . set_ylabel ( r '$h(x)$' ) ax . set_title ( 'Logistic Functions' ) # Set up grid ax . grid ( True , lw = 1.75 , ls = '--' , alpha = 0.75 ) # Put legend on figure ax . legend ( loc = 'best' ) Out[41]: That's a good-looking plot! Notice that we didn't need to have all those annoying fontsize specifications floating around. If you want to reset the defaults, just use plt.rcdefaults() . Now, how in the world did this work? Obviously, there is something special about the config file. I didn't give you a config file, but the next exercise requires you to create one. No Excuses With all of these resourses, there is no reason to have a bad figure. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab03-pandas/notebook/"},{"title":"Lab 03: Matplotlib, Simple Linear Regression, kNN, array reshape","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A/STAT121A/AC209A/CSCIE109A Introduction to Data Science Lab 3: plotting, K-NN Regression, Simple Linear Regression Harvard University Fall 2019 Instructors: Pavlos Protopapas, Kevin Rader, and Chris Tanner Material prepared by : David Sondak, Will Claybaugh, Pavlos Protopapas, and Eleni Kaxiras. In [1]: #RUN THIS CELL import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } Learning Goals By the end of this lab, you should be able to: Review numpy including 2-D arrays and understand array reshaping Use matplotlib to make plots Feel comfortable with simple linear regression Feel comfortable with $k$ nearest neighbors This lab corresponds to lectures 4 and 5 and maps on to homework 2 and beyond. Table of Contents HIGHLIGHTS FROM PRE-LAB 1 - Review of numpy 2 - Intro to matplotlib plus more LAB 3 MATERIAL 3 - Simple Linear Regression 4 - Building a model with statsmodels and sklearn 5 - Example: Simple linear regression with automobile data 6 - $k$Nearest Neighbors In [2]: import numpy as np import scipy as sp import matplotlib as mpl import matplotlib.cm as cm import matplotlib.pyplot as plt import pandas as pd import time pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) pd . set_option ( 'display.notebook_repr_html' , True ) #import seaborn as sns import warnings warnings . filterwarnings ( 'ignore' ) # Displays the plots for us. % matplotlib inline In [3]: # Use this as a variable to load solutions: %load PATHTOSOLUTIONS/exercise1.py. It will be substituted in the code # so do not worry if it disappears after you run the cell. PATHTOSOLUTIONS = 'solutions' 1 - Review of the numpy Python library In lab1 we learned about the numpy library (documentation) and its fast array structure, called the numpy array . In [4]: # import numpy import numpy as np In [5]: # make an array my_array = np . array ([ 1 , 4 , 9 , 16 ]) my_array Out[5]: array([ 1, 4, 9, 16]) In [6]: print ( f 'Size of my array: {my_array.size} , or length of my array: {len(my_array)}' ) print ( f 'Shape of my array: {my_array.shape} ' ) Size of my array: 4, or length of my array: 4 Shape of my array: (4,) Notice the way the shape appears in numpy arrays For a 1D array, .shape returns a tuple with 1 element (n,) For a 2D array, .shape returns a tuple with 2 elements (n,m) For a 3D array, .shape returns a tuple with 3 elements (n,m,p) In [7]: # How to reshape a 1D array to a 2D my_array . reshape ( 2 , - 1 ) Out[7]: array([[ 1, 4], [ 9, 16]]) Numpy arrays support the same operations as lists! Below we slice and iterate. In [8]: print ( \"array[2:4]:\" , my_array [ 2 : 4 ]) # A slice of the array # Iterate over the array for ele in my_array : print ( \"element:\" , ele ) array[2:4]: [ 9 16] element: 1 element: 4 element: 9 element: 16 Remember numpy gains a lot of its efficiency from being strongly typed (all elements are of the same type, such as integer or floating point). If the elements of an array are of a different type, numpy will force them into the same type (the longest in terms of bytes) In [9]: mixed = np . array ([ 1 , 2.3 , 'eleni' , True ]) print ( type ( 1 ), type ( 2.3 ), type ( 'eleni' ), type ( True )) mixed # all elements will become strings Out[9]: array(['1', '2.3', 'eleni', 'True'], dtype=' Next, we push ahead to two-dimensional arrays and begin to dive into some of the deeper aspects of numpy . In [10]: # create a 2d-array by handing a list of lists my_array2d = np . array ([ [ 1 , 2 , 3 , 4 ], [ 5 , 6 , 7 , 8 ], [ 9 , 10 , 11 , 12 ] ]) my_array2d Out[10]: array([[ 1, 2, 3, 4], [ 5, 6, 7, 8], [ 9, 10, 11, 12]]) Array Slicing (a reminder...) Numpy arrays can be sliced, and can be iterated over with loops. Below is a schematic illustrating slicing two-dimensional arrays. Notice that the list slicing syntax still works! array[2:,3] says \"in the array, get rows 2 through the end, column 3]\" array[3,:] says \"in the array, get row 3, all columns\". Pandas Slicing (a reminder...) .iloc is by position (position is unique), .loc is by label (label is not unique) In [11]: # import cast dataframe cast = pd . read_csv ( '../data/cast.csv' , encoding = 'utf_8' ) cast . head () Out[11]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } title year name type character n 0 Closet Monster 2015 Buffy #1 actor Buffy 4 31.0 1 Suuri illusioni 1985 Homo $ actor Guests 22.0 2 Battle of the Sexes 2017 $hutter actor Bobby Riggs Fan 10.0 3 Secret in Their Eyes 2015 $hutter actor 2002 Dodger Fan NaN 4 Steve Jobs 2015 $hutter actor 1988 Opera House Patron NaN In [12]: # get me rows 10 to 13 (python slicing style : exclusive of end) cast . iloc [ 10 : 13 ] Out[12]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } title year name type character n 10 When the Man Went South 2014 Taipaleti 'Atu'ake actor Two Palms - Ua'i Paame 8.0 11 Little Angel (Angelita) 2015 Michael 'babeepower' Viera actor Chico 9.0 12 Mixing Nia 1998 Michael 'babeepower' Viera actor Rapper NaN In [13]: # get me columns 0 to 2 but all rows - use head() cast . iloc [:, 0 : 2 ] . head () Out[13]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } title year 0 Closet Monster 2015 1 Suuri illusioni 1985 2 Battle of the Sexes 2017 3 Secret in Their Eyes 2015 4 Steve Jobs 2015 In [14]: # get me rows 10 to 13 AND only columns 0 to 2 cast . iloc [ 10 : 13 , 0 : 2 ] Out[14]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } title year 10 When the Man Went South 2014 11 Little Angel (Angelita) 2015 12 Mixing Nia 1998 In [15]: # COMPARE: get me rows 10 to 13 (pandas slicing style : inclusive of end) cast . loc [ 10 : 13 ] Out[15]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } title year name type character n 10 When the Man Went South 2014 Taipaleti 'Atu'ake actor Two Palms - Ua'i Paame 8.0 11 Little Angel (Angelita) 2015 Michael 'babeepower' Viera actor Chico 9.0 12 Mixing Nia 1998 Michael 'babeepower' Viera actor Rapper NaN 13 The Replacements 2000 Steven 'Bear'Boyd actor Defensive Tackle - Washington Sentinels NaN In [16]: # give me columns 'year' and 'type' by label but only for rows 5 to 10 cast . loc [ 5 : 10 ,[ 'year' , 'type' ]] Out[16]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } year type 5 2015 actor 6 2015 actor 7 2009 actor 8 2014 actor 9 2014 actor 10 2014 actor 2 - Plotting with matplotlib and beyond matplotlib is a very powerful python library for making scientific plots. We will not focus too much on the internal aspects of matplotlib in today's lab. There are many excellent tutorials out there for matplotlib . For example, matplotlib homepage matplotlib tutorial Conveying your findings convincingly is an absolutely crucial part of any analysis. Therefore, you must be able to write well and make compelling visuals. Creating informative visuals is an involved process and we won't cover that in this lab. However, part of creating informative data visualizations means generating readable figures. If people can't read your figures or have a difficult time interpreting them, they won't understand the results of your work. Here are some non-negotiable commandments for any plot: Label $x$ and $y$ axes Axes labels should be informative Axes labels should be large enough to read Make tick labels large enough Include a legend if necessary Include a title if necessary Use appropriate line widths Use different line styles for different lines on the plot Use different markers for different lines There are other important elements, but that list should get you started on your way. We will work with matplotlib and seaborn for plotting in this class. matplotlib is a very powerful python library for making scientific plots. seaborn is a little more specialized in that it was developed for statistical data visualization. We will cover some seaborn later in class. In the meantime you can look at the seaborn documentation First, let's generate some data. Let's plot some functions We will use the following three functions to make some plots: Logistic function: \\begin{align*} f\\left(z\\right) = \\dfrac{1}{1 + be&#94;{-az}} \\end{align*} where $a$ and $b$ are parameters. Hyperbolic tangent: \\begin{align*} g\\left(z\\right) = b\\tanh\\left(az\\right) + c \\end{align*} where $a$, $b$, and $c$ are parameters. Rectified Linear Unit: \\begin{align*} h\\left(z\\right) = \\left{ \\begin{array}{lr} z, \\quad z > 0 \\\\ \\epsilon z, \\quad z\\leq 0 \\end{array} \\right. \\end{align*} where $\\epsilon < 0$ is a small, positive parameter. You are given the code for the first two functions. Notice that $z$ is passed in as a numpy array and that the functions are returned as numpy arrays. Parameters are passed in as floats. You should write a function to compute the rectified linear unit. The input should be a numpy array for $z$ and a positive float for $\\epsilon$. In [17]: import numpy as np def logistic ( z : np . ndarray , a : float , b : float ) -> np . ndarray : \"\"\" Compute logistic function Inputs: a: exponential parameter b: exponential prefactor z: numpy array; domain Outputs: f: numpy array of floats, logistic function \"\"\" den = 1.0 + b * np . exp ( - a * z ) return 1.0 / den def stretch_tanh ( z : np . ndarray , a : float , b : float , c : float ) -> np . ndarray : \"\"\" Compute stretched hyperbolic tangent Inputs: a: horizontal stretch parameter (a>1 implies a horizontal squish) b: vertical stretch parameter c: vertical shift parameter z: numpy array; domain Outputs: g: numpy array of floats, stretched tanh \"\"\" return b * np . tanh ( a * z ) + c def relu ( z : np . ndarray , eps : float = 0.01 ) -> np . ndarray : \"\"\" Compute rectificed linear unit Inputs: eps: small positive parameter z: numpy array; domain Outputs: h: numpy array; relu \"\"\" return np . fmax ( z , eps * z ) Now let's make some plots. First, let's just warm up and plot the logistic function. In [18]: x = np . linspace ( - 5.0 , 5.0 , 100 ) # Equally spaced grid of 100 pts between -5 and 5 f = logistic ( x , 1.0 , 1.0 ) # Generate data In [19]: plt . plot ( x , f ) plt . xlabel ( 'x' ) plt . ylabel ( 'f' ) plt . title ( 'Logistic Function' ) plt . grid ( True ) Figures with subplots Let's start thinking about the plots as objects. We have the figure object which is like a matrix of smaller plots named axes . You can use array notation when handling it. In [20]: fig , ax = plt . subplots ( 1 , 1 ) # Get figure and axes objects ax . plot ( x , f ) # Make a plot # Create some labels ax . set_xlabel ( 'x' ) ax . set_ylabel ( 'f' ) ax . set_title ( 'Logistic Function' ) # Grid ax . grid ( True ) Wow, it's exactly the same plot! Notice, however, the use of ax.set_xlabel() instead of plt.xlabel() . The difference is tiny, but you should be aware of it. I will use this plotting syntax from now on. What else do we need to do to make this figure better? Here are some options: Make labels bigger! Make line fatter Make tick mark labels bigger Make the grid less pronounced Make figure bigger Let's get to it. In [24]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Make figure bigger # Make line plot ax . plot ( x , f , lw = 4 ) # Update ticklabel size ax . tick_params ( labelsize = 24 ) # Make labels ax . set_xlabel ( r '$x$' , fontsize = 24 ) # Use TeX for mathematical rendering ax . set_ylabel ( r '$f(x)$' , fontsize = 24 ) # Use TeX for mathematical rendering ax . set_title ( 'Logistic Function' , fontsize = 24 ) ax . grid ( True , lw = 1.5 , ls = '--' , alpha = 0.75 ) Notice: lw stands for linewidth . We could also write ax.plot(x, f, linewidth=4) ls stands for linestyle . alpha stands for transparency. The only thing remaining to do is to change the $x$ limits. Clearly these should go from $-5$ to $5$. In [22]: #fig.savefig('logistic.png') # Put this in a markdown cell and uncomment this to check what you saved. # ![](../images/logistic.png) Resources If you want to see all the styles available, please take a look at the documentation. Line styles Marker styles Everything you could ever want We haven't discussed it yet, but you can also put a legend on a figure. You'll do that in the next exercise. Here are some additional resources: Legend Grid ax.legend(loc='best', fontsize=24); Exercise Do the following: Make a figure with the logistic function, hyperbolic tangent, and rectified linear unit. Use different line styles for each plot Put a legend on your figure Here's an example of a figure: In [25]: # your code here # First get the data f = logistic ( x , 2.0 , 1.0 ) g = stretch_tanh ( x , 2.0 , 0.5 , 0.5 ) h = relu ( x ) fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Create figure object # Make actual plots # (Notice the label argument!) ax . plot ( x , f , lw = 4 , ls = '-' , label = r '$L(x;1)$' ) ax . plot ( x , g , lw = 4 , ls = '--' , label = r '$\\tanh(2x)$' ) ax . plot ( x , h , lw = 4 , ls = '-.' , label = r '$relu(x; 0.01)$' ) # Make the tick labels readable ax . tick_params ( labelsize = 24 ) # Set axes limits to make the scale nice ax . set_xlim ( x . min (), x . max ()) ax . set_ylim ( h . min (), 1.1 ) # Make readable labels ax . set_xlabel ( r '$x$' , fontsize = 24 ) ax . set_ylabel ( r '$h(x)$' , fontsize = 24 ) ax . set_title ( 'Activation Functions' , fontsize = 24 ) # Set up grid ax . grid ( True , lw = 1.75 , ls = '--' , alpha = 0.75 ) # Put legend on figure ax . legend ( loc = 'best' , fontsize = 24 ); fig . savefig ( '../images/nice_plots.png' ) Exercise These figures look nice in the plot and it makes sense for comparison. Now let's put the 3 different figures in separate plots. Make a separate plot for each figure and line them up on the same row. In [ ]: # your code here In [ ]: # %load solutions/three_subplots.py Exercise Make a grid of 2 x 3 separate plots, 3 will be empty. Just plot the functions and do not worry about cosmetics. We just want you ro see the functionality. In [ ]: # your code here In [ ]: # %load solutions/six_subplots.py 3 - Simple Linear Regression Linear regression and its many extensions are a workhorse of the statistics and data science community, both in application and as a reference point for other models. Most of the major concepts in machine learning can be and often are discussed in terms of various linear regression models. Thus, this section will introduce you to building and fitting linear regression models and some of the process behind it, so that you can 1) fit models to data you encounter 2) experiment with different kinds of linear regression and observe their effects 3) see some of the technology that makes regression models work. Linear regression with a toy dataset We first examine a toy problem, focusing our efforts on fitting a linear model to a small dataset with three observations. Each observation consists of one predictor $x_i$ and one response $y_i$ for $i = 1, 2, 3$, \\begin{align*} (x , y) = \\{(x_1, y_1), (x_2, y_2), (x_3, y_3)\\}. \\end{align*} To be very concrete, let's set the values of the predictors and responses. \\begin{equation*} (x , y) = \\{(1, 2), (2, 2), (3, 4)\\} \\end{equation*} There is no line of the form $\\beta_0 + \\beta_1 x = y$ that passes through all three observations, since the data are not collinear. Thus our aim is to find the line that best fits these observations in the least-squares sense , as discussed in lecture. Exercise (for home) Make two numpy arrays out of this data, x_train and y_train Check the dimentions of these arrays Try to reshape them into a different shape Make points into a very simple scatterplot Make a better scatterplot In [ ]: # your code here In [ ]: # solution x_train = np . array ([ 1 , 2 , 3 ]) y_train = np . array ([ 2 , 3 , 6 ]) type ( x_train ) In [ ]: x_train . shape In [ ]: x_train = x_train . reshape ( 3 , 1 ) x_train . shape In [ ]: xx = np . array ([[ 1 , 3 , 5 ],[ 6 , 2 , 1 ]]) xx . shape In [ ]: xx = xx . reshape ( 3 , - 1 ) xx In [ ]: # %load solutions/simple_scatterplot.py # Make a simple scatterplot plt . scatter ( x_train , y_train ) # check dimensions print ( x_train . shape , y_train . shape ) In [ ]: # %load solutions/nice_scatterplot.py def nice_scatterplot ( x , y , title ): # font size f_size = 18 # make the figure fig , ax = plt . subplots ( 1 , 1 , figsize = ( 8 , 5 )) # Create figure object # set axes limits to make the scale nice ax . set_xlim ( np . min ( x ) - 1 , np . max ( x ) + 1 ) ax . set_ylim ( np . min ( y ) - 1 , np . max ( y ) + 1 ) # adjust size of tickmarks in axes ax . tick_params ( labelsize = f_size ) # remove tick labels ax . tick_params ( labelbottom = False , bottom = False ) # adjust size of axis label ax . set_xlabel ( r '$x$' , fontsize = f_size ) ax . set_ylabel ( r '$y$' , fontsize = f_size ) # set figure title label ax . set_title ( title , fontsize = f_size ) # you may set up grid with this ax . grid ( True , lw = 1.75 , ls = '--' , alpha = 0.15 ) # make actual plot (Notice the label argument!) #ax.scatter(x, y, label=r'$my points$') #ax.scatter(x, y, label='$my points$') ax . scatter ( x , y , label = r '$my\\,points$' ) ax . legend ( loc = 'best' , fontsize = f_size ); return ax nice_scatterplot ( x_train , y_train , 'hello nice plot' ) Formulae Linear regression is special among the models we study because it can be solved explicitly. While most other models (and even some advanced versions of linear regression) must be solved itteratively, linear regression has a formula where you can simply plug in the data. For the single predictor case it is: \\begin{align} \\beta_1 &= \\frac{\\sum_{i=1}&#94;n{(x_i-\\bar{x})(y_i-\\bar{y})}}{\\sum_{i=1}&#94;n{(x_i-\\bar{x})&#94;2}}\\\\ \\beta_0 &= \\bar{y} - \\beta_1\\bar{x}\\ \\end{align} Where $\\bar{y}$ and $\\bar{x}$ are the mean of the y values and the mean of the x values, respectively. From the re-aranged second equation we can see that the best-fit line passes through $(\\bar{x},\\bar{y})$, the center of mass of the data From any of the first equations, we can see that the slope of the line has to do with whether or not an x value that is above/below the center of mass is typically paired with a y value that is likewise above/below, or typically paired with one that is opposite. Building a model from scratch In this part, we will solve the equations for simple linear regression and find the best fit solution to our toy problem. The snippets of code below implement the linear regression equations on the observed predictors and responses, which we'll call the training data set. Let's walk through the code. We have to reshape our arrrays to 2D. We will see later why. Exercise make an array with shape (2,3) reshape it to a size that you want In [ ]: # your code here xx = np . array ([[ 1 , 2 , 3 ],[ 4 , 6 , 8 ]]) xxx = xx . reshape ( - 1 , 2 ) xxx . shape In [ ]: # Reshape to be a proper 2D array x_train = x_train . reshape ( x_train . shape [ 0 ], 1 ) y_train = y_train . reshape ( y_train . shape [ 0 ], 1 ) print ( x_train . shape ) In [ ]: # first, compute means y_bar = np . mean ( y_train ) x_bar = np . mean ( x_train ) # build the two terms numerator = np . sum ( ( x_train - x_bar ) * ( y_train - y_bar ) ) denominator = np . sum (( x_train - x_bar ) ** 2 ) print ( numerator . shape , denominator . shape ) #check shapes Why the empty brackets? (The numerator and denominator are scalars, as expected.) In [ ]: #slope beta1 beta_1 = numerator / denominator #intercept beta0 beta_0 = y_bar - beta_1 * x_bar print ( \"The best-fit line is {0:3.2f} + {1:3.2f} * x\" . format ( beta_0 , beta_1 )) print ( f 'The best fit is {beta_0} ' ) Exercise Turn the code from the above cells into a function called simple_linear_regression_fit , that inputs the training data and returns beta0 and beta1 . To do this, copy and paste the code from the above cells below and adjust the code as needed, so that the training data becomes the input and the betas become the output. def simple_linear_regression_fit ( x_train : np . ndarray , y_train : np . ndarray ) -> np . ndarray : return Check your function by calling it with the training data from above and printing out the beta values. In [ ]: # Your code here In [ ]: # %load solutions/simple_linear_regression_fit.py def simple_linear_regression_fit ( x_train : np . ndarray , y_train : np . ndarray ) -> np . ndarray : \"\"\" Inputs: x_train: a (num observations by 1) array holding the values of the predictor variable y_train: a (num observations by 1) array holding the values of the response variable Returns: beta_vals: a (num_features by 1) array holding the intercept and slope coeficients \"\"\" # Check input array sizes if len ( x_train . shape ) < 2 : print ( \"Reshaping features array.\" ) x_train = x_train . reshape ( x_train . shape [ 0 ], 1 ) if len ( y_train . shape ) < 2 : print ( \"Reshaping observations array.\" ) y_train = y_train . reshape ( y_train . shape [ 0 ], 1 ) # first, compute means y_bar = np . mean ( y_train ) x_bar = np . mean ( x_train ) # build the two terms numerator = np . sum ( ( x_train - x_bar ) * ( y_train - y_bar ) ) denominator = np . sum (( x_train - x_bar ) ** 2 ) #slope beta1 beta_1 = numerator / denominator #intercept beta0 beta_0 = y_bar - beta_1 * x_bar return np . array ([ beta_0 , beta_1 ]) Let's run this function and see the coefficients In [ ]: x_train = np . array ([ 1 , 2 , 3 ]) y_train = np . array ([ 2 , 2 , 4 ]) betas = simple_linear_regression_fit ( x_train , y_train ) beta_0 = betas [ 0 ] beta_1 = betas [ 1 ] print ( \"The best-fit line is {0:8.6f} + {1:8.6f} * x\" . format ( beta_0 , beta_1 )) Exercise Do the values of beta0 and beta1 seem reasonable? Plot the training data using a scatter plot. Plot the best fit line with beta0 and beta1 together with the training data. In [ ]: # Your code here In [ ]: # %load solutions/best_fit_scatterplot.py fig_scat , ax_scat = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Plot best-fit line x_train = np . array ([[ 1 , 2 , 3 ]]) . T best_fit = beta_0 + beta_1 * x_train ax_scat . scatter ( x_train , y_train , s = 300 , label = 'Training Data' ) ax_scat . plot ( x_train , best_fit , ls = '--' , label = 'Best Fit Line' ) ax_scat . set_xlabel ( r '$x_ {train} $' ) ax_scat . set_ylabel ( r '$y$' ); The values of beta0 and beta1 seem roughly reasonable. They capture the positive correlation. The line does appear to be trying to get as close as possible to all the points. 4 - Building a model with statsmodels and sklearn Now that we can concretely fit the training data from scratch, let's learn two python packages to do it all for us: statsmodels and scikit-learn (sklearn) . Our goal is to show how to implement simple linear regression with these packages. For an important sanity check, we compare the $\\beta$ values from statsmodels and sklearn to the $\\beta$ values that we found from above with our own implementation. For the purposes of this lab, statsmodels and sklearn do the same thing. More generally though, statsmodels tends to be easier for inference [finding the values of the slope and intercept and dicussing uncertainty in those values], whereas sklearn has machine-learning algorithms and is better for prediction [guessing y values for a given x value]. (Note that both packages make the same guesses, it's just a question of which activity they provide more support for. Note: statsmodels and sklearn are different packages! Unless we specify otherwise, you can use either one. Below is the code for statsmodels . Statsmodels does not by default include the column of ones in the $X$ matrix, so we include it manually with sm.add_constant . In [ ]: import statsmodels.api as sm In [ ]: # create the X matrix by appending a column of ones to x_train X = sm . add_constant ( x_train ) # this is the same matrix as in our scratch problem! print ( X ) # build the OLS model (ordinary least squares) from the training data toyregr_sm = sm . OLS ( y_train , X ) # do the fit and save regression info (parameters, etc) in results_sm results_sm = toyregr_sm . fit () # pull the beta parameters out from results_sm beta0_sm = results_sm . params [ 0 ] beta1_sm = results_sm . params [ 1 ] print ( f 'The regression coef from statsmodels are: beta_0 = {beta0_sm:8.6f} and beta_1 = {beta1_sm:8.6f} ' ) Besides the beta parameters, results_sm contains a ton of other potentially useful information. In [ ]: import warnings warnings . filterwarnings ( 'ignore' ) print ( results_sm . summary ()) Now let's turn our attention to the sklearn library. In [ ]: from sklearn import linear_model In [ ]: # build the least squares model toyregr = linear_model . LinearRegression () # save regression info (parameters, etc) in results_skl results = toyregr . fit ( x_train , y_train ) # pull the beta parameters out from results_skl beta0_skl = toyregr . intercept_ beta1_skl = toyregr . coef_ [ 0 ] print ( \"The regression coefficients from the sklearn package are: beta_0 = {0:8.6f} and beta_1 = {1:8.6f} \" . format ( beta0_skl , beta1_skl )) We should feel pretty good about ourselves now, and we're ready to move on to a real problem! The scikit-learn library and the shape of things Before diving into a \"real\" problem, let's discuss more of the details of sklearn . Scikit-learn is the main Python machine learning library. It consists of many learners which can learn models from data, as well as a lot of utility functions such as train_test_split() . Use the following to add the library into your code: import sklearn In scikit-learn , an estimator is a Python object that implements the methods fit(X, y) and predict(T) Let's see the structure of scikit-learn needed to make these fits. fit() always takes two arguments: estimator . fit ( Xtrain , ytrain ) We will consider two estimators in this lab: LinearRegression and KNeighborsRegressor . It is very important to understand that Xtrain must be in the form of a 2x2 array with each row corresponding to one sample, and each column corresponding to the feature values for that sample. ytrain on the other hand is a simple array of responses. These are continuous for regression problems. Practice with sklearn and a real dataset We begin by loading up the mtcars dataset. This data was extracted from the 1974 Motor Trend US magazine, and comprises of fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973–74 models). We will load this data to a dataframe with 32 observations on 11 (numeric) variables. Here is an explanation of the features: mpg is Miles/(US) gallon cyl is Number of cylinders, disp is Displacement (cu.in.), hp is Gross horsepower, drat is Rear axle ratio, wt is the Weight (1000 lbs), qsec is 1/4 mile time, vs is Engine (0 = V-shaped, 1 = straight), am is Transmission (0 = automatic, 1 = manual), gear is the Number of forward gears, carb is Number of carburetors. In [ ]: import pandas as pd #load mtcars dfcars = pd . read_csv ( \"../data/mtcars.csv\" ) dfcars . head () In [ ]: # Fix the column title dfcars = dfcars . rename ( columns = { \"Unnamed: 0\" : \"car name\" }) dfcars . head () In [ ]: dfcars . shape Searching for values: how many cars have 4 gears? In [ ]: len ( dfcars [ dfcars . gear == 4 ] . drop_duplicates ( subset = 'car name' , keep = 'first' )) Next, let's split the dataset into a training set and test set. In [ ]: # split into training set and testing set from sklearn.model_selection import train_test_split #set random_state to get the same split every time traindf , testdf = train_test_split ( dfcars , test_size = 0.2 , random_state = 42 ) In [ ]: # testing set is around 20% of the total data; training set is around 80% print ( \"Shape of full dataset is: {0} \" . format ( dfcars . shape )) print ( \"Shape of training dataset is: {0} \" . format ( traindf . shape )) print ( \"Shape of test dataset is: {0} \" . format ( testdf . shape )) Now we have training and test data. We still need to select a predictor and a response from this dataset. Keep in mind that we need to choose the predictor and response from both the training and test set. You will do this in the exercises below. However, we provide some starter code for you to get things going. In [ ]: traindf . head () In [ ]: # Extract the response variable that we're interested in y_train = traindf . mpg y_train Exercise Use slicing to get the same vector y_train Now, notice the shape of y_train . In [ ]: y_train . shape , type ( y_train ) Array reshape This is a 1D array as should be the case with the Y array. Remember, sklearn requires a 2D array only for the predictor array. You will have to pay close attention to this in the exercises later. Sklearn doesn't care too much about the shape of y_train . The whole reason we went through that whole process was to show you how to reshape your data into the correct format. IMPORTANT: Remember that your response variable ytrain can be a vector but your predictor variable xtrain must be an array! 5 - Example: Simple linear regression with automobile data We will now use sklearn to predict automobile mileage per gallon (mpg) and evaluate these predictions. We already loaded the data and split them into a training set and a test set. We need to choose the variables that we think will be good predictors for the dependent variable mpg . Exercise in pairs Pick one variable to use as a predictor for simple linear regression. Discuss your reasons with the person next to you. Justify your choice with some visualizations. Is there a second variable you'd like to use? For example, we're not doing multiple linear regression here, but if we were, is there another variable you'd like to include if we were using two predictors? In [ ]: x_wt = dfcars . wt x_wt . shape In [ ]: # Your code here In [ ]: # %load solutions/cars_simple_EDA.py Exercise Use sklearn to fit the training data using simple linear regression. Use the model to make mpg predictions on the test set. Plot the data and the prediction. Print out the mean squared error for the training set and the test set and compare. In [ ]: from sklearn.linear_model import LinearRegression from sklearn.model_selection import train_test_split from sklearn.metrics import mean_squared_error dfcars = pd . read_csv ( \"../data/mtcars.csv\" ) dfcars = dfcars . rename ( columns = { \"Unnamed: 0\" : \"name\" }) dfcars . head () In [ ]: traindf , testdf = train_test_split ( dfcars , test_size = 0.2 , random_state = 42 ) y_train = np . array ( traindf . mpg ) X_train = np . array ( traindf . wt ) X_train = X_train . reshape ( X_train . shape [ 0 ], 1 ) In [ ]: y_test = np . array ( testdf . mpg ) X_test = np . array ( testdf . wt ) X_test = X_test . reshape ( X_test . shape [ 0 ], 1 ) In [ ]: # Let's take another look at our data dfcars . head () In [ ]: # And out train and test sets y_train . shape , X_train . shape In [ ]: y_test . shape , X_test . shape In [ ]: #create linear model regression = LinearRegression () #fit linear model regression . fit ( X_train , y_train ) predicted_y = regression . predict ( X_test ) r2 = regression . score ( X_test , y_test ) print ( f 'R&#94;2 = {r2:.5} ' ) In [ ]: print ( regression . score ( X_train , y_train )) print ( mean_squared_error ( predicted_y , y_test )) print ( mean_squared_error ( y_train , regression . predict ( X_train ))) print ( 'Coefficients: \\n ' , regression . coef_ [ 0 ], regression . intercept_ ) In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( y_test , predicted_y , 'o' ) grid = np . linspace ( np . min ( dfcars . mpg ), np . max ( dfcars . mpg ), 100 ) ax . plot ( grid , grid , color = \"black\" ) # 45 degree line ax . set_xlabel ( \"actual y\" ) ax . set_ylabel ( \"predicted y\" ) fig1 , ax1 = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax1 . plot ( dfcars . wt , dfcars . mpg , 'o' ) xgrid = np . linspace ( np . min ( dfcars . wt ), np . max ( dfcars . wt ), 100 ) ax1 . plot ( xgrid , regression . predict ( xgrid . reshape ( 100 , 1 ))) 6 - $k$-nearest neighbors Now that you're familiar with sklearn , you're ready to do a KNN regression. Sklearn's regressor is called sklearn.neighbors.KNeighborsRegressor . Its main parameter is the number of nearest neighbors . There are other parameters such as the distance metric (default for 2 order is the Euclidean distance). For a list of all the parameters see the Sklearn kNN Regressor Documentation . Let's use $5$ nearest neighbors. In [ ]: # Import the library from sklearn.neighbors import KNeighborsRegressor In [ ]: # Set number of neighbors k = 5 knnreg = KNeighborsRegressor ( n_neighbors = k ) In [ ]: # Fit the regressor - make sure your numpy arrays are the right shape knnreg . fit ( X_train , y_train ) # Evaluate the outcome on the train set using R&#94;2 r2_train = knnreg . score ( X_train , y_train ) # Print results print ( f 'kNN model with {k} neighbors gives R&#94;2 on the train set: {r2_train:.5} ' ) In [ ]: knnreg . predict ( X_test ) Exercise Calculate and print the $R&#94;{2}$ score on the test set In [ ]: # Your code here Not so good? Lets vary the number of neighbors and see what we get. In [ ]: # Make our lives easy by storing the different regressors in a dictionary regdict = {} # Make our lives easier by entering the k values from a list k_list = [ 1 , 2 , 4 , 15 ] # Do a bunch of KNN regressions for k in k_list : knnreg = KNeighborsRegressor ( n_neighbors = k ) knnreg . fit ( X_train , y_train ) # Store the regressors in a dictionary regdict [ k ] = knnreg # Print the dictionary to see what we have regdict Now let's plot all the k values in same plot. In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( dfcars . wt , dfcars . mpg , 'o' , label = \"data\" ) xgrid = np . linspace ( np . min ( dfcars . wt ), np . max ( dfcars . wt ), 100 ) # let's unpack the dictionary to its elements (items) which is the k and Regressor for k , regressor in regdict . items (): predictions = regressor . predict ( xgrid . reshape ( - 1 , 1 )) ax . plot ( xgrid , predictions , label = \" {} -NN\" . format ( k )) ax . legend (); Exercise Explain what you see in the graph. Hint Notice how the $1$-NN goes through every point on the training set but utterly fails elsewhere. Lets look at the scores on the training set. In [ ]: ks = range ( 1 , 15 ) # Grid of k's scores_train = [] # R2 scores for k in ks : # Create KNN model knnreg = KNeighborsRegressor ( n_neighbors = k ) # Fit the model to training data knnreg . fit ( X_train , y_train ) # Calculate R&#94;2 score score_train = knnreg . score ( X_train , y_train ) scores_train . append ( score_train ) # Plot fig , ax = plt . subplots ( 1 , 1 , figsize = ( 12 , 8 )) ax . plot ( ks , scores_train , 'o-' ) ax . set_xlabel ( r '$k$' ) ax . set_ylabel ( r '$R&#94; {2} $' ) Exercise Why do we get a perfect $R&#94;2$ at k=1 for the training set? Make the same plot as above on the test set. What is the best $k$? In [ ]: # Your code here In [ ]: # %load solutions/knn_regression.py In [ ]: # solution to previous exercise r2_test = knnreg . score ( X_test , y_test ) print ( f 'kNN model with {k} neighbors gives R&#94;2 on the test set: {r2_test:.5} ' ) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab03/notebook/"},{"title":"Advanced Section 1: Linear Algebra and Hypothesis Testing","text":"Slides Advanced Section: Linear Algebra and Hypothesis Testing [pptx] Advanced Section: Linear Algebra and Hypothesis Testing [pdf]","tags":"A-section","url":"a-section/a-section1/"},{"title":"Lecture 5: Linear Regression","text":"Slides Lecture 5: Linear Regression [pptx] Lecture 5: Linear Regression [pdf]","tags":"lectures","url":"lectures/lecture5/"},{"title":"Lecture 4: Introduction to Regression","text":"Slides Lecture4: Introduction to Regression [pptx] Lecture 4: Introduction to Regression [pdf]","tags":"lectures","url":"lectures/lecture4/"},{"title":"S-Section 01: Introduction to Web Scraping","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Standard Section 1: Introduction to Web Scraping Harvard University Fall 2019 Instructors : Pavlos Protopapas, Kevin Rader, and Chris Tanner Section Leaders : Marios Mattheakis, Abhimanyu (Abhi) Vasishth, Robbert (Rob) Struyven In [ ]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) When we're done today, you will approach messy real-world data with confidence that you can get it into a format that you can manipulate. Specifically, our learning objectives are: Understand the structure of an HTML document and use that structure to extract desired information Use Python data structures such as lists, dictionaries, and Pandas DataFrames to store and manipulate information Identify some other (semi-)structured formats commonly used for storing and transferring data, such as JSON and CSV Practice using Python packages such as BeautifulSoup and Pandas , including how to navigate their documentation to find functionality. In [ ]: % matplotlib inline import numpy as np import matplotlib.pyplot as plt import pandas as pd import seaborn as sns sns . set_style ( \"whitegrid\" ) sns . set_context ( \"notebook\" ) import json import requests from bs4 import BeautifulSoup from IPython.display import HTML In [ ]: # Setting up 'requests' to make HTTPS requests properly takes some extra steps... we'll skip them for now. requests . packages . urllib3 . disable_warnings () import warnings warnings . filterwarnings ( \"ignore\" ) Goals Is science becoming more collaborative over time? How about literature? Are there a few \"geniuses\" or lots of hard workers? One way we might answer those questions is by looking at Nobel Prizes. We could ask questions like: Has anyone won a prize more than once? How has the total number of recipients changed over time? How has the number of recipients per award changed over time? To answer these questions, we'll need data: who received what award when . Before we dive into acquiring this data the way we've been teaching in class, let's pause to ask: what are 5 different approaches we could take to acquiring Nobel Prize data ? When possible: find a structured dataset (.csv,.json,.xls) After a google search we stumble upon this dataset on github . It is also in the section folder named github-nobel-prize-winners.csv . We use pandas to read it: In [ ]: df = pd . read_csv ( \"../data/github-nobel-prize-winners.csv\" ) df . head () Or you may want to read an xlsx file: (Potential missing package; you might need to run the following command in your terminal first: !conda install xlrd ) In [ ]: df = pd . read_excel ( \"../data/github-nobel-prize-winners.xlsx\" ) df . head () QUIZ: Did anyone recieve the Nobel Prize more than once? How would you check if anyone recieved more than one nobel prize? In [ ]: # list storing all the names name_winners = [] for name in df . winner : # Check if we already encountered this name: if name in name_winners : # if so, print the name print ( name ) else : # otherwhise the name to the list name_winners . append ( name ) We don't want to print \"No Prize was Awarded\" all the time. In [ ]: # Your code here How can we make this into a oneligner? In [ ]: winners = [] [ print ( name ) if ( name in winners and name != \"No Prize was Awarded\" ) else winners . append ( name ) for name in df . winner ]; Otherwhise: WEB SCRAPING Turns out that https://www.nobelprize.org/prizes/lists/all-nobel-prizes/ has the data we want. Let's take a look at the website and to look at the underhood HTML: right-click and click on inspect . Try to find structure in the tree-structured HTML. But the nobelprize.org server is a little slow sometimes. Fortunately, the Internet Archive periodically crawls most of the Internet and saves what it finds. (That's a lot of data!) So let's grab the data from the Archive's \"Wayback Machine\" (great name!). We'll just give you the direct URL, but at the very end you'll see how we can get it out of a JSON response from the Wayback Machine API. In [ ]: snapshot_url = 'http://web.archive.org/web/20180820111639/https://www.nobelprize.org/prizes/lists/all-nobel-prizes/' In [ ]: snapshot = requests . get ( snapshot_url ) snapshot What is a this Response [200]? Let's google: response 200 meaning . All possible codes here . In [ ]: type ( snapshot ) Try to request \"www.xoogle.be\"? What happens? In [ ]: snapshot_url2 = 'http://web.archive.org/web/20180820111639/https://www.xoogle.be' snapshot = requests . get ( snapshot_url2 ) snapshot Always remember to \"not to be evil\" when scraping with requests! If downloading multiple pages (like you will be on HW1), always put a delay between requests (e.g, time.sleep(1) , with the time library) so you don't unwittingly hammer someone's webserver and/or get blocked. In [ ]: snapshot = requests . get ( snapshot_url ) raw_html = snapshot . text print ( raw_html [: 500 ]) Regular Expressions You can find specific patterns or strings in text by using Regular Expressions: This is a pattern matching mechanism used throughout Computer Science and programming (it's not just specific to Python). Some great resources that we recommend, if you are interested in them (could be very useful for a homework problem): https://docs.python.org/3.3/library/re.html https://regexone.com https://docs.python.org/3/howto/regex.html . Specify a specific sequence with the help of regex special characters. Some examples: \\S : Matches any character which is not a Unicode whitespace character \\d : Matches any Unicode decimal digit * : Causes the resulting RE to match 0 or more repetitions of the preceding RE, as many repetitions as are possible. Let's find all the occurances of 'Marie' in our raw_html: In [ ]: import re In [ ]: re . findall ( r 'Marie' , raw_html ) Using \\S to match 'Marie' + ' ' + 'any character which is not a Unicode whitespace character': In [ ]: re . findall ( r 'Marie \\S' , raw_html ) How would we find their lastnames that comes after Marie? In [ ]: # Your code here Now, we have all our data in the notebook. Unfortunately, it is the form of one really long string, which is hard to work with directly. This is where BeautifulSoup comes in. Parse the HTML with BeautifulSoup In [ ]: soup = BeautifulSoup ( raw_html , 'html.parser' ) Key BeautifulSoup functions we'll be using in this section: tag.prettify() : Returns cleaned-up version of raw HTML, useful for printing tag.select(selector) : Return a list of nodes matching a CSS selector tag.select_one(selector) : Return the first node matching a CSS selector tag.text/soup.get_text() : Returns visible text of a node (e.g.,\" Some text \" -> \"Some text\") tag.contents : A list of the immediate children of this node You can also use these functions to find nodes. tag.find_all(tag_name, attrs=attributes_dict) : Returns a list of matching nodes tag.find(tag_name, attrs=attributes_dict) : Returns first matching node BeautifulSoup is a very powerful library -- much more info here: https://www.crummy.com/software/BeautifulSoup/bs4/doc/ Let's practice some BeautifulSoup commands... Print a cleaned-up version of the raw HTML In [ ]: # Your code here Find the first \"title\" object In [ ]: # Your code here Extract the text of first \"title\" object In [ ]: # Your code here Extracting award data Let's use the structure of the HTML document to extract the data we want. From inspecting the page in DevTools, we found that each award is in a div with a by_year class. Let's get all of them. In [ ]: award_nodes = soup . select ( '.by_year' ) len ( award_nodes ) Let's pull out an example. In [ ]: award_node = award_nodes [ 200 ] In [ ]: HTML ( award_node . prettify ()) Let's practice getting data out of a BS Node The prize title In [ ]: award_node . select_one ( 'h3' ) . text How do we separate the title from the year? In [ ]: # Your code here How do we separate the year from the year? In [ ]: # Your code here Let's put them into functions: In [ ]: def get_award_title ( award_node ): return award_node . select_one ( 'h3' ) . text [: - 4 ] . strip () In [ ]: def get_award_year ( award_node ): return int ( award_node . select_one ( 'h3' ) . text [ - 4 :]) Make a list of titles for all awards In [ ]: list_awards = [] for award_node in award_nodes : list_awards . append ( get_award_title ( award_node )) list_awards Let's use list comprehension: In [ ]: # Your code here The recipients How do we handle there being more than one? In [ ]: [ node . text for node in award_node . select ( 'h6 a' )] We'll leave them as a list for now, to return to this later. The prize \"motivation\" How would you get the 'motivation'/reason of the prize from the following award_node ? In [ ]: award_node = award_nodes [ 200 ] award_node In [ ]: # Your code here Putting everything into functions: In [ ]: def get_award_motivation ( award_node ): award_node = award_node . select_one ( 'p' ) if not award_node : return None return award_node . text #.lstrip('\\u201c').rstrip('\\u201d') In [ ]: def get_recipients ( award_node ): return [ node . text for node in award_node . select ( 'h6 a' )] Let's create a Pandas dataframe Now let's get all of the awards. In [ ]: awards = [] for award_node in soup . select ( '.by_year' ): recipients = get_recipients ( award_node ) award = {} award [ 'title' ] = get_award_title ( award_node ) award [ 'year' ] = get_award_year ( award_node ) award [ 'recipients' ] = recipients award [ 'num_recipients' ] = len ( recipients ) award [ 'motivation' ] = get_award_motivation ( award_node ) awards . append ( award ) In [ ]: df_awards_raw = pd . DataFrame ( awards ) In [ ]: df_awards_raw Some quick EDA. In [ ]: df_awards_raw . info () In [ ]: df_awards_raw . year . min () Hm, that's suspiciously close to a round number. Are we missing some? How about recipients? In [ ]: df_awards_raw . head () In [ ]: df_awards_raw . num_recipients . value_counts () Why do some have no recipients? In [ ]: df_awards_raw [ df_awards_raw . num_recipients == 0 ] Ok: 2018 awards have no recipients because this is a 2018 archived version of nobel prize webpage. Some past years lack awards because there actually were none that year. Let's keep only meaningful data: In [ ]: df_awards_past = df_awards_raw [ df_awards_raw . year != 2018 ] df_awards_past . info () Hm, motivation has a different number of items... why? In [ ]: df_awards_past [ df_awards_past . motivation . isnull ()] Looks like it's fine that those motivations were missing. Sort the awards by year. In [ ]: df_awards_past . sort_values ( 'year' ) . head () How many awards of each type were given? In [ ]: df_awards_past . title . value_counts () But wait, that includes the years the awards weren't offered. In [ ]: df_awards_actually_offered = df_awards_past [ df_awards_past . num_recipients > 0 ] df_awards_actually_offered . title . value_counts () When was each award first given? In [ ]: df_awards_actually_offered . groupby ( 'title' ) . year . describe () How many recipients per year? Let's include the years with missing awards; if we were to analyze further, we'd have to decide whether to include them. In [ ]: df_awards_past . plot . scatter ( x = 'year' , y = 'num_recipients' ); It's hard to see a trend when there are multiple observations per year ( why? ). Let's try looking at total num recipients by year. In [ ]: plt . figure ( figsize = [ 16 , 6 ]) # plt.plot(df_awards_past.groupby('year').num_recipients.sum(), color = 'b', linewidth='2') plt . plot ( df_awards_past . groupby ( 'year' ) . num_recipients . sum (), '-ob' , linewidth = '2' , alpha = 0.75 ) plt . title ( 'Total Nobel Awards per year' ) plt . xlabel ( 'Year' ) plt . ylabel ( 'Number of recipients' ) plt . grid ( 'on' ) plt . show (); Check out the years 1940-43? Any comment? Any trends the last 25 years? In [ ]: plt . figure ( figsize = [ 16 , 6 ]) i = 0 for award in set ( df_awards_past . title ): i += 1 year = df_awards_past [ df_awards_past [ 'title' ] == award ] . year recips = df_awards_past [ df_awards_past [ 'title' ] == award ] . num_recipients index = year > 2019 - 25 years_filtered = year [ index ] . values recips_filtered = recips [ index ] . values plt . subplot ( 2 , 3 , i ) plt . bar ( years_filtered , recips_filtered , color = 'b' , alpha = 0.7 ) plt . title ( award ) plt . xlabel ( 'Year' ) plt . ylabel ( 'Number of Recipients' ) plt . ylim ( 0 , 3 ) plt . tight_layout () End of Standard Section Extra: Did anyone recieve the Nobel Prize more than once (based upon scraped data)? Here's where it bites us that our original DataFrame isn't \"tidy\". Let's make a tidy one. In [ ]: tidy_awards = [] for idx , row in df_awards_past . iterrows (): for recipient in row [ 'recipients' ]: tidy_awards . append ( dict ( recipient = recipient , year = row [ 'year' ])) tidy_awards_df = pd . DataFrame ( tidy_awards ) tidy_awards_df . info () Now we can look at each recipient individually. In [ ]: tidy_awards_df . recipient . value_counts () Extra: Other structured data formats: JSON and CSV CSV CSV is a lowest-common-denominator format for tabular data. In [ ]: df_awards_past . to_csv ( '../data/awards.csv' , index = False ) with open ( '../data/awards.csv' , 'r' ) as f : print ( f . read ()[: 1000 ]) It loses some info, though: the recipients list became a plain string, and the reader needs to guess whether each column is numeric or not. In [ ]: pd . read_csv ( '../data/awards.csv' ) . recipients . iloc [ 20 ] JSON JSON preserves structured data, but fewer data-science tools speak it. In [ ]: df_awards_past . to_json ( '../data/awards.json' , orient = 'records' ) with open ( '../data/awards.json' , 'r' ) as f : print ( f . read ()[: 1000 ]) Lists and other basic data types are preserved. (Custom data types aren't preserved, but you'll get an error when saving.) In [ ]: pd . read_json ( '../data/awards.json' ) . recipients . iloc [ 20 ] Extra: Pickle: handy for storing data For temporary data storage in a single version of Python, pickle s will preserve your data even more faithfully, even many custom data types. But don't count on it for exchanging data or long-term storage. (In fact, don't try to load untrusted pickle s -- they can run arbitrary code!) In [ ]: df_awards_past . to_pickle ( '../data/awards.pkl' ) with open ( '../data/awards.pkl' , 'r' , encoding = 'latin1' ) as f : print ( f . read ()[: 200 ]) Yup, lots of internal Python and Pandas stuff... In [ ]: pd . read_pickle ( '../data/awards.pkl' ) . recipients . iloc [ 20 ] Extra: Formatted data output Let's make a textual table of Physics laureates by year, earliest first: In [ ]: for idx , row in df_awards_past . sort_values ( 'year' ) . iterrows (): if 'Physics' in row [ 'title' ]: print ( ' {} : {} ' . format ( row [ 'year' ], ', ' . join ( row [ 'recipients' ]))) Extra: Parsing JSON to get the Wayback Machine URL We could go to http://archive.org , search for our URL, and get the URL for the archived version there. But since you'll often need to talk with APIs, let's take this opportunity to use the Wayback Machine's API . This will also give us a chance to practice working with JSON. In [ ]: url = \"https://www.nobelprize.org/prizes/lists/all-nobel-prizes/\" # All 3 of these do the same thing. The third is my (KCA's) favorite new feature of Python 3.6. wayback_query_url = 'http://archive.org/wayback/available?url= {} ' . format ( url ) wayback_query_url = 'http://archive.org/wayback/available?url= {url} ' . format ( url = url ) wayback_query_url = f 'http://archive.org/wayback/available?url= {url} ' r = requests . get ( wayback_query_url ) We got some kind of response... what is it? In [ ]: r . text Yay, JSON ! It's usually pretty easy to work with JSON, once we parse it. In [ ]: json . loads ( r . text ) Loading responses as JSON is so common that requests has a convenience method for it: In [ ]: response_json = r . json () response_json What kind of object is this? A little Python syntax review: How can we get the snapshot URL? In [ ]: snapshot_url = response_json [ 'archived_snapshots' ][ 'closest' ][ 'url' ] snapshot_url if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/sec_1/notebook/"},{"title":"S-Section 01: Introduction to Web Scraping","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"sections","url":"sections/sec_1/notebook-sol/"},{"title":"S-Section 01: Introduction to Web Scraping","text":"Jupyter Notebooks S-Section 1: Introduction to Web Scraping","tags":"sections","url":"sections/section1/"},{"title":"Lab 2:","text":"Jupyter Notebooks Lab 2: Web Scraping with Beautiful Soup Lab 2: More Pandas (extra practice)","tags":"labs","url":"labs/lab02/"},{"title":"Lab 02: More Pandas","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lab 2: Pandas and Web Scraping with Beautiful Soup Harvard University Fall 2019 Instructors: Pavlos Protopapas, Kevin Rader, and Chris Tanner Lab Instructors: Chris Tanner and Eleni Kaxiras Authors: Rahul Dave, David Sondak, Will Claybaugh, Pavlos Protopapas, Chris Tanner, Eleni Kaxiras In [1]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING from IPython.core.display import HTML def css_styling (): styles = open ( \"../../styles/cs109.css\" , \"r\" ) . read () return HTML ( styles ) css_styling () Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } Table of Contents Learning Goals Loading and Cleaning with Pandas Parsing and Completing the Dataframe Grouping Learning Goals About 6,000 odd \"best books\" were fetched and parsed from Goodreads . The \"bestness\" of these books came from a proprietary formula used by Goodreads and published as a list on their web site. We parsed the page for each book and saved data from all these pages in a tabular format as a CSV file. In this lab we'll clean and further parse the data. We'll then do some exploratory data analysis to answer questions about these best books and popular genres. By the end of this lab, you should be able to: Load and systematically address missing values, ancoded as NaN values in our data set, for example, by removing observations associated with these values. Parse columns in the dataframe to create new dataframe columns. Use groupby to aggregate data on a particular feature column, such as author. This lab corresponds to lectures #1, #2, and #3 and maps on to homework #1 and further. Basic EDA workflow (From the lecture, repeated here for convenience). The basic workflow is as follows: Build a DataFrame from the data (ideally, put all data in this object) Clean the DataFrame. It should have the following properties: Each row describes a single object Each column describes a property of that object Columns are numeric whenever appropriate Columns contain atomic properties that cannot be further decomposed Explore global properties . Use histograms, scatter plots, and aggregation functions to summarize the data. Explore group properties . Use groupby and small multiples to compare subsets of the data. This process transforms your data into a format which is easier to work with, gives you a basic overview of the data's properties, and likely generates several questions for you to followup in subsequent analysis. Part 1: Loading and Cleaning with Pandas Read in the goodreads.csv file, examine the data, and do any necessary data cleaning. Here is a description of the columns (in order) present in this csv file: rating: the average rating on a 1-5 scale achieved by the book review_count: the number of Goodreads users who reviewed this book isbn: the ISBN code for the book booktype: an internal Goodreads identifier for the book author_url: the Goodreads (relative) URL for the author of the book year: the year the book was published genre_urls: a string with '|' separated relative URLS of Goodreads genre pages dir: a directory identifier internal to the scraping code rating_count: the number of ratings for this book (this is different from the number of reviews) name: the name of the book Let us see what issues we find with the data and resolve them. After loading appropriate libraries In [2]: % matplotlib inline import numpy as np import matplotlib.pyplot as plt import pandas as pd import seaborn as sns pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) Cleaning: Reading in the data We read in and clean the data from goodreads.csv . In [3]: #Read the data into a dataframe df = pd . read_csv ( \"data/goodreads.csv\" , encoding = 'utf-8' ) #Examine the first few rows of the dataframe df Out[3]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } 4.40 136455 0439023483 good_reads:book https://www.goodreads.com/author/show/153394.Suzanne_Collins 2008 /genres/young-adult|/genres/science-fiction|/genres/dystopia|/genres/fantasy|/genres/science-fiction|/genres/romance|/genres/adventure|/genres/book-club|/genres/young-adult|/genres/teen|/genres/apocalyptic|/genres/post-apocalyptic|/genres/action dir01/2767052-the-hunger-games.html 2958974 The Hunger Games (The Hunger Games, #1) 0 4.41 16648 0439358078 good_reads:book https://www.goodreads.com/author/show/1077326.... 2003.0 /genres/fantasy|/genres/young-adult|/genres/fi... dir01/2.Harry_Potter_and_the_Order_of_the_Phoe... 1284478 Harry Potter and the Order of the Phoenix (Har... 1 3.56 85746 0316015849 good_reads:book https://www.goodreads.com/author/show/941441.S... 2005.0 /genres/young-adult|/genres/fantasy|/genres/ro... dir01/41865.Twilight.html 2579564 Twilight (Twilight, #1) 2 4.23 47906 0061120081 good_reads:book https://www.goodreads.com/author/show/1825.Har... 1960.0 /genres/classics|/genres/fiction|/genres/histo... dir01/2657.To_Kill_a_Mockingbird.html 2078123 To Kill a Mockingbird 3 4.23 34772 0679783261 good_reads:book https://www.goodreads.com/author/show/1265.Jan... 1813.0 /genres/classics|/genres/fiction|/genres/roman... dir01/1885.Pride_and_Prejudice.html 1388992 Pride and Prejudice 4 4.25 12363 0446675539 good_reads:book https://www.goodreads.com/author/show/11081.Ma... 1936.0 /genres/classics|/genres/historical-fiction|/g... dir01/18405.Gone_with_the_Wind.html 645470 Gone with the Wind 5 4.22 7205 0066238501 good_reads:book https://www.goodreads.com/author/show/1069006.... 1949.0 /genres/classics|/genres/young-adult|/genres/c... dir01/11127.The_Chronicles_of_Narnia.html 286677 The Chronicles of Narnia (Chronicles of Narnia... 6 4.38 10902 0060256656 good_reads:book https://www.goodreads.com/author/show/435477.S... 1964.0 /genres/childrens|/genres/young-adult|/genres/... dir01/370493.The_Giving_Tree.html 502891 The Giving Tree 7 3.79 20670 0452284244 good_reads:book https://www.goodreads.com/author/show/3706.Geo... 1945.0 /genres/classics|/genres/fiction|/genres/scien... dir01/7613.Animal_Farm.html 1364879 Animal Farm 8 4.18 12302 0345391802 good_reads:book https://www.goodreads.com/author/show/4.Dougla... 1979.0 /genres/science-fiction|/genres/humor|/genres/... dir01/11.The_Hitchhiker_s_Guide_to_the_Galaxy.... 724713 The Hitchhiker's Guide to the Galaxy (Hitchhik... 9 4.03 20937 0739326228 good_reads:book https://www.goodreads.com/author/show/614.Arth... 1997.0 /genres/fiction|/genres/historical-fiction|/ge... dir01/930.Memoirs_of_a_Geisha.html 1042679 Memoirs of a Geisha 10 3.72 34959 0307277674 good_reads:book https://www.goodreads.com/author/show/630.Dan_... 2003.0 /genres/mystery|/genres/thriller|/genres/suspe... dir01/968.The_Da_Vinci_Code.html 1220657 The Da Vinci Code (Robert Langdon, #2) 11 4.36 69524 0375831002 good_reads:book https://www.goodreads.com/author/show/11466.Ma... 2005.0 /genres/historical-fiction|/genres/young-adult... dir01/19063.The_Book_Thief.html 675431 The Book Thief 12 4.05 5516 0451527747 good_reads:book https://www.goodreads.com/author/show/8164.Lew... 1865.0 /genres/classics|/genres/childrens|/genres/you... dir01/24213.Alice_s_Adventures_in_Wonderland_T... 301702 Alice's Adventures in Wonderland & Through the... 13 3.72 10156 0743477111 good_reads:book https://www.goodreads.com/author/show/947.Will... 1597.0 /genres/classics|/genres/plays|/genres/fiction... dir01/18135.Romeo_and_Juliet.html 1211146 Romeo and Juliet 14 4.09 10082 0451525264 good_reads:book https://www.goodreads.com/author/show/13661.Vi... 1862.0 /genres/classics|/genres/historical-fiction|/g... dir01/24280.Les_Mis_rables.html 418004 Les MisÃ©rables 15 3.92 38061 NaN good_reads:book https://www.goodreads.com/author/show/498072.A... 2003.0 /genres/fiction|/genres/romance|/genres/fantas... dir01/18619684-the-time-traveler-s-wife.html 927254 The Time Traveler's Wife 16 4.58 1314 0345538374 good_reads:book https://www.goodreads.com/author/show/656983.J... 1973.0 /genres/fantasy|/genres/classics|/genres/scien... dir01/30.J_R_R_Tolkien_4_Book_Boxed_Set.html 68495 J.R.R. Tolkien 4-Book Boxed Set 17 3.60 18039 0140283331 good_reads:book https://www.goodreads.com/author/show/306.Will... 1954.0 /genres/classics|/genres/academic|/genres/scho... dir01/7624.Lord_of_the_Flies.html 1232126 Lord of the Flies 18 4.28 30815 0812550706 good_reads:book https://www.goodreads.com/author/show/589.Orso... 1985.0 /genres/science-fiction|/genres/young-adult|/g... dir01/375802.Ender_s_Game.html 624730 Ender's Game (The Ender Quintet, #1) 19 4.02 11942 0375751513 good_reads:book https://www.goodreads.com/author/show/3565.Osc... 1890.0 /genres/classics|/genres/fiction|/genres/horro... dir01/5297.The_Picture_of_Dorian_Gray.html 409478 The Picture of Dorian Gray 20 4.14 8681 0143058142 good_reads:book https://www.goodreads.com/author/show/3137322.... 1866.0 /genres/classics|/genres/cultural|/genres/russ... dir01/7144.Crime_and_Punishment.html 294297 Crime and Punishment 21 4.11 8897 0064410935 good_reads:book https://www.goodreads.com/author/show/988142.E... 1952.0 /genres/childrens|/genres/fiction|/genres/clas... dir01/24178.Charlotte_s_Web.html 662707 Charlotte's Web 22 4.20 8678 0451528824 good_reads:book https://www.goodreads.com/author/show/5350.L_M... 1908.0 /genres/fiction|/genres/young-adult|/genres/cl... dir01/8127.Anne_of_Green_Gables.html 393594 Anne of Green Gables (Anne of Green Gables, #1) 23 3.75 36955 0061122416 good_reads:book https://www.goodreads.com/author/show/566.Paul... 1988.0 /genres/fiction|/genres/classics|/genres/fanta... dir01/865.The_Alchemist.html 876518 The Alchemist 24 3.94 18581 0007491565 good_reads:book https://www.goodreads.com/author/show/1630.Ray... 1953.0 /genres/classics|/genres/fiction|/genres/scien... dir01/17470674-fahrenheit-451.html 783133 Fahrenheit 451 25 4.43 112279 0525478817 good_reads:book https://www.goodreads.com/author/show/1406384.... 2012.0 /genres/young-adult|/genres/book-club|/genres/... dir01/11870085-the-fault-in-our-stars.html 1150626 The Fault in Our Stars 26 3.79 15833 0142000671 good_reads:book https://www.goodreads.com/author/show/585.John... 1937.0 /genres/fiction|/genres/classics|/genres/acade... dir01/890.Of_Mice_and_Men.html 1070755 Of Mice and Men 27 4.04 13214 0440498058 good_reads:book https://www.goodreads.com/author/show/106.Made... 1962.0 /genres/fantasy|/genres/young-adult|/genres/cl... dir01/18131.A_Wrinkle_in_Time.html 420001 A Wrinkle in Time (A Wrinkle in Time Quintet, #1) 28 3.94 11736 0393970124 good_reads:book https://www.goodreads.com/author/show/6988.Bra... 1897.0 /genres/classics|/genres/horror|/genres/fictio... dir01/17245.Dracula.html 429079 Dracula 29 4.24 10614 0345418263 good_reads:book https://www.goodreads.com/author/show/12521.Wi... 1973.0 /genres/fantasy|/genres/classics|/genres/roman... dir01/21787.The_Princess_Bride.html 457219 The Princess Bride ... ... ... ... ... ... ... ... ... ... ... 5969 3.97 182 0399151311 good_reads:book https://www.goodreads.com/author/show/33987.La... 1985.0 /genres/romance|/genres/romance|/genres/contem... dir60/572626.Separate_Beds.html 3544 Separate Beds 5970 4.24 72 0413748308 good_reads:book https://www.goodreads.com/author/show/29185.Sa... 2000.0 /genres/plays|/genres/drama|/genres/plays|/gen... dir60/146548.4_48_Psychosis.html 1016 4.48 Psychosis 5971 4.19 1670 NaN good_reads:book https://www.goodreads.com/author/show/4586597.... 2011.0 /genres/romance|/genres/romance|/genres/contem... dir60/12351649-perfection.html 35197 Perfection (Neighbor from Hell, #2) 5972 4.17 789 1401324290 good_reads:book https://www.goodreads.com/author/show/4627059.... 2011.0 /genres/biography|/genres/animals|/genres/auto... dir60/10393675-until-tuesday.html 4685 Until Tuesday 5973 3.99 2944 0425267040 good_reads:book https://www.goodreads.com/author/show/24978.Ma... 2013.0 /genres/romance|/genres/adult-fiction|/genres/... dir60/16033902-rush.html 41287 Rush (Breathless, #1) 5974 4.07 10585 0061950726 good_reads:book https://www.goodreads.com/author/show/157146.C... 2013.0 /genres/historical-fiction|/genres/book-club|/... dir60/15818107-orphan-train.html 76606 Orphan Train 5975 4.23 1185 NaN good_reads:book https://www.goodreads.com/author/show/5160667.... 2014.0 /genres/romance|/genres/science-fiction|/genre... dir60/20504754-transcendence.html 4942 Transcendence 5976 4.03 218 NaN good_reads:book https://www.goodreads.com/author/show/5769580.... 1987.0 /genres/fiction|/genres/novels|/genres/literat... dir60/5948927.html 1607 Ø§ÙØªÙÙ 5977 3.99 27 1853408360 good_reads:book https://www.goodreads.com/author/show/851161.K... 2005.0 /genres/young-adult|/genres/romance|/genres/co... dir60/2274992.Tessa_in_Love.html 294 Tessa in Love 5978 2.77 800 0060988649 good_reads:book https://www.goodreads.com/author/show/7025.Gre... 2001.0 /genres/fantasy|/genres/fiction|/genres/myster... dir60/24929.Lost.html 11128 Lost 5979 3.84 165 0571207995 good_reads:book https://www.goodreads.com/author/show/16865.Ti... 1977.0 /genres/fiction|/genres/cultural|/genres/canad... dir60/29898.The_Wars.html 4160 The Wars 5980 3.36 1693 0312424442 good_reads:book https://www.goodreads.com/author/show/3083854.... 2003.0 /genres/fiction|/genres/novels|/genres/contemp... dir60/231.I_am_Charlotte_Simmons.html 17743 I am Charlotte Simmons 5981 4.09 362 1407103946 good_reads:book https://www.goodreads.com/author/show/81096.Ch... 2009.0 /genres/fantasy|/genres/horror|/genres/young-a... dir60/6364017-malice.html 2013 Malice (Malice, #1) 5982 4.23 137 1582430438 good_reads:book https://www.goodreads.com/author/show/8567.Wen... 1974.0 /genres/fiction|/genres/novels|/genres/literat... dir60/227274.The_Memory_of_Old_Jack.html 1085 The Memory of Old Jack 5983 4.02 531 0575085150 good_reads:book https://www.goodreads.com/author/show/81096.Ch... 2009.0 /genres/science-fiction|/genres/steampunk|/gen... dir60/6285903-retribution-falls.html 3878 Retribution Falls (Tales of the Ketty Jay, #1) 5984 3.61 109 1401360106 good_reads:book https://www.goodreads.com/author/show/183537.K... 2005.0 /genres/fiction|/genres/young-adult|/genres/bo... dir60/319403.Pigtopia.html 529 Pigtopia 5985 4.06 954 1606840584 good_reads:book https://www.goodreads.com/author/show/2891503.... 2010.0 /genres/young-adult|/genres/fantasy|/genres/pa... dir60/7831742-the-lost-saint.html 12690 The Lost Saint (The Dark Divine, #2) 5986 4.26 477 0517548233 good_reads:book https://www.goodreads.com/author/show/2062.Hen... 1946.0 /genres/economics|/genres/non-fiction|/genres/... dir60/3028.Economics_in_One_Lesson.html 5767 Economics in One Lesson 5987 4.34 93 0575070706 good_reads:book https://www.goodreads.com/author/show/58.Frank... 1977.0 /genres/science-fiction|/genres/fantasy|/genre... dir60/53764.The_Great_Dune_Trilogy.html 41378 The Great Dune Trilogy 5988 3.36 192 842534607X good_reads:book https://www.goodreads.com/author/show/3493970.... 2011.0 /genres/european-literature|/genres/spanish-li... dir60/10832326-si-t-me-dices-ven-lo-dejo-todo-... 1914 Si tÃº me dices ven lo dejo todo... pero dime ven 5989 4.12 1150 0140143459 good_reads:book https://www.goodreads.com/author/show/776.Mich... 1989.0 /genres/non-fiction|/genres/economics|/genres/... dir60/1171.Liar_s_Poker.html 32637 Liar's Poker 5990 4.20 650 NaN good_reads:book https://www.goodreads.com/author/show/1112683._ 2009.0 /genres/novels|/genres/fiction|/genres/religio... dir60/6976667.html 2899 Ø£ÙÙØ§Ø­ ÙØ¯Ø³Ø± 5991 3.89 132 1400303400 good_reads:book https://www.goodreads.com/author/show/5544.Fra... 2002.0 /genres/christian-fiction|/genres/christian|/g... dir60/65686.Nightmare_Academy.html 3531 Nightmare Academy (Veritas Project, #2) 5992 4.09 1256 0345515501 good_reads:book https://www.goodreads.com/author/show/18149.Te... 2011.0 /genres/mystery|/genres/mystery|/genres/crime|... dir60/9578677-the-silent-girl.html 16312 The Silent Girl (Rizzoli & Isles, #9) 5993 4.37 28 0393062260 good_reads:book https://www.goodreads.com/author/show/62157.Ro... 2007.0 /genres/poetry|/genres/religion|/genres/christ... dir60/1251125.The_Book_of_Psalms.html 242 The Book of Psalms 5994 4.17 2226 0767913736 good_reads:book https://www.goodreads.com/author/show/44565.Ca... 2005.0 /genres/history|/genres/non-fiction|/genres/bi... dir60/78508.The_River_of_Doubt.html 16618 The River of Doubt 5995 3.99 775 1416909427 good_reads:book https://www.goodreads.com/author/show/151371.J... 2006.0 /genres/young-adult|/genres/realistic-fiction|... dir60/259068.Shug.html 6179 Shug 5996 3.78 540 1620612321 good_reads:book https://www.goodreads.com/author/show/5761314.... 2012.0 /genres/contemporary|/genres/romance|/genres/y... dir60/13503247-flawed.html 2971 Flawed 5997 3.91 281 NaN good_reads:book https://www.goodreads.com/author/show/1201952.... 2006.0 /genres/religion|/genres/islam|/genres/religio... dir60/2750008.html 3083 Ø£Ø³Ø¹Ø¯ Ø§Ù Ø±Ø£Ø© ÙÙ Ø§ÙØ¹Ø§ÙÙ 5998 4.35 61 0786929081 good_reads:book https://www.goodreads.com/author/show/1023510.... 2001.0 /genres/fiction|/genres/fantasy|/genres/magic|... dir60/66677.Legacy_of_the_Drow_Collector_s_Edi... 3982 Legacy of the Drow Collector's Edition (Legacy... 5999 rows × 10 columns Oh dear. That does not quite seem to be right. We are missing the column names. We need to add these in! But what are they? Here is a list of them in order: [\"rating\", 'review_count', 'isbn', 'booktype','author_url', 'year', 'genre_urls', 'dir','rating_count', 'name'] Exercise Use these to load the dataframe properly! And then \"head\" the dataframe... (you will need to look at the read_csv docs) In [4]: # your code here df = pd . read_csv ( \"data/goodreads.csv\" , header = None , names = [ \"rating\" , 'review_count' , 'isbn' , 'booktype' , 'author_url' , 'year' , 'genre_urls' , 'dir' , 'rating_count' , 'name' ], ) #Examine the first few rows of the dataframe df . head () Out[4]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } rating review_count isbn booktype author_url year genre_urls dir rating_count name 0 4.40 136455 0439023483 good_reads:book https://www.goodreads.com/author/show/153394.S... 2008.0 /genres/young-adult|/genres/science-fiction|/g... dir01/2767052-the-hunger-games.html 2958974 The Hunger Games (The Hunger Games, #1) 1 4.41 16648 0439358078 good_reads:book https://www.goodreads.com/author/show/1077326.... 2003.0 /genres/fantasy|/genres/young-adult|/genres/fi... dir01/2.Harry_Potter_and_the_Order_of_the_Phoe... 1284478 Harry Potter and the Order of the Phoenix (Har... 2 3.56 85746 0316015849 good_reads:book https://www.goodreads.com/author/show/941441.S... 2005.0 /genres/young-adult|/genres/fantasy|/genres/ro... dir01/41865.Twilight.html 2579564 Twilight (Twilight, #1) 3 4.23 47906 0061120081 good_reads:book https://www.goodreads.com/author/show/1825.Har... 1960.0 /genres/classics|/genres/fiction|/genres/histo... dir01/2657.To_Kill_a_Mockingbird.html 2078123 To Kill a Mockingbird 4 4.23 34772 0679783261 good_reads:book https://www.goodreads.com/author/show/1265.Jan... 1813.0 /genres/classics|/genres/fiction|/genres/roman... dir01/1885.Pride_and_Prejudice.html 1388992 Pride and Prejudice Cleaning: Examing the dataframe - quick checks We should examine the dataframe to get a overall sense of the content. Exercise Lets check the types of the columns. What do you find? In [5]: # your code here ####### df . dtypes ####### Out[5]: rating float64 review_count object isbn object booktype object author_url object year float64 genre_urls object dir object rating_count object name object dtype: object your answer here Notice that review_count and rating_counts are objects instead of ints, and the year is a float! There are a couple more quick sanity checks to perform on the dataframe. In [6]: print ( df . shape ) df . columns (6000, 10) Out[6]: Index(['rating', 'review_count', 'isbn', 'booktype', 'author_url', 'year', 'genre_urls', 'dir', 'rating_count', 'name'], dtype='object') Cleaning: Examining the dataframe - a deeper look Beyond performing checking some quick general properties of the data frame and looking at the first $n$ rows, we can dig a bit deeper into the values being stored. If you haven't already, check to see if there are any missing values in the data frame. Let's see for a column which seemed OK to us. In [7]: #Get a sense of how many missing values there are in the dataframe. print ( np . sum ([ df . rating . isnull ()])) print ( np . sum ([ df . review_count . isnull ()])) print ( np . sum ([ df . isbn . isnull ()])) print ( np . sum ([ df . booktype . isnull ()])) print ( np . sum ([ df . author_url . isnull ()])) print ( np . sum ([ df . year . isnull ()])) print ( np . sum ([ df . genre_urls . isnull ()])) print ( np . sum ([ df . dir . isnull ()])) print ( np . sum ([ df . rating_count . isnull ()])) print ( np . sum ([ df . name . isnull ()])) 2 0 475 0 0 7 62 0 0 0 In [8]: #Try to locate where the missing values occur df [ df . rating . isnull ()] Out[8]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } rating review_count isbn booktype author_url year genre_urls dir rating_count name 3643 NaN None None None None NaN NaN dir37/9658936-harry-potter.html None None 5282 NaN None None None None NaN NaN dir53/113138.The_Winner.html None None How does pandas or numpy handle missing values when we try to compute with data sets that include them? We'll now check if any of the other suspicious columns have missing values. Let's look at year and review_count first. One thing you can do is to try and convert to the type you expect the column to be. If something goes wrong, it likely means your data are bad. Lets test for missing data: In [9]: df [ df . year . isnull ()] df . year . isnull () df . shape Out[9]: (6000, 10) Cleaning: Dealing with Missing Values How should we interpret 'missing' or 'invalid' values in the data (hint: look at where these values occur)? One approach is to simply exclude them from the dataframe. Is this appropriate for all 'missing' or 'invalid' values? In [10]: #Treat the missing or invalid values in your dataframe ####### df = df [ df . year . notnull ()] Ok so we have done some cleaning. What do things look like now? Notice the float has not yet changed. In [11]: df . dtypes Out[11]: rating float64 review_count object isbn object booktype object author_url object year float64 genre_urls object dir object rating_count object name object dtype: object In [12]: print ( np . sum ( df . year . isnull ())) df . shape # We removed seven rows 0 Out[12]: (5993, 10) Exercise Ok so lets fix those types. Convert them to ints. If the type conversion fails, we now know we have further problems. In [13]: # your code here df . rating_count = df . rating_count . astype ( int ) df . review_count = df . review_count . astype ( int ) df . year = df . year . astype ( int ) Once you do this, we seem to be good on these columns (no errors in conversion). Lets look: In [14]: df . dtypes Out[14]: rating float64 review_count int64 isbn object booktype object author_url object year int64 genre_urls object dir object rating_count int64 name object dtype: object Sweet! Some of the other colums that should be strings have NaN. In [15]: df . loc [ df . genre_urls . isnull (), 'genre_urls' ] = \"\" df . loc [ df . isbn . isnull (), 'isbn' ] = \"\" Part 2: Parsing and Completing the Data Frame We will parse the author column from the author_url and genres column from the genre_urls. Keep the genres column as a string separated by '|'. We will use panda's map to assign new columns to the dataframe. Examine an example author_url and reason about which sequence of string operations must be performed in order to isolate the author's name. In [16]: #Get the first author_url test_string = df . author_url [ 0 ] test_string Out[16]: 'https://www.goodreads.com/author/show/153394.Suzanne_Collins' In [17]: #Test out some string operations to isolate the author name test_string . split ( '/' )[ - 1 ] . split ( '.' )[ 1 :][ 0 ] Out[17]: 'Suzanne_Collins' Exercise Lets wrap the above code into a function which we will then use In [18]: # Write a function that accepts an author url and returns the author's name based on your experimentation above def get_author ( url ): # your code here name = url . split ( '/' )[ - 1 ] . split ( '.' )[ 1 :][ 0 ] ####### return name In [19]: #Apply the get_author function to the 'author_url' column using '.map' #and add a new column 'author' to store the names df [ 'author' ] = df . author_url . map ( get_author ) df . author [ 0 : 5 ] Out[19]: 0 Suzanne_Collins 1 J_K_Rowling 2 Stephenie_Meyer 3 Harper_Lee 4 Jane_Austen Name: author, dtype: object Exercise Now parse out the genres from genre_url . This is a little more complicated because there be more than one genre. In [20]: df . genre_urls . head () Out[20]: 0 /genres/young-adult|/genres/science-fiction|/g... 1 /genres/fantasy|/genres/young-adult|/genres/fi... 2 /genres/young-adult|/genres/fantasy|/genres/ro... 3 /genres/classics|/genres/fiction|/genres/histo... 4 /genres/classics|/genres/fiction|/genres/roman... Name: genre_urls, dtype: object In [21]: # your code here #Examine some examples of genre_urls #Test out some string operations to isolate the genre name test_genre_string = df . genre_urls [ 0 ] genres = test_genre_string . strip () . split ( '|' ) for e in genres : print ( e . split ( '/' )[ - 1 ]) \"|\" . join ( genres ) young-adult science-fiction dystopia fantasy science-fiction romance adventure book-club young-adult teen apocalyptic post-apocalyptic action Exercise Write a function that accepts a genre url and returns the genre name based on your experimentation above In [22]: def split_and_join_genres ( url ): # your code here genres = url . strip () . split ( '|' ) genres = [ e . split ( '/' )[ - 1 ] for e in genres ] return \"|\" . join ( genres ) Test your function In [23]: split_and_join_genres ( \"/genres/young-adult|/genres/science-fiction\" ) Out[23]: 'young-adult|science-fiction' In [24]: split_and_join_genres ( \"\" ) Out[24]: '' Exercise Use map again to create a new \"genres\" column In [25]: df [ 'genres' ] = df . genre_urls . map ( split_and_join_genres ) df . head () Out[25]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } rating review_count isbn booktype author_url year genre_urls dir rating_count name author genres 0 4.40 136455 0439023483 good_reads:book https://www.goodreads.com/author/show/153394.S... 2008 /genres/young-adult|/genres/science-fiction|/g... dir01/2767052-the-hunger-games.html 2958974 The Hunger Games (The Hunger Games, #1) Suzanne_Collins young-adult|science-fiction|dystopia|fantasy|s... 1 4.41 16648 0439358078 good_reads:book https://www.goodreads.com/author/show/1077326.... 2003 /genres/fantasy|/genres/young-adult|/genres/fi... dir01/2.Harry_Potter_and_the_Order_of_the_Phoe... 1284478 Harry Potter and the Order of the Phoenix (Har... J_K_Rowling fantasy|young-adult|fiction|fantasy|magic|chil... 2 3.56 85746 0316015849 good_reads:book https://www.goodreads.com/author/show/941441.S... 2005 /genres/young-adult|/genres/fantasy|/genres/ro... dir01/41865.Twilight.html 2579564 Twilight (Twilight, #1) Stephenie_Meyer young-adult|fantasy|romance|paranormal|vampire... 3 4.23 47906 0061120081 good_reads:book https://www.goodreads.com/author/show/1825.Har... 1960 /genres/classics|/genres/fiction|/genres/histo... dir01/2657.To_Kill_a_Mockingbird.html 2078123 To Kill a Mockingbird Harper_Lee classics|fiction|historical-fiction|academic|s... 4 4.23 34772 0679783261 good_reads:book https://www.goodreads.com/author/show/1265.Jan... 1813 /genres/classics|/genres/fiction|/genres/roman... dir01/1885.Pride_and_Prejudice.html 1388992 Pride and Prejudice Jane_Austen classics|fiction|romance|historical-fiction|li... Finally, let's pick an author at random so we can see the results of the transformations. Scroll to see the author and genre columns that we added to the dataframe. In [26]: df [ df . author == \"Marguerite_Yourcenar\" ] Out[26]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } rating review_count isbn booktype author_url year genre_urls dir rating_count name author genres 1014 4.23 483 0374529264 good_reads:book https://www.goodreads.com/author/show/7732.Mar... 1951 /genres/historical-fiction|/genres/fiction|/ge... dir11/12172.Memoirs_of_Hadrian.html 6258 Memoirs of Hadrian Marguerite_Yourcenar historical-fiction|fiction|cultural|france|cla... 5620 4.11 74 2070367983 good_reads:book https://www.goodreads.com/author/show/7732.Mar... 1968 /genres/fiction|/genres/historical-fiction|/ge... dir57/953435.L_uvre_au_noir.html 1601 L'Åuvre au noir Marguerite_Yourcenar fiction|historical-fiction|cultural|france|eur... Let us delete the genre_urls column. In [28]: del df [ 'genre_urls' ] And then save the dataframe out! In [29]: df . to_csv ( \"data/cleaned-goodreads.csv\" , index = False , header = True ) Part 3: Grouping It appears that some books were written in negative years! Print out the observations that correspond to negative years. What do you notice about these books? In [30]: # your code here df [ df . year < 0 ] . name #These are books written before the Common Era (BCE, equivalent to BC). Out[30]: 47 The Odyssey 246 The Iliad/The Odyssey 455 The Republic 596 The Aeneid 629 Oedipus Rex 674 The Art of War 746 The Bhagavad Gita 777 Antigone 1233 The Oedipus Cycle 1397 Aesop's Fables 1398 The Epic of Gilgamesh 1428 Medea 1815 The Oresteia 1882 The Trial and Death of Socrates 2078 The History of the Peloponnesian War 2527 The Histories 3133 Complete Works 3274 The Nicomachean Ethics 3757 Lysistrata 4402 The Symposium 4475 Apology 5367 Five Dialogues Name: name, dtype: object We can determine the \"best book\" by year! For this we use Panda's groupby() . Groupby() allows grouping a dataframe by any (usually categorical) variable. Would it make sense to ever groupby integer variables? Floating point variables? In [31]: dfgb_author = df . groupby ( 'author' ) type ( dfgb_author ) Out[31]: pandas.core.groupby.generic.DataFrameGroupBy Perhaps we want the number of books each author wrote In [32]: dfgb_author . count () Out[32]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } rating review_count isbn booktype author_url year dir rating_count name genres author A_A_Milne 6 6 6 6 6 6 6 6 6 6 A_G_Howard 1 1 1 1 1 1 1 1 1 1 A_J_Cronin 1 1 1 1 1 1 1 1 1 1 A_J_Jacobs 1 1 1 1 1 1 1 1 1 1 A_J_Salt 1 1 1 1 1 1 1 1 1 1 A_Meredith_Walters 2 2 2 2 2 2 2 2 2 2 A_N_Roquelaure 2 2 2 2 2 2 2 2 2 2 A_S_Byatt 1 1 1 1 1 1 1 1 1 1 A_S_King 1 1 1 1 1 1 1 1 1 1 A_id_al_Qarni 2 2 2 2 2 2 2 2 2 2 Abbi_Glines 14 14 14 14 14 14 14 14 14 14 Abdul_Rahman_Munif 1 1 1 1 1 1 1 1 1 1 Abigail_Gibbs 1 1 1 1 1 1 1 1 1 1 Abigail_Roux 4 4 4 4 4 4 4 4 4 4 Abigail_Thomas 1 1 1 1 1 1 1 1 1 1 Abolqasem_Ferdowsi 1 1 1 1 1 1 1 1 1 1 Abraham_Verghese 1 1 1 1 1 1 1 1 1 1 Abul_Hasan_Ali_Nadwi 1 1 1 1 1 1 1 1 1 1 Adam_Hochschild 1 1 1 1 1 1 1 1 1 1 Adam_Johnson 1 1 1 1 1 1 1 1 1 1 Adam_Levin 1 1 1 1 1 1 1 1 1 1 Adam_Rex 1 1 1 1 1 1 1 1 1 1 Adam_Smith 1 1 1 1 1 1 1 1 1 1 Addison_Moore 1 1 1 1 1 1 1 1 1 1 Adeline_Yen_Mah 1 1 1 1 1 1 1 1 1 1 Adolf_Hitler 1 1 1 1 1 1 1 1 1 1 Adolfo_Bioy_Casares 1 1 1 1 1 1 1 1 1 1 Aeschylus 1 1 1 1 1 1 1 1 1 1 Aesop 1 1 1 1 1 1 1 1 1 1 Agatha_Christie 11 11 11 11 11 11 11 11 11 11 ... ... ... ... ... ... ... ... ... ... ... William_Strunk_Jr_ 1 1 1 1 1 1 1 1 1 1 William_Styron 3 3 3 3 3 3 3 3 3 3 William_Wharton 2 2 2 2 2 2 2 2 2 2 William_Wordsworth 1 1 1 1 1 1 1 1 1 1 Willow_Aster 1 1 1 1 1 1 1 1 1 1 Wilson_Rawls 2 2 2 2 2 2 2 2 2 2 Winston_Groom 1 1 1 1 1 1 1 1 1 1 Witold_Gombrowicz 2 2 2 2 2 2 2 2 2 2 Wm_Paul_Young 1 1 1 1 1 1 1 1 1 1 Woody_Allen 1 1 1 1 1 1 1 1 1 1 Wu_Cheng_en 1 1 1 1 1 1 1 1 1 1 Yamamoto_Tsunetomo 1 1 1 1 1 1 1 1 1 1 Yana_Toboso 1 1 1 1 1 1 1 1 1 1 Yann_Martel 2 2 2 2 2 2 2 2 2 2 Yasunari_Kawabata 1 1 1 1 1 1 1 1 1 1 Yevgeny_Zamyatin 1 1 1 1 1 1 1 1 1 1 Young_Kim 1 1 1 1 1 1 1 1 1 1 Yuehai_Xiao 1 1 1 1 1 1 1 1 1 1 Yukio_Mishima 2 2 2 2 2 2 2 2 2 2 Yukito_Kishiro 1 1 1 1 1 1 1 1 1 1 Yvonne_Woon 1 1 1 1 1 1 1 1 1 1 Zack_Love 1 1 1 1 1 1 1 1 1 1 Zadie_Smith 2 2 2 2 2 2 2 2 2 2 Zilpha_Keatley_Snyder 1 1 1 1 1 1 1 1 1 1 Zora_Neale_Hurston 1 1 1 1 1 1 1 1 1 1 _ 42 42 42 42 42 42 42 42 42 42 _gota_Krist_f 1 1 1 1 1 1 1 1 1 1 _mile_Zola 4 4 4 4 4 4 4 4 4 4 _ric_Emmanuel_Schmitt 1 1 1 1 1 1 1 1 1 1 _sne_Seierstad 1 1 1 1 1 1 1 1 1 1 2645 rows × 10 columns Lots of useless info there. One column should suffice Exercise: Group the dataframe by author . Include the following columns: rating , name , author . For the aggregation of the name column which includes the names of the books create a list with the strings containing the name of each book. Make sure that the way you aggregate the rest of the columns make sense! Create a new column with number of books for each author and find the most prolific author! In [33]: ###### Before we start : what do we do about these titles where 'name' is unreadable? Try different encodings? auth_name = 'A_id_al_Qarni' df [ df . author == auth_name ] . head () Out[33]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } rating review_count isbn booktype author_url year dir rating_count name author genres 2213 4.19 1169 good_reads:book https://www.goodreads.com/author/show/1201952.... 2003 dir23/2750180.html 15781 ÙØ§ ØªØ­Ø²Ù A_id_al_Qarni religion|religion|islam|self-help|non-fiction|... 5998 3.91 281 good_reads:book https://www.goodreads.com/author/show/1201952.... 2006 dir60/2750008.html 3083 Ø£Ø³Ø¹Ø¯ Ø§Ù Ø±Ø£Ø© ÙÙ Ø§ÙØ¹Ø§ÙÙ A_id_al_Qarni religion|islam|religion|self-help|spirituality... In [34]: df [ df . author == auth_name ] . iat [ 0 , 8 ] . encode ( 'UTF-16' ) Out[34]: b'\\xff\\xfe\\xd9\\x00\\x84\\x00\\xd8\\x00\\xa7\\x00 \\x00\\xd8\\x00\\xaa\\x00\\xd8\\x00\\xad\\x00\\xd8\\x00\\xb2\\x00\\xd9\\x00\\x86\\x00' In [35]: # let's examine the columns we have df . columns Out[35]: Index(['rating', 'review_count', 'isbn', 'booktype', 'author_url', 'year', 'dir', 'rating_count', 'name', 'author', 'genres'], dtype='object') Create the GroupBy table In [36]: authors = df . copy () authors = authors [[ 'rating' , 'name' , 'author' ]] . groupby ( 'author' ) . agg ({ 'rating' : np . mean , 'name' : '|' . join }) In [37]: authors = authors . reset_index () authors . head () Out[37]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } author rating name 0 A_A_Milne 4.365 Winnie-the-Pooh|The House at Pooh Corner|The H... 1 A_G_Howard 4.020 Splintered (Splintered, #1) 2 A_J_Cronin 4.220 The Keys of the Kingdom 3 A_J_Jacobs 3.750 The Year of Living Biblically 4 A_J_Salt 4.940 Nik Nassa & the Mark of Destiny In [38]: # split the column string and make a list of string book names authors [ 'name' ] = authors . name . str . split ( '|' ) authors . head () Out[38]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } author rating name 0 A_A_Milne 4.365 [Winnie-the-Pooh, The House at Pooh Corner, Th... 1 A_G_Howard 4.020 [Splintered (Splintered, #1)] 2 A_J_Cronin 4.220 [The Keys of the Kingdom] 3 A_J_Jacobs 3.750 [The Year of Living Biblically] 4 A_J_Salt 4.940 [Nik Nassa & the Mark of Destiny] In [39]: # count the books - create new column len ( authors . name [ 0 ]) Out[39]: 6 In [40]: authors [ 'num_books' ] = authors [ 'name' ] . str . len () authors Out[40]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } author rating name num_books 0 A_A_Milne 4.365000 [Winnie-the-Pooh, The House at Pooh Corner, Th... 6 1 A_G_Howard 4.020000 [Splintered (Splintered, #1)] 1 2 A_J_Cronin 4.220000 [The Keys of the Kingdom] 1 3 A_J_Jacobs 3.750000 [The Year of Living Biblically] 1 4 A_J_Salt 4.940000 [Nik Nassa & the Mark of Destiny] 1 5 A_Meredith_Walters 4.150000 [Find You in the Dark (Find You in the Dark, #... 2 6 A_N_Roquelaure 3.450000 [Beauty's Punishment (Sleeping Beauty, #2), Th... 2 7 A_S_Byatt 3.860000 [Possession] 1 8 A_S_King 3.930000 [Please Ignore Vera Dietz] 1 9 A_id_al_Qarni 4.050000 [ÙØ§ ØªØ­Ø²Ù, Ø£Ø³Ø¹Ø¯ Ø§Ù Ø±Ø£Ø© ÙÙ Ø§ÙØ... 2 10 Abbi_Glines 4.179286 [Fallen Too Far (Too Far, #1), Existence (Exis... 14 11 Abdul_Rahman_Munif 4.030000 [Ø§ÙØªÙÙ] 1 12 Abigail_Gibbs 3.820000 [Dinner With a Vampire (Dark Heroine, #1)] 1 13 Abigail_Roux 4.470000 [Cut & Run (Cut & Run, #1), Fish & Chips (Cut ... 4 14 Abigail_Thomas 3.680000 [A Three Dog Life] 1 15 Abolqasem_Ferdowsi 4.520000 [Shahnameh] 1 16 Abraham_Verghese 4.260000 [Cutting for Stone] 1 17 Abul_Hasan_Ali_Nadwi 4.150000 [Ù Ø§Ø°Ø§ Ø®Ø³Ø± Ø§ÙØ¹Ø§ÙÙ Ø¨Ø§ÙØ­Ø·Ø§Ø· Ø... 1 18 Adam_Hochschild 4.140000 [King Leopold's Ghost] 1 19 Adam_Johnson 4.030000 [The Orphan Master's Son] 1 20 Adam_Levin 4.040000 [The Instructions] 1 21 Adam_Rex 4.140000 [The True Meaning of Smekday] 1 22 Adam_Smith 3.820000 [The Wealth of Nations] 1 23 Addison_Moore 3.780000 [Ethereal (Celestra, #1)] 1 24 Adeline_Yen_Mah 4.010000 [Chinese Cinderella] 1 25 Adolf_Hitler 2.970000 [Mein Kampf] 1 26 Adolfo_Bioy_Casares 4.060000 [The Invention of Morel] 1 27 Aeschylus 3.960000 [The Oresteia] 1 28 Aesop 4.030000 [Aesop's Fables] 1 29 Agatha_Christie 3.977273 [And Then There Were None, Murder on the Orien... 11 ... ... ... ... ... 2615 William_Strunk_Jr_ 4.170000 [The Elements of Style] 1 2616 William_Styron 4.043333 [Sophie's Choice, The Confessions of Nat Turne... 3 2617 William_Wharton 4.090000 [Birdy, A Midnight Clear] 2 2618 William_Wordsworth 3.920000 [Lyrical Ballads] 1 2619 Willow_Aster 4.140000 [True Love Story] 1 2620 Wilson_Rawls 3.990000 [Where the Red Fern Grows, Summer of the Monkeys] 2 2621 Winston_Groom 3.970000 [Forrest Gump (Forrest Gump, #1)] 1 2622 Witold_Gombrowicz 3.975000 [Ferdydurke, Cosmos] 2 2623 Wm_Paul_Young 3.660000 [The Shack] 1 2624 Woody_Allen 4.030000 [Without Feathers] 1 2625 Wu_Cheng_en 4.040000 [Monkey] 1 2626 Yamamoto_Tsunetomo 4.090000 [Hagakure] 1 2627 Yana_Toboso 4.340000 [Black Butler, Vol. 01 (Black Butler, #1)] 1 2628 Yann_Martel 3.470000 [Life of Pi, Beatrice and Virgil] 2 2629 Yasunari_Kawabata 3.740000 [Snow Country] 1 2630 Yevgeny_Zamyatin 3.970000 [We] 1 2631 Young_Kim 3.660000 [Twilight (Twilight: The Graphic Novel, #1)] 1 2632 Yuehai_Xiao 4.560000 [Crossing the Seas] 1 2633 Yukio_Mishima 4.030000 [The Sailor Who Fell from Grace with the Sea, ... 2 2634 Yukito_Kishiro 4.150000 [Battle Angel Alita, Volume 01] 1 2635 Yvonne_Woon 3.950000 [Dead Beautiful (Dead Beautiful, #1)] 1 2636 Zack_Love 3.550000 [Sex in the Title] 1 2637 Zadie_Smith 3.655000 [White Teeth, On Beauty] 2 2638 Zilpha_Keatley_Snyder 4.110000 [The Changeling] 1 2639 Zora_Neale_Hurston 3.820000 [Their Eyes Were Watching God] 1 2640 _ 3.988095 [Ø¹Ø²Ø§Ø²ÙÙ, Ø«ÙØ§Ø«ÙØ© ØºØ±ÙØ§Ø·Ø©, ØªØ±... 42 2641 _gota_Krist_f 4.340000 [The Notebook, The Proof, The Third Lie] 1 2642 _mile_Zola 3.990000 [Germinal (Les Rougon-Macquart, #13), L'Assomm... 4 2643 _ric_Emmanuel_Schmitt 4.160000 [Oscar et la dame rose] 1 2644 _sne_Seierstad 3.740000 [The Bookseller of Kabul] 1 2645 rows × 4 columns In [41]: # sort for more prolific authors . sort_values ( by = 'num_books' , ascending = False ) . iloc [ 0 ] Out[41]: author Stephen_King rating 3.91875 name [The Stand, The Shining (The Shining #1), It, ... num_books 56 Name: 2349, dtype: object Winner is Stephen King with 56 books! OMG!!! Perhaps you want more detailed info... In [ ]: dfgb_author [[ 'rating' , 'rating_count' , 'review_count' , 'year' ]] . describe () You can also access a groupby dictionary style. In [ ]: ratingdict = {} for author , subset in dfgb_author : ratingdict [ author ] = ( subset [ 'rating' ] . mean (), subset [ 'rating' ] . std ()) ratingdict Exercise Lets get the best-rated book(s) for every year in our dataframe. In [ ]: #Using .groupby, we can divide the dataframe into subsets by the values of 'year'. #We can then iterate over these subsets # your code here for year , subset in df . groupby ( 'year' ): #Find the best book of the year bestbook = subset [ subset . rating == subset . rating . max ()] if bestbook . shape [ 0 ] > 1 : print ( year , bestbook . name . values , bestbook . rating . values ) else : print ( year , bestbook . name . values [ 0 ], bestbook . rating . values [ 0 ]) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab02-pandas/notebook/"},{"title":"Lecture 3: Code Pandas + Beautiful Soup","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lecture 3 (Pandas + Beautiful Soup) Harvard University Fall 2019 Instructors: Pavlos Protopapas, Kevin Rader, and Chris Tanner Authors: Rahul Dave, David Sondak, Will Claybaugh, Pavlos Protopapas, Chris Tanner In [1]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING from IPython.core.display import HTML from IPython.display import Image def css_styling (): styles = open ( \"../../../styles/cs109.css\" , \"r\" ) . read () return HTML ( styles ) css_styling () Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } Table of Contents Learning Goals Loading and Cleaning with Pandas Parsing and Completing the Dataframe Grouping Learning Goals This Jupyter notebook accompanies Lecture 3. By the end of this lecture, you should be able to: Understand why and how Pandas can be useful. Use Pandas to: Load data into a DataFrame Access subsets of data based on column and row values Address missing values (e.g., NaN ) Use groupby() to select sections of data. Plot DataFrames (e.g., barplot()) Use Beautiful Soup to download a webpage and all of its links Part 1: Processing Data without Pandas ../data/top50.csv is a dataset found online (Kaggle.com) that contains information about the 50 most popular songs on Spotify in 2019. Each row represents a distinct song. The columns (in order) are: ID: a unique ID (i.e., 1-50) TrackName: Name of the Track ArtistName: Name of the Artist Genre: the genre of the track BeatsPerMinute: The tempo of the song. Energy: The energy of a song - the higher the value, the more energetic. song Danceability: The higher the value, the easier it is to dance to this song. Loudness: The higher the value, the louder the song. Liveness: The higher the value, the more likely the song is a live recording. Valence: The higher the value, the more positive mood for the song. Length: The duration of the song (in seconds). Acousticness: The higher the value, the more acoustic the song is. Speechiness: The higher the value, the more spoken words the song contains. Popularity: The higher the value, the more popular the song is. In [174]: Image ( \"fig/top50_screenshot.png\" ) # sample of the data Out[174]: Read and store ../data/top50.csv Q1: Read in the ../data/top50.csv file and store all of its contents into any data structure(s) that make the most sense to you, keeping in mind that you'd want to easily access any row or column. What data structure(s) make the most sense to use? In [183]: f = open ( \"../data/top50.csv\" ) column_names = f . readline () . strip () . split ( \",\" )[ 1 :] # puts names in a list cleaned_column_names = [ name for name in column_names ] # removes the extraneous quotes cleaned_column_names . insert ( 0 , \"ID\" ) dataset = [] # iterates through each line of the .csv file for line in f : attributes = line . strip () . split ( \",\" ) # constructs a new dictionary for each line, and # appends this dictionary to the `dataset`; # thus, the dataset is a list of dictionaries (1 dictionary per song) dataset . append ( dict ( zip ( cleaned_column_names , attributes ))) Q2: Write code to print all songs (Artist and Track name) that are longer than 4 minutes (240 seconds): In [184]: for song in dataset : if int ( song [ \"Length\" ]) > 240 : print ( song [ \"ArtistName\" ], \"-\" , song [ \"TrackName\" ], \"is\" , song [ \"Length\" ], \"seconds long\" ) Anuel AA - China is 302 seconds long Bad Bunny - Callaita is 251 seconds long Sech - Otro Trago - Remix is 288 seconds long Chris Brown - No Guidance (feat. Drake) is 261 seconds long J Balvin - LA CANCIÓN is 243 seconds long Jhay Cortez - No Me Conoce - Remix is 309 seconds long Lunay - Soltera - Remix is 266 seconds long Q3: Write code to print the most popular song (or song(s) if there is a tie): In [383]: max_score = - 1 most_populars = set () for song in dataset : if int ( song [ \"Popularity\" ]) > max_score : most_populars = set ([ str ( song [ \"ArtistName\" ] + \"-\" + song [ \"TrackName\" ])]) max_score = int ( song [ \"Popularity\" ]) elif int ( song [ \"Popularity\" ]) == max_score : most_populars . add ( str ( song [ \"ArtistName\" ] + \"-\" + song [ \"TrackName\" ])) #print(most_populars) Q4: Write code to print the songs (and their attributes), if we sorted by their popularity (highest scoring ones first). In [186]: # This gets tricky. How would you do it? Q5: How could you check for null/empty entries? This is only 50 entries. Imagine if we had 500,000. In [187]: # you would need to iterate through every single value and check # that's O(N*M), where N is the # of rows, and M is the # of columns. # NOTE: what if you wished to impute any given non-value with the column's mean? # you would need another N checks Often times, one dataset doesn't contain all of the information you are interested in -- in which case, you need to combine data from multiple files. Q6: Imagine we had another table (i.e., .csv file) below. How could we combine its data with our already-existing dataset ? Part 2: Processing Data with Pandas Pandas is an open-source Python library designed for data analysis and processing. Being open-sourced means that anyone can contribute to it (don't worry, a team of people vett all official updates to the library). Pandas allows for high-performance, easy-to-use data structures. Namely, instead of using N-dimensional arrays like NumPy (which are extremely fast, though), Pandas provides a 2D-table object calleda DataFrame . As a very gross simplification: NumPy is great for performing math operations with matrices, whereas Pandas is excellent for wrangling, processing, and understanding 2D data like spreadsheets (2D data like spreadsheets is very common and great). Let's get started with simple examples of how to use Pandas. We will continue with our top50.csv Spotify music data. First, we need to import pandas so that we have access to it. For typing convenience, we choose to rename it as pd , which is common practice. In [2]: % matplotlib inline import numpy as np import matplotlib.pyplot as plt import pandas as pd import seaborn as sns pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) Reading in the data Pandas allows us to read in various structured files (e.g., .csv, .json, .html, etc) with just one line: In [4]: # we don't always need to specify the encoding, but this particular # file has special characters that we need to handle top50 = pd . read_csv ( \"../data/top50.csv\" ) High-level view of the data We can view the data frame by simply printing it: In [381]: top50 Instead of printing the entire dataframe (e.g., print(top50) ), we can also inspect the file by looking at just the first N rows or last N rows. In [380]: #top50.head(3) # first 3 rows #top50.tail(3)) # last 3 rows That's cool, but we can't see all of the columns too well. To get a list of all columns: In [379]: #top50.columns Remember, Pandas is in Python, so you can write regular Python code with it. For example, if you want to know how many columns there are, you can use Python's len() function. In [378]: #len(top50.columns) Fortunately, many of the features in our dataset are numeric. Conveniently, Pandas' describe() function calculates basic statistics for our columns. It's pretty amazing, as it allows us a very coarse-grain approach to understanding our data and checking for errors. That is, if we notice any summary statistics that are drastically different than what we deem reasonable, we should dive deeper and figure out why the values are what they are. In [377]: #top50.describe() Notice, it calculated statistics only for the columns that are of numeric data types. What about the textual ones (e.g., Track name and Artist)? Pandas is smart enough to infer the data types. Don't forget to inspect the columns that are text-based though, as we need to ensure they are sound, too. To view the data type of each column: In [376]: #top50.dtypes Exploring the data I agree with Pandas' handling of the data. If any column contained floating point numbers, we would expect to see such here, too. Now that we've viewed our dataset at a high-level, let's actually use and explore it. We can access a column of data the same way we access dictionary by its keys: In [374]: #top50[\"Length\"] We could have also used this syntax (identical results): In [373]: #top50.Length If we want just the highest or lowest value of a given column, we can use the functions max() and min() , respectively. In [372]: #top50['Length'].max() In [371]: #top50['Length'].min() If we want the row index that corresponds to a column's max or min value, we can use idxmax() and idxmin() , respectively. In [370]: #top50['Length'].idxmax() In [369]: #top50['Length'].idxmin() We can also add conditional statements (e.g., >, <, ==) for columns, which yields a boolean vector: In [368]: #top50['Length'] > 240 This is useful, as it allows us to process only the rows with the True values. The loc() function allows us to access data via labels: A single scalar label A list of labels A slice object A Boolean array A single scalar: In [367]: # single scalar label #top50.loc[0] # prints the (unnamed) row that has a label of 0 (the 1st row) In [366]: # list of labels #top50.loc[[0,2]] # prints the (unnamed) rows that have the labels of 0 and 2 (the 1st and 3rd rows) In [365]: # a slice of the dataframe, based on the passed-in booleans; # picture it's like a filter overlaying the DataFrame, and the filter # dictates which values will be emitted/make it through to us #top50.loc[top50['Length'] > 240] # prints all rows that have Length > 240 Note, this returns a DataFrame . Everything we've learned so far concerns how to use DataFrames, so we can tack on additional syntax to this command if we wish to do further processing. For example, if we want to index just select columns (e.g., ArtistName, TrackName, and Length) of this returned DataFrame: In [364]: #top50.loc[top50['Length'] > 240][['ArtistName', 'TrackName', 'Length']] Note, the above solves our original Q2: (Write code to print all songs (Artist and Track name) that are longer than 4 minutes (240 seconds)) Q3: Write code to print the most popular song (or song(s) if there is a tie): In [6]: ## [TODO] TO BE FILLED IN DURING CLASS PARTICIPATION # FEEL FREE TO WORK WITH A NEIGHBOR top50 . iloc [ top50 [ 'Popularity' ] . idxmax ()] We can also sort our data by a single column! This pertains to our original Q4! Q4: Write code to print the songs (and their attributes), if we sorted by their popularity (highest scoring ones first). In [314]: #top50.sort_values(\"Popularity\", ascending=False) While .loc() allows us to index based on passed-in labels, .iloc() allows us to access data based on 0-based indices. The syntax is .iloc[ , ] , where and can be scalars, lists, or slices of indices. In [363]: #top50.iloc[5:6] # prints all columns for the 6th row In [316]: #top50.iloc[:,2] # prints all rows for the 3rd column In [317]: #top50.iloc[[0,2,3], [2,1]] # prints the 1st, 3rd, and 4th rows of the 3rd and 2nd columns (artist and track) Inspecting/cleaning the data As mentioned, it is imperative to ensure the data is sound to use: Did it come from a trustworthy, authoritative source? Is the data a complete sample? Does the data seem correct? (optional) Is the data stored efficiently or does it have redundancies? Let's walk through each of these points now: Did it come from a trustworthy, authoritative source? The data came from Kaggle.com, which anyone can publish to. However, the author claims that he/she used Spotify.com's official API to query songs in 2019. There are no public comments for it so far. It's potentially credible. Is the data a complete sample? Pandas has functions named isnull() and notnull() , which return DataFrames corresponding to any null or non-null entries, respectively. For example: In [319]: #top50[top50.ArtistName.isnull()] # returns an empty DataFrame In [329]: #top50[top50.ArtistName.notnull()] # returns the complete DataFrame since there are no null Artists If we run this for all of our features/columns, we will see there are no nulls. Since this dataset is manageable in size, you can also just scroll through it and notice no nulls. This answers our original Q5: Q5: How could you check for null/empty entries? Continuing with our data sanity check list: Does the data seem correct? A quick scroll through the data, and we see a song by Maluma titled 0.95833333 . This is possibly a song about probability, but I think the chances are slim. The song is 176 seconds long (2m56s). Looking on Spotify, we see Maluma's most popular song is currently 11PM which is 2m56s in length! Somehow, during the creation of the dataset, 11PM became 0.95833333. Bonus points if you can figure out where this pointing number could have come from. In [362]: #Image(\"fig/maluma.png\") # sample of the data Since only one song seems obviously wrong, we can manually fix it. And it's worth noting such to ourselves and to whomever else would see our results or receive a copy of our data. If there were many more wrong values, we'd potentialy not fix them, as we'd explore other options. (optional) Is the data stored efficiently or does it have redundancies? Everything seems fine. No repeated data. Combining multiple DataFrames As mentioned, often times one dataset doesn't contain all of the information you are interested in -- in which case, you need to combine data from multiple files. This also means you need to verify the accuracy (per above) of each dataset. Pandas' groupby() function splits the DataFrame into different groups, depending on the passed-in variable. For example, we can group our data by the genres: In [360]: grouped_df = top50 . groupby ( 'Genre' ) #for key, item in grouped_df: # print(\"Genre:\", key, \"(\", len(grouped_df.get_group(key)), \"items):\", grouped_df.get_group(key), \"\\n\\n\") ../data/spotify_aux.csv contains the same 50 songs as top50.csv ; however, it only contains 3 columns: Track Name Artist Name Explicit Language (boolean valued) Note, that 3rd column is just random values, but pretend as if it's correct. The point of this section is to demonstrate how to merge columns together. Let's load ../data/spotify_aux.csv into a DataFrame: In [357]: explicit_lyrics = pd . read_csv ( \"../data/spotify_aux.csv\" ) #explicit_lyrics Let's merge it with our top50 DataFrame. .merge() is a Pandas function that stitches together DataFrames by their columns. .concat() is a Pandas function that stitches together DataFrames by their rows (if you pass axis=1 as a flag, it will be column-based) In [356]: # 'on='' specifies the column used as the shared key df_combined = pd . merge ( explicit_lyrics , top50 , on = 'TrackName' ) #df_combined We see that all columns from both DataFrames have been added. That's nice, but having duplicate ArtistName and TrackName is unecessary. Since merge() uses DataFrames as the passed-in objects, we can simply pass merge() a stripped-down copy of ExplicitLanguage , which helps merge() not add any redundant fields. In [355]: df_combined = pd . merge ( explicit_lyrics [[ 'TrackName' , 'ExplicitLanguage' ]], top50 , on = 'TrackName' ) #df_combined This answers our original Q6: Q6: Imagine we had another table (i.e., .csv file) below. How could we combine its data with our already-existing dataset ? While we do not exhaustively illustrate Pandas' joining/splitting functionality, you may find the following functions useful: merge() concat() aggregate() append() Plotting DataFrames As a very simple example of how one can plot elements of a DataFrame, we turn to Pandas' built-in plotting: In [242]: scatter_plot = top50 . plot . scatter ( x = 'Danceability' , y = 'Popularity' , c = 'DarkBlue' ) This shows the lack of a correlation between the Danceability of a song and its popularity, based on just the top 50 songs, of course. Please feel free to experiment with plotting other items of interest, and we recommend using Seaborn. Practice Problems with a Partner (or individually if you prefer) P1. Print the shortest song (all features): In [7]: # [TODO] TO BE FILLED IN DURING CLASS PARTICIPATION top50 . iloc [ top50 [ 'Length' ] . idxmin ()] Out[7]: Unnamed: 0 22 TrackName Panini ArtistName Lil Nas X Genre country rap BeatsPerMinute 154 Energy 59 Danceability 70 Loudness -6 Liveness 12 Valence 48 Length 115 Acousticness 34 Speechiness 8 Popularity 91 Name: 21, dtype: object P2. Print the 5 shortest songs (all features): In [334]: # [TODO] TO BE FILLED IN DURING CLASS PARTICIPATION top50 . sort_values ( \"Length\" , ascending = True )[ 0 : 5 ] P3. What is the average length of the 5 shortest songs? In [343]: # [TODO] TO BE FILLED IN DURING CLASS PARTICIPATION top50 . sort_values ( \"Length\" , ascending = True )[ 0 : 5 ][ 'Length' ] . mean () P4. Write a function that accepts a DataFrame as an input and returns True if there exists any null values in the DataSet. Otherwise, returns False. Pass top50 to the function in order to test it. In [22]: # [TODO] TO BE FILLED IN DURING CLASS PARTICIPATION #print(top50['Genre'].isnull()) def contains_nulls ( df ): for col in df . columns : if np . sum ( df [ col ] . isnull ()) > 0 : return True return False contains_nulls ( top50 ) Out[22]: False P5. How many distinct genres are present in the top 50 songs? In [23]: # [TODO] TO BE FILLED IN DURING CLASS PARTICIPATION len ( top50 [ 'Genre' ] . unique ()) Out[23]: 21 P6. Print the songs that have a Danceability score above 80 and a popularity above 86. HINT: you can combine conditional statements with the & operator, and each item must be surrounded with ( ) brackets. In [24]: # [TODO] TO BE FILLED IN DURING CLASS PARTICIPATION top50 [( top50 [ 'Danceability' ] > 80 ) & ( top50 [ 'Popularity' ] > 86 )] Out[24]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Unnamed: 0 TrackName ArtistName Genre BeatsPerMinute Energy Danceability Loudness Liveness Valence Length Acousticness Speechiness Popularity 8 9 Old Town Road - Remix Lil Nas X country rap 136 62 88 -6 11 64 157 5 10 87 14 15 Money In The Grave (Drake ft. Rick Ross) Drake canadian hip hop 101 50 83 -4 12 10 205 10 5 92 18 19 Lalala Y2K canadian hip hop 130 39 84 -8 14 50 161 18 8 88 44 45 Con Altura ROSALÍA r&b en espanol 98 69 88 -4 5 75 162 39 12 88 P7. Print the songs that are faster than the average Top 50 and more popular than the average Top 50? In [25]: # [TODO] TO BE FILLED IN DURING CLASS PARTICIPATION avg_speed = top50 [ 'BeatsPerMinute' ] . mean () avg_popularity = top50 [ 'Popularity' ] . mean () top50 [( top50 [ 'BeatsPerMinute' ] > avg_speed ) & ( top50 [ 'Popularity' ] > avg_popularity )] Out[25]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } Unnamed: 0 TrackName ArtistName Genre BeatsPerMinute Energy Danceability Loudness Liveness Valence Length Acousticness Speechiness Popularity 4 5 Goodbyes (Feat. Young Thug) Post Malone dfw rap 150 65 58 -4 11 18 175 45 7 94 6 7 Ransom Lil Tecca trap music 180 64 75 -6 7 23 131 2 29 92 9 10 bad guy Billie Eilish electropop 135 43 70 -11 10 56 194 33 38 95 10 11 Callaita Bad Bunny reggaeton 176 62 61 -5 24 24 251 60 31 93 16 17 LA CANCIÓN J Balvin latin 176 65 75 -6 11 43 243 15 32 90 18 19 Lalala Y2K canadian hip hop 130 39 84 -8 14 50 161 18 8 88 19 20 Truth Hurts Lizzo escape room 158 62 72 -3 12 41 173 11 11 91 20 21 Piece Of Your Heart MEDUZA pop house 124 74 68 -7 7 63 153 4 3 91 21 22 Panini Lil Nas X country rap 154 59 70 -6 12 48 115 34 8 91 24 25 bad guy (with Justin Bieber) Billie Eilish electropop 135 45 67 -11 12 68 195 25 30 89 31 32 7 rings Ariana Grande dance pop 140 32 78 -11 9 33 179 59 33 89 36 37 Otro Trago Sech panamanian pop 176 70 75 -5 11 62 226 14 34 91 46 47 Te Robaré Nicky Jam latin 176 75 67 -4 8 80 202 24 6 88 P8. Plot a histogram of the Genre counts (x-axis is the Genres, y-axis is the # of songs with that Genre) In [26]: # [TODO] TO BE FILLED IN DURING CLASS PARTICIPATION P9. (open ended) Think of a subset of the data that you're interested in. Think of an interesting plot that could be shown to illustrate that data. With a partner, discuss whose would be easier to create. Together, create that plot. Then, try to create the harder plot. In [354]: # [TODO] TO BE FILLED IN DURING CLASS PARTICIPATION if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"pages","url":"pages/lecture-3/notebook/"},{"title":"Lecture 3: Pandas and Web Scraping","text":"Slides Lecture 3: Pandas and Web Scraping [pptx] Lecture 3: Pandas and Web Scraping [pdf] Lecture Notebook Lecture 3: Pandas Tutorial","tags":"lectures","url":"lectures/lecture3/"},{"title":"Lecture 2: Data Science Demo (repeat from Lecture 1)","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lecture 2: Example Harvard University Fall 2019 Instructors : Protopapas, Rader, and Tanner In [ ]: import pandas as pd import numpy as np import scipy as sp import matplotlib.pyplot as plt from math import radians , cos , sin , asin , sqrt import datetime from sklearn.linear_model import LinearRegression import seaborn as sns sns . set ( style = \"ticks\" ) % matplotlib inline Download the data from https://drive.google.com/open?id=0B28c493CP9GtMzN1emFoMkJNNlU First Look At The Data In [ ]: hubway_data = pd . read_csv ( 'hubway_trips.csv' , low_memory = False ) hubway_data . head () In [ ]: hubway_data . shape A little data manipulation In [ ]: check_out_year = hubway_data [ 'start_date' ] . apply ( lambda s : int ( s [ - 13 : - 9 ])) year_to_age = ( check_out_year - hubway_data [ 'birth_date' ]) Who In [ ]: fig , ax = plt . subplots ( 1 , 2 , figsize = ( 15 , 6 )) #And now for our first plot: a barplot of gender gender_counts = np . unique ( hubway_data [ 'gender' ] . replace ( np . nan , 'NaN' , regex = True ) . values , return_counts = True ) ax [ 0 ] . bar ( range ( 3 ), gender_counts [ 1 ], align = 'center' , color = [ 'black' , 'green' , 'teal' ], alpha = 0.5 ) ax [ 0 ] . set_xticks ([ 0 , 1 , 2 ]) ax [ 0 ] . set_xticklabels ([ 'none' , 'male' , 'female' , ' ' ]) ax [ 0 ] . set_title ( 'Users by Gender' ) #And a histogram of ages ax [ 1 ] . hist ( year_to_age . dropna (), bins = 30 ) ax [ 1 ] . set_title ( 'Histogram of User Ages by Checkout' ) ax [ 1 ] . axvline ( x = np . mean ( year_to_age . dropna ()), color = 'red' , label = 'Average Age' ) ax [ 1 ] . legend () plt . show () In [ ]: #And now for a second plot: scatter plot of age with duration plt . yscale ( 'log' ) plt . scatter ( year_to_age , hubway_data . duration + 1 ) plt . title ( 'Scatter plot of Duration by User Ages' ) plt . xlabel ( 'Age in years' ) plt . ylabel ( 'Duration (in seconds)' ) plt . show () Where In [ ]: station_data = pd . read_csv ( 'hubway_stations.csv' , low_memory = False )[[ 'id' , 'lat' , 'lng' ]] station_data . head () In [ ]: hubway_data_with_gps = hubway_data . join ( station_data . set_index ( 'id' ), on = 'strt_statn' ) hubway_data_with_gps . head () When In [ ]: #check_out_times = pd.to_datetime(hubway_data['start_date']) check_out_hours = hubway_data [ 'start_date' ] . apply ( lambda s : int ( s [ - 8 : - 6 ])) In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 5 )) check_out_counts = np . unique ( check_out_hours , return_counts = True ) ax . bar ( check_out_counts [ 0 ], check_out_counts [ 1 ], align = 'center' , width = 0.4 , alpha = 0.6 ) ax . set_xlim ([ - 1 , 24 ]) ax . set_xticks ( range ( 24 )) ax . set_xlabel ( 'Hour of Day' ) ax . set_ylabel ( 'Number of Checkouts' ) ax . set_title ( 'Time of Day vs Checkouts' ) plt . show () How In [ ]: def haversine ( pt , lat2 = 42.355589 , lon2 =- 71.060175 ): \"\"\" Calculate the great circle distance between two points on the earth (specified in decimal degrees) \"\"\" lon1 = pt [ 0 ] lat1 = pt [ 1 ] # convert decimal degrees to radians lon1 , lat1 , lon2 , lat2 = map ( radians , [ lon1 , lat1 , lon2 , lat2 ]) # haversine formula dlon = lon2 - lon1 dlat = lat2 - lat1 a = sin ( dlat / 2 ) ** 2 + cos ( lat1 ) * cos ( lat2 ) * sin ( dlon / 2 ) ** 2 c = 2 * asin ( sqrt ( a )) r = 3956 # Radius of earth in miles return c * r In [ ]: station_counts = np . unique ( hubway_data_with_gps [ 'strt_statn' ] . dropna (), return_counts = True ) counts_df = pd . DataFrame ({ 'id' : station_counts [ 0 ], 'checkouts' : station_counts [ 1 ]}) counts_df = counts_df . join ( station_data . set_index ( 'id' ), on = 'id' ) #add distance counts_df . loc [:, 'dist_to_center' ] = list ( map ( haversine , counts_df [[ 'lng' , 'lat' ]] . values )) counts_df . head () In [ ]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 5 )) ax . scatter ( counts_df [ 'dist_to_center' ] . values , counts_df [ 'checkouts' ] . values ) reg_line = LinearRegression () reg_line . fit ( counts_df [ 'dist_to_center' ] . values . reshape (( len ( counts_df [ 'dist_to_center' ]), 1 )), counts_df [ 'checkouts' ] . values ) distances = np . linspace ( counts_df [ 'dist_to_center' ] . min (), counts_df [ 'dist_to_center' ] . max (), 50 ) ax . plot ( distances , reg_line . predict ( distances . reshape (( len ( distances ), 1 ))), color = 'red' , label = 'Regression Line' ) ax . set_xlabel ( 'Distance to City Center (Miles)' ) ax . set_ylabel ( 'Number of Checkouts' ) ax . set_title ( 'Distance to City Center vs Checkouts' ) ax . legend () plt . savefig ( 'How.png' , dpi = 300 ) In [ ]: #let's look at some subgroups print ( np . unique ( hubway_data . subsc_type , return_counts = True )) In [ ]: #And now for a plot of histograms across registration type duration_registered = ( hubway_data . duration [ hubway_data . subsc_type == 'Registered' ]) duration_casual = ( hubway_data . duration [ hubway_data . subsc_type == 'Casual' ]) print ( np . mean ( duration_registered )) print ( np . mean ( duration_casual )) logduration_registered = np . log ( duration_registered + 1 ) logduration_casual = np . log ( duration_casual + 1 ) plt . hist ( logduration_registered . dropna (), alpha =. 5 , bins = 30 ) plt . hist ( logduration_casual . dropna (), alpha =. 5 , bins = 30 ) #plt.hist(duration_registered.dropna()+1, alpha=.5) #plt.hist(duration_casual.dropna()+1, alpha=.5) plt . title ( 'Histograms of duration split by Checkouts' ) plt . xlabel ( 'Duration (in log(seconds))' ) plt . ylabel ( 'Number of Checkouts' ) #plt.xscale('log') plt . show () if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lecture-2/notebook/"},{"title":"Lab 1: Python basics, YAML environments, Numpy","text":"Jupyter Notebooks Lab 1: Introduction to Python and its Libraries","tags":"labs","url":"labs/lab-1/"},{"title":"Lab 01: YAML Environments, Python basics, Numpy","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS-109A Introduction to Data Science Lab 1: Introduction to Python and its Numerical Stack Harvard University Fall 2019 Instructors: Pavlos Protopapas, Kevin Rader, and Chris Tanner Lab Instructor: Eleni Kaxiras Authors: Rahul Dave, David Sondak, Will Claybaugh, Pavlos Protopapas, Chris Tanner, and Eleni Kaxiras In [1]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[1]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [2]: PATHTOSOLUTIONS = '../solutions' Programming Expectations All assignments for this class will use Python and the browser-based iPython notebook format you are currently viewing. Programming at the level of CS 50 is a prerequisite for this course. If you have concerns about this, come speak with any of the instructors. We will refer to the Python 3 documentation in this lab and throughout the course. Learning Goals This introductory lab is a condensed introduction to Python numerical programming. By the end of this lab, you will feel more comfortable: Learn about anconda environments and setup your own with the necessary dependencies Writing short Python code using functions, loops, lists, numpy arrays, and dictionaries. Manipulating Python lists and numpy arrays and understanding the difference between them. Introducing the stats libraries scipy.stats and statsmodels Part 1: Set up a Conda Python Environment and Clone the Class Repository On Python installation packages There are two main installing packages for Python, conda and pip . Pip is the Python Packaging Authority's recommended tool for installing packages from the Python Package Index (PyPI) . Conda is a cross platform package and environment manager that installs and manages conda packages from the Anaconda repository and Anaconda Cloud . Conda does not assume any specific configuration in your computer and will install the Python interpreter along with the other Python packages, whereas pip assumes that you have installed the Python interpreter in your computer. Given the fact that most operating systems do include Python this is not a problem. If I could summarize their differences into a sentence it would be that conda has the ability to create isolated environments that can contain different versions of Python and/or the packages installed in them. This can be extremely useful when working with data science tools as different tools may contain conflicting requirements which could prevent them all being installed into a single environment. You can have environments with pip but would have to install a tool such as virtualenv or venv. You may use either, we recommend conda because in our experience it leads to fewer incompatibilities between packages and thus fewer broken environments. Conclusion: Use Both. Most often in our data science environments we want to combining pip with conda when one or more packages are only available to install via pip. Although thousands of packages are available in the Anaconda repository, including the most popular data science, machine learning, and AI frameworks but a lot more are available on PyPI. Even if you have your environment installed via conda you can use pip to install individual packages ( source: anaconda site ) Installing Conda - First check if you have conda In MacOS or Linux open a Terminal window and at the prompt type conda –V If you get the version number (e.g. conda 4.6.14 ) you are all set! If you get an error, that means you do not have Anaconda and would be a good idea to install it. - If you do not have it, you can install it by following the instructions: Mac : https://docs.anaconda.com/anaconda/install/mac-os/ Windows : https://docs.anaconda.com/anaconda/install/windows (Note: #8 is important: DO NOT add to your path. The reason is that Windows contains paths that may include spaces and that clashes with the way conda understands paths.) - If you do have anaconda consider upgrading it so you get the latest version of the packages: conda update conda Conda allows you to work in 'computing sandboxes' called environments. You may have environments installed on your computer to access different versions of Python and different libraries to avoid conflict between libraries which can cause errors. NOTE (Sept.6, 2019): If you are still having issues please check the Announcements and the Discussion Forum (Ed) via the 2019-CS109a Canvas site Also please check the latest version of the cs109a.yml file. We have edited it as of today. What are environments and do I need them? Environments in Python are like sandboxes that have different versions of Python and/or packages installed in them. You can create, export, list, remove, and update environments. Switching or moving between environments is called activating the environment. When you are done with an environments you may deactivate it. For this class we want to have a bit more control on the packages that will be installed with the enviromnent so we will create an environment with a so called YAML file called cs109a.yml . Originally YAML was said to mean Yet Another Markup Language referencing its purpose as a markup language with the yet another construct, but it was then repurposed as YAML Ain't Markup Language [source:wikipedia]. This is included in the Lab directory in the class git repository. Creating an environment from an environment.yml file Using your browser, visit the class git repository https://github.com/Harvard-IACS/2019-CS109A Go to content --> labs/ --> lab1 and look for the cs109a.yml file. Download it to a local directory in your computer. Then in the Terminal again type conda env create -f {PATH-TO-FILE}/cs109a.yml Activate the new environment: source activate cs109a You should see the name of the environment at the start of your command prompth in parenthesis. Verify that the new environment was installed correctly: conda list This will give you a list of the packages installed in this environment. References Manage conda environments Clone the class repository In the Terminal type: git clone https://github.com/Harvard-IACS/2019-CS109A.git Starting the Jupyter Notebook Once all is installed go in the Terminal and type jupyter notebook to start the jupyter notebook server. This will spawn a process that will be running in the Terminal window until you are done working with the notebook. In that case press control-C to stop it. Starting the notebook will bring up a browser window with your file structure. Look for the 2019-CS109A folder. It should be where you cloned it previously. When you visit this folder in the future, and while in the top folder of it, type git pull This will update the contents of the folder with whatever is new. Make sure you are at the top part of the folder by typing pwd which should give you /2019-CS109A/ For more on using the Notebook see : https://jupyter-notebook.readthedocs.io/en/latest/ Part 2: Getting Started with Python Importing modules All notebooks should begin with code that imports modules , collections of built-in, commonly-used Python functions. Below we import the Numpy module, a fast numerical programming library for scientific computing. Future labs will require additional modules, which we'll import with the same syntax. import MODULE_NAME as MODULE_NICKNAME In [3]: import numpy as np #imports a fast numerical programming library Now that Numpy has been imported, we can access some useful functions. For example, we can use mean to calculate the mean of a set of numbers. In [4]: my_list = [ 1.2 , 2 , 3.3 ] np . mean ( my_list ) Out[4]: 2.1666666666666665 Calculations and variables In [5]: # // is integer division 1 / 2 , 1 // 2 , 1.0 / 2 , 3 * 3.2 Out[5]: (0, 0, 0.5, 9.600000000000001) The last line in a cell is returned as the output value, as above. For cells with multiple lines of results, we can display results using print , as can be seen below. In [6]: print ( 1 + 3.0 , \" \\n \" , 9 , 7 ) 5 / 3 (4.0, '\\n', 9, 7) Out[6]: 1 We can store integer or floating point values as variables. The other basic Python data types -- booleans, strings, lists -- can also be stored as variables. In [7]: a = 1 b = 2.0 Here is the storing of a list In [1]: a = [ 1 , 2 , 3 ] Think of a variable as a label for a value, not a box in which you put the value (image: Fluent Python by Luciano Ramalho) In [2]: b = a b Out[2]: [1, 2, 3] This DOES NOT create a new copy of a . It merely puts a new label on the memory at a, as can be seen by the following code: In [3]: print ( \"a\" , a ) print ( \"b\" , b ) a [ 1 ] = 7 print ( \"a after change\" , a ) print ( \"b after change\" , b ) a [1, 2, 3] b [1, 2, 3] a after change [1, 7, 3] b after change [1, 7, 3] Tuples Multiple items on one line in the interface are returned as a tuple , an immutable sequence of Python objects. See the end of this notebook for an interesting use of tuples . In [10]: a = 1 b = 2.0 a + a , a - b , b * b , 10 * a Out[10]: (2, -1.0, 4.0, 10) type() We can obtain the type of a variable, and use boolean comparisons to test these types. VERY USEFUL when things go wrong and you cannot understand why this method does not work on a specific variable! In [11]: type ( a ) == float Out[11]: False In [12]: type ( a ) == int Out[12]: True In [13]: type ( a ) Out[13]: int For reference, below are common arithmetic and comparison operations. EXERCISE 1: Create a tuple called `tup` with the following seven objects: The first element is an integer of your choice The second element is a float of your choice The third element is the sum of the first two elements The fourth element is the difference of the first two elements The fifth element is the first element divided by the second element Display the output of tup . What is the type of the variable tup ? What happens if you try and chage an item in the tuple? In [6]: # your code here tup = ( 1 , 1.1 , 1 + 1.1 , 1 - 1.1 , 1 / 1.1 ) print ( tup ) print ( type ( tup )) (1, 1.1, 2.1, -0.10000000000000009, 0.9090909090909091) In [73]: # TO RUN THE SOLUTIONS # 1. uncomment the first line of the cell below so you have just %load # 2. Run the cell AGAIN to execute the python code, it will not run when you execute the %load command!! In [8]: # %load ../solutions/exercise1.py a = 3 b = 4.0 c = a + b d = a - b e = a / b tup = ( a , b , c , d , e ) tup Out[8]: (3, 4.0, 7.0, -1.0, 0.75) Lists Much of Python is based on the notion of a list. In Python, a list is a sequence of items separated by commas, all within square brackets. The items can be integers, floating points, or another type. Unlike in C arrays, items in a Python list can be different types, so Python lists are more versatile than traditional arrays in C or other languages. Let's start out by creating a few lists. In [16]: empty_list = [] float_list = [ 1. , 3. , 5. , 4. , 2. ] int_list = [ 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 ] mixed_list = [ 1 , 2. , 3 , 4. , 5 ] print ( empty_list ) print ( int_list ) print ( mixed_list , float_list ) [] [1, 2, 3, 4, 5, 6, 7, 8, 9, 10] ([1, 2.0, 3, 4.0, 5], [1.0, 3.0, 5.0, 4.0, 2.0]) Lists in Python are zero-indexed, as in C. The first entry of the list has index 0, the second has index 1, and so on. In [17]: print ( int_list [ 0 ]) print ( float_list [ 1 ]) 1 3.0 What happens if we try to use an index that doesn't exist for that list? Python will complain! In [18]: print ( float_list [ 10 ]) --------------------------------------------------------------------------- IndexError Traceback (most recent call last) in () ----> 1 print ( float_list [ 10 ] ) IndexError : list index out of range You can find the length of a list using the built-in function len : In [19]: print ( float_list ) len ( float_list ) [1.0, 3.0, 5.0, 4.0, 2.0] Out[19]: 5 Indexing on lists plus Slicing And since Python is zero-indexed, the last element of float_list is In [20]: float_list [ len ( float_list ) - 1 ] Out[20]: 2.0 It is more idiomatic in Python to use -1 for the last element, -2 for the second last, and so on In [21]: float_list [ - 1 ] Out[21]: 2.0 We can use the : operator to access a subset of the list. This is called slicing. In [22]: print ( float_list [ 1 : 5 ]) print ( float_list [ 0 : 2 ]) [3.0, 5.0, 4.0, 2.0] [1.0, 3.0] Below is a summary of list slicing operations: In [24]: lst = [ 'hi' , 7 , 'c' , 'cat' , 'hello' , 8 ] lst [: 2 ] Out[24]: ['hi', 7] You can slice \"backwards\" as well: In [25]: float_list [: - 2 ] # up to second last Out[25]: [1.0, 3.0, 5.0] In [26]: float_list [: 4 ] # up to but not including 5th element Out[26]: [1.0, 3.0, 5.0, 4.0] You can also slice with a stride: In [27]: float_list [: 4 : 2 ] # above but skipping every second element Out[27]: [1.0, 5.0] We can iterate through a list using a loop. Here's a for loop. In [28]: for ele in float_list : print ( ele ) 1.0 3.0 5.0 4.0 2.0 What if you wanted the index as well? Use the built-in python method enumerate , which can be used to create a list of tuples with each tuple of the form (index, value) . In [29]: for i , ele in enumerate ( float_list ): print ( i , ele ) (0, 1.0) (1, 3.0) (2, 5.0) (3, 4.0) (4, 2.0) Appending and deleting We can also append items to the end of the list using the + operator or with append . In [30]: float_list + [ . 333 ] Out[30]: [1.0, 3.0, 5.0, 4.0, 2.0, 0.333] In [31]: float_list . append ( . 444 ) In [32]: print ( float_list ) len ( float_list ) [1.0, 3.0, 5.0, 4.0, 2.0, 0.444] Out[32]: 6 Now, run the cell with float_list.append() a second time. Then run the subsequent cell. What happens? To remove an item from the list, use del. In [33]: del ( float_list [ 2 ]) print ( float_list ) [1.0, 3.0, 4.0, 2.0, 0.444] You may also add an element (elem) in a specific position (index) in the list In [34]: elem = '3.14' index = 1 float_list . insert ( index , elem ) float_list Out[34]: [1.0, '3.14', 3.0, 4.0, 2.0, 0.444] List Comprehensions Lists can be constructed in a compact way using a list comprehension . Here's a simple example. In [35]: squaredlist = [ i * i for i in int_list ] squaredlist Out[35]: [1, 4, 9, 16, 25, 36, 49, 64, 81, 100] And here's a more complicated one, requiring a conditional. In [36]: comp_list1 = [ 2 * i for i in squaredlist if i % 2 == 0 ] print ( comp_list1 ) [8, 32, 72, 128, 200] This is entirely equivalent to creating comp_list1 using a loop with a conditional, as below: In [37]: comp_list2 = [] for i in squaredlist : if i % 2 == 0 : comp_list2 . append ( 2 * i ) print ( comp_list2 ) [8, 32, 72, 128, 200] The list comprehension syntax [expression for item in list if conditional] is equivalent to the syntax for item in list: if conditional: expression Exercise 2: (do at home) Build a list that contains every prime number between 1 and 100, in two different ways: 2.1 Using for loops and conditional if statements. 2.2 (Stretch Goal) Using a list comprehension. You should be able to do this in one line of code. Hint: it might help to look up the function all() in the documentation. In [14]: primes = [] for i in range ( 1 , 101 ): if sum ([( i % p ) == 0 for p in primes ]) > 0 : continue if i != 1 : primes . append ( i ) primes Out[14]: [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97] In [18]: [ i for i in range ( 2 , 101 ) if all ( i % j != 0 for j in range ( 2 , i ))] Out[18]: [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97] In [ ]: # %load ../solutions/exercise2_1.py N = 100 ; # using loops and if statements primes = []; for j in range ( 2 , N ): count = 0 ; for i in range ( 2 , j ): if j % i == 0 : count = count + 1 ; if count == 0 : primes . append ( j ) print ( primes ) In [ ]: # %load ../solutions/exercise2_2.py primes_lc = [ j for j in range ( 2 , N ) if all ( j % i != 0 for i in range ( 2 , j ))] print ( primes ) print ( primes_lc ) Simple Functions A function object is a reusable block of code that does a specific task. Functions are commonplace in Python, either on their own or as they belong to other objects. To invoke a function func , you call it as func(arguments) . We've seen built-in Python functions and methods (details below). For example, len() and print() are built-in Python functions. And at the beginning, you called np.mean() to calculate the mean of three numbers, where mean() is a function in the numpy module and numpy was abbreviated as np . This syntax allows us to have multiple \"mean\" functions in different modules; calling this one as np.mean() guarantees that we will execute numpy's mean function, as opposed to a mean function from a different module. User-defined functions We'll now learn to write our own user-defined functions. Below is the syntax for defining a basic function with one input argument and one output. You can also define functions with no input or output arguments, or multiple input or output arguments. def name_of_function(arg): ... return(output) We can write functions with one input and one output argument. Here are two such functions. In [42]: def square ( x ): x_sqr = x * x return ( x_sqr ) def cube ( x ): x_cub = x * x * x return ( x_cub ) square ( 5 ), cube ( 5 ) Out[42]: (25, 125) What if you want to return two variables at a time? The usual way is to return a tuple: In [43]: def square_and_cube ( x ): x_cub = x * x * x x_sqr = x * x return ( x_sqr , x_cub ) square_and_cube ( 5 ) Out[43]: (25, 125) Lambda functions Often we quickly define mathematical functions with a one-line function called a lambda function. Lambda functions are great because they enable us to write functions without having to name them, ie, they're anonymous . No return statement is needed. In [44]: # create an anonymous function and assign it to the variable square square = lambda x : x * x print ( square ( 3 )) hypotenuse = lambda x , y : x * x + y * y ## Same as # def hypotenuse(x, y): # return(x*x + y*y) hypotenuse ( 3 , 4 ) 9 Out[44]: 25 Methods A function that belongs to an object is called a method . By \"object,\" we mean an \"instance\" of a class (e.g., list, integer, or floating point variable). For example, when we invoke append() on an existing list, append() is a method. In other words, a method is a function on a specific instance of a class (i.e., object ). In this example, our class is a list. float_list is an instance of a list (thus, an object), and the append() function is technically a method since it pertains to the specific instance float_list . In [45]: float_list = [ 1.0 , 2.09 , 4.0 , 2.0 , 0.444 ] print ( float_list ) float_list . append ( 56.7 ) float_list [1.0, 2.09, 4.0, 2.0, 0.444] Out[45]: [1.0, 2.09, 4.0, 2.0, 0.444, 56.7] Exercise 3: (do at home) generated a list of the prime numbers between 1 and 100 In Exercise 2, above, you wrote code that generated a list of the prime numbers between 1 and 100. Now, write a function called isprime() that takes in a positive integer $N$, and determines whether or not it is prime. Return True if it's prime and return False if it isn't. Then, using a list comprehension and isprime() , create a list myprimes that contains all the prime numbers less than 100. In [19]: # your code here def isprime ( n ): return all ([ n % i != 0 for i in range ( 2 , n )]) In [26]: [ n for n in range ( 2 , 100 ) if isprime ( n )] Out[26]: [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97] In [ ]: # %load ../solutions/exercise3.py def isprime ( N ): count = 0 ; if not isinstance ( N , int ): return False if N <= 1 : return False for i in range ( 2 , N ): if N % i == 0 : count = count + 1 ; if count == 0 : return ( True ) else : return ( False ) print ( isprime ( 3.0 ), isprime ( \"pavlos\" ), isprime ( 0 ), isprime ( - 1 ), isprime ( 1 ), isprime ( 2 ), isprime ( 93 ), isprime ( 97 )) myprimes = [ j for j in range ( 1 , 100 ) if isprime ( j )] print ( myprimes ) Introduction to Numpy Scientific Python code uses a fast array structure, called the numpy array. Those who have programmed in Matlab will find this very natural. For reference, the numpy documention can be found here . Let's make a numpy array: In [48]: my_array = np . array ([ 1 , 2 , 3 , 4 ]) my_array Out[48]: array([1, 2, 3, 4]) In [49]: # works as it would with a standard list len ( my_array ) Out[49]: 4 The shape array of an array is very useful (we'll see more of it later when we talk about 2D arrays -- matrices -- and higher-dimensional arrays). In [50]: my_array . shape Out[50]: (4,) Numpy arrays are typed . This means that by default, all the elements will be assumed to be of the same type (e.g., integer, float, String). In [51]: my_array . dtype Out[51]: dtype('int64') Numpy arrays have similar functionality as lists! Below, we compute the length, slice the array, and iterate through it (one could identically perform the same with a list). In [52]: print ( len ( my_array )) print ( my_array [ 2 : 4 ]) for ele in my_array : print ( ele ) 4 [3 4] 1 2 3 4 There are two ways to manipulate numpy arrays a) by using the numpy module's methods (e.g., np.mean() ) or b) by applying the function np.mean() with the numpy array as an argument. In [53]: print ( my_array . mean ()) print ( np . mean ( my_array )) 2.5 2.5 A constructor is a general programming term that refers to the mechanism for creating a new object (e.g., list, array, String). There are many other efficient ways to construct numpy arrays. Here are some commonly used numpy array constructors. Read more details in the numpy documentation. In [54]: np . ones ( 10 ) # generates 10 floating point ones Out[54]: array([ 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]) Numpy gains a lot of its efficiency from being typed. That is, all elements in the array have the same type, such as integer or floating point. The default type, as can be seen above, is a float. (Each float uses either 32 or 64 bits of memory, depending on if the code is running a 32-bit or 64-bit machine, respectively). In [55]: np . dtype ( float ) . itemsize # in bytes (remember, 1 byte = 8 bits) Out[55]: 8 In [56]: np . ones ( 10 , dtype = 'int' ) # generates 10 integer ones Out[56]: array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1]) In [57]: np . zeros ( 10 ) Out[57]: array([ 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]) Often, you will want random numbers. Use the random constructor! In [58]: np . random . random ( 10 ) # uniform from [0,1] Out[58]: array([ 0.85115672, 0.37346821, 0.3298871 , 0.47496563, 0.69940192, 0.97207796, 0.91488615, 0.36063927, 0.81240722, 0.16128617]) You can generate random numbers from a normal distribution with mean 0 and variance 1: In [59]: normal_array = np . random . randn ( 1000 ) print ( \"The sample mean and standard devation are %f and %f , respectively.\" % ( np . mean ( normal_array ), np . std ( normal_array ))) The sample mean and standard devation are 0.025195 and 1.026880, respectively. In [60]: len ( normal_array ) Out[60]: 1000 You can sample with and without replacement from an array. Let's first construct a list with evenly-spaced values: In [61]: grid = np . arange ( 0. , 1.01 , 0.1 ) grid Out[61]: array([ 0. , 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1. ]) Without replacement In [62]: np . random . choice ( grid , 5 , replace = False ) Out[62]: array([ 0.3, 0.8, 0.7, 1. , 0. ]) In [63]: np . random . choice ( grid , 20 , replace = False ) --------------------------------------------------------------------------- ValueError Traceback (most recent call last) in () ----> 1 np . random . choice ( grid , 20 , replace = False ) mtrand.pyx in mtrand.RandomState.choice () ValueError : Cannot take a larger sample than population when 'replace=False' With replacement: In [64]: np . random . choice ( grid , 20 , replace = True ) Out[64]: array([ 0. , 1. , 0.3, 1. , 0. , 0.9, 1. , 0.7, 0.2, 0.7, 0.4, 0.6, 0.1, 0.6, 0.4, 0.3, 0.6, 0.3, 0.8, 1. ]) Tensors We can think of tensors as a name to include multidimensional arrays of numerical values. While tensors first emerged in the 20th century, they have since been applied to numerous other disciplines, including machine learning. In this class you will only be using scalars , vectors , and 2D arrays , so you do not need to worry about the name 'tensor'. We will use the following naming conventions: scalar = just a number = rank 0 tensor ($a$ ∈ $F$,) vector = 1D array = rank 1 tensor ( $x = (\\;x_1,...,x_i\\;)⊤$ ∈ $F&#94;n$ ) matrix = 2D array = rank 2 tensor ( $\\textbf{X} = [a_{ij}] ∈ F&#94;{m×n}$ ) 3D array = rank 3 tensor ( $\\mathscr{X} =[t_{i,j,k}]∈F&#94;{m×n×l}$ ) $\\mathscr{N}$D array = rank $\\mathscr{N}$ tensor ( $\\mathscr{T} =[t_{i1},...,t_{i\\mathscr{N}}]∈F&#94;{n_1×...×n_\\mathscr{N}}$ ) Slicing a 2D array source:oreilly In [ ]: # how do we get just the second row of the above array? Numpy supports vector operations What does this mean? It means that instead of adding two arrays, element by element, you can just say: add the two arrays. In [ ]: first = np . ones ( 5 ) second = np . ones ( 5 ) first + second # adds in-place Note that this behavior is very different from python lists where concatenation happens. In [ ]: first_list = [ 1. , 1. , 1. , 1. , 1. ] second_list = [ 1. , 1. , 1. , 1. , 1. ] first_list + second_list # concatenation On some computer chips, this numpy addition actually happens in parallel and can yield significant increases in speed. But even on regular chips, the advantage of greater readability is important. Broadcasting Numpy supports a concept known as broadcasting , which dictates how arrays of different sizes are combined together. There are too many rules to list here, but importantly, multiplying an array by a number multiplies each element by the number. Adding a number adds the number to each element. In [ ]: first + 1 In [ ]: first * 5 This means that if you wanted the distribution $N(5, 7)$ you could do: In [ ]: normal_5_7 = 5 + 7 * normal_array np . mean ( normal_5_7 ), np . std ( normal_5_7 ) Multiplying two arrays multiplies them element-by-element In [ ]: ( first + 1 ) * ( first * 5 ) You might have wanted to compute the dot product instead: In [ ]: np . dot (( first + 1 ) , ( first * 5 )) Probabilitiy Distributions from scipy.stats and statsmodels Two useful statistics libraries in python are scipy and statsmodels . For example to load the z_test: In [ ]: import statsmodels from statsmodels.stats.proportion import proportions_ztest In [ ]: x = np . array ([ 74 , 100 ]) n = np . array ([ 152 , 266 ]) zstat , pvalue = statsmodels . stats . proportion . proportions_ztest ( x , n ) print ( \"Two-sided z-test for proportions: \\n \" , \"z =\" , zstat , \", pvalue =\" , pvalue ) In [ ]: #The `%matplotlib inline` ensures that plots are rendered inline in the browser. % matplotlib inline import matplotlib.pyplot as plt Let's get the normal distribution namespace from scipy.stats . See here for Documentation . In [ ]: from scipy.stats import norm Let's create 1,000 points between -10 and 10 In [ ]: x = np . linspace ( - 10 , 10 , 1000 ) # linspace() returns evenly-spaced numbers over a specified interval x [ 0 : 10 ], x [ - 10 :] Let's get the pdf of a normal distribution with a mean of 1 and standard deviation 3, and plot it using the grid points computed before: In [ ]: pdf_x = norm . pdf ( x , 1 , 3 ) plt . plot ( x , pdf_x ); And you can get random variables using the rvs function. Referencies A useful book by Jake Vanderplas: PythonDataScienceHandbook . You may also benefit from using Chris Albon's web site as a reference. It contains lots of useful information. Dictionaries A dictionary is another data structure (aka storage container) -- arguably the most powerful. Like a list, a dictionary is a sequence of items. Unlike a list, a dictionary is unordered and its items are accessed with keys and not integer positions. Dictionaries are the closest data structure we have to a database. Let's make a dictionary with a few Harvard courses and their corresponding enrollment numbers. In [ ]: enroll2017_dict = { 'CS50' : 692 , 'CS109A / Stat 121A / AC 209A' : 352 , 'Econ1011a' : 95 , 'AM21a' : 153 , 'Stat110' : 485 } enroll2017_dict One can obtain the value corresponding to a key via: In [ ]: enroll2017_dict [ 'CS50' ] If you try to access a key that isn't present, your code will yield an error: In [ ]: enroll2017_dict [ 'CS630' ] Alternatively, the .get() function allows one to gracefully handle these situations by providing a default value if the key isn't found: In [ ]: enroll2017_dict . get ( 'CS630' , 5 ) Note, this does not store a new value for the key; it only provides a value to return if the key isn't found. In [ ]: enroll2017_dict [ 'CS630' ] In [ ]: enroll2017_dict . get ( 'C730' , None ) All sorts of iterations are supported: In [ ]: enroll2017_dict . values () In [ ]: enroll2017_dict . items () We can iterate over the tuples obtained above: In [ ]: for key , value in enroll2017_dict . items (): print ( \" %s : %d \" % ( key , value )) Simply iterating over a dictionary gives us the keys. This is useful when we want to do something with each item: In [ ]: second_dict = {} for key in enroll2017_dict : second_dict [ key ] = enroll2017_dict [ key ] second_dict The above is an actual copy of _enroll2017 dict's allocated memory, unlike, second_dict = enroll2017_dict which would have made both variables label the same memory location. In the previous dictionary example, the keys were strings corresponding to course names. Keys don't have to be strings, though; they can be other immutable data type such as numbers or tuples (not lists, as lists are mutable). Dictionary comprehension: \"Do not try this at home\" You can construct dictionaries using a dictionary comprehension , which is similar to a list comprehension. Notice the brackets {} and the use of zip (see next cell for more on zip ) In [ ]: float_list = [ 1. , 3. , 5. , 4. , 2. ] int_list = [ 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 ] my_dict = { k : v for ( k , v ) in zip ( int_list , float_list )} my_dict Creating tuples with zip zip is a Python built-in function that returns an iterator that aggregates elements from each of the iterables. This is an iterator of tuples, where the i-th tuple contains the i-th element from each of the argument sequences or iterables. The iterator stops when the shortest input iterable is exhausted. The set() built-in function returns a set object, optionally with elements taken from another iterable. By using set() you can make zip printable. In the example below, the iterables are the two lists, float_list and int_list . We can have more than two iterables. In [ ]: float_list = [ 1. , 3. , 5. , 4. , 2. ] int_list = [ 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 ] viz_zip = set ( zip ( int_list , float_list )) viz_zip In [ ]: type ( viz_zip ) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab01/"},{"title":"Lecture 1: Data Science Demo","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lecture 1: Example Harvard University Fall 2019 Instructors : Pavlos Protopapas, Kevin Rader, and Chris Tanner In [5]: ## RUN THIS CELL TO GET THE RIGHT FORMATTING from IPython.core.display import HTML def css_styling (): styles = open ( \"../../../styles/cs109.css\" , \"r\" ) . read () return HTML ( styles ) css_styling () Out[5]: h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } In [6]: import pandas as pd import sys import numpy as np import scipy as sp import matplotlib.pyplot as plt from math import radians , cos , sin , asin , sqrt import datetime from sklearn.linear_model import LinearRegression import seaborn as sns sns . set ( style = \"ticks\" ) % matplotlib inline Download the data from https://drive.google.com/open?id=0B28c493CP9GtMzN1emFoMkJNNlU First Look At The Data In [7]: hubway_data_file = '~/Downloads/hubway_data/hubway_trips.csv' hubway_data = pd . read_csv ( hubway_data_file , low_memory = False ) hubway_data . head () Out[7]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } seq_id hubway_id status duration start_date strt_statn end_date end_statn bike_nr subsc_type zip_code birth_date gender 0 1 8 Closed 9 7/28/2011 10:12:00 23.0 7/28/2011 10:12:00 23.0 B00468 Registered '97217 1976.0 Male 1 2 9 Closed 220 7/28/2011 10:21:00 23.0 7/28/2011 10:25:00 23.0 B00554 Registered '02215 1966.0 Male 2 3 10 Closed 56 7/28/2011 10:33:00 23.0 7/28/2011 10:34:00 23.0 B00456 Registered '02108 1943.0 Male 3 4 11 Closed 64 7/28/2011 10:35:00 23.0 7/28/2011 10:36:00 23.0 B00554 Registered '02116 1981.0 Female 4 5 12 Closed 12 7/28/2011 10:37:00 23.0 7/28/2011 10:37:00 23.0 B00554 Registered '97214 1983.0 Female Who? In [8]: year_to_age = lambda s : 0 if 'N' in s else 2017 - int ( s ) In [9]: fig , ax = plt . subplots ( 1 , 2 , figsize = ( 15 , 6 )) gender_counts = np . unique ( hubway_data [ 'gender' ] . replace ( np . nan , 'NaN' , regex = True ) . values , return_counts = True ) ax [ 0 ] . bar ( range ( 3 ), gender_counts [ 1 ], align = 'center' , color = [ 'black' , 'green' , 'teal' ], alpha = 0.5 ) ax [ 0 ] . set_xticks ([ 0 , 1 , 2 ]) ax [ 0 ] . set_xticklabels ([ 'none' , 'male' , 'female' , ' ' ]) ax [ 0 ] . set_title ( 'Users by Gender' ) age_col = 2017.0 - hubway_data [ 'birth_date' ] . dropna () . values age_counts = np . unique ( age_col , return_counts = True ) ax [ 1 ] . bar ( age_counts [ 0 ], age_counts [ 1 ], align = 'center' , width = 0.4 , alpha = 0.6 ) ax [ 1 ] . axvline ( x = np . mean ( age_col ), color = 'red' , label = 'average age' ) ax [ 1 ] . axvline ( x = np . percentile ( age_col , 25 ), color = 'red' , linestyle = '--' , label = 'lower quartile' ) ax [ 1 ] . axvline ( x = np . percentile ( age_col , 75 ), color = 'red' , linestyle = '--' , label = 'upper quartile' ) ax [ 1 ] . set_xlim ([ 1 , 90 ]) ax [ 1 ] . set_xlabel ( 'Age' ) ax [ 1 ] . set_ylabel ( 'Number of Checkouts' ) ax [ 1 ] . legend () ax [ 1 ] . set_title ( 'Users by Age' ) plt . tight_layout () plt . savefig ( 'Who.png' , dpi = 300 ) Where In [11]: station_data = pd . read_csv ( 'hubway_stations.csv' , low_memory = False )[[ 'id' , 'lat' , 'lng' ]] station_data . head () Out[11]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } id lat lng 0 3 42.340021 -71.100812 1 4 42.345392 -71.069616 2 5 42.341814 -71.090179 3 6 42.361285 -71.065140 4 7 42.353412 -71.044624 In [12]: hubway_data_with_gps = hubway_data . join ( station_data . set_index ( 'id' ), on = 'strt_statn' ) hubway_data_with_gps . head () Out[12]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } seq_id hubway_id status duration start_date strt_statn end_date end_statn bike_nr subsc_type zip_code birth_date gender lat lng 0 1 8 Closed 9 7/28/2011 10:12:00 23 7/28/2011 10:12:00 23.0 B00468 Registered '97217 1976.0 Male 42.359677 -71.059364 1 2 9 Closed 220 7/28/2011 10:21:00 23 7/28/2011 10:25:00 23.0 B00554 Registered '02215 1966.0 Male 42.359677 -71.059364 2 3 10 Closed 56 7/28/2011 10:33:00 23 7/28/2011 10:34:00 23.0 B00456 Registered '02108 1943.0 Male 42.359677 -71.059364 3 4 11 Closed 64 7/28/2011 10:35:00 23 7/28/2011 10:36:00 23.0 B00554 Registered '02116 1981.0 Female 42.359677 -71.059364 4 5 12 Closed 12 7/28/2011 10:37:00 23 7/28/2011 10:37:00 23.0 B00554 Registered '97214 1983.0 Female 42.359677 -71.059364 When In [13]: #check_out_times = pd.to_datetime(hubway_data['start_date']) check_out_hours = hubway_data [ 'start_date' ] . apply ( lambda s : int ( s [ - 8 : - 6 ])) In [14]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 5 )) check_out_counts = np . unique ( check_out_hours , return_counts = True ) ax . bar ( check_out_counts [ 0 ], check_out_counts [ 1 ], align = 'center' , width = 0.4 , alpha = 0.6 ) ax . set_xlim ([ - 1 , 24 ]) ax . set_xticks ( range ( 24 )) ax . set_xlabel ( 'Hour of Day' ) ax . set_ylabel ( 'Number of Checkouts' ) ax . set_title ( 'Time of Day vs Checkouts' ) plt . show () How In [15]: def haversine ( pt , lat2 = 42.355589 , lon2 =- 71.060175 ): \"\"\" Calculate the great circle distance between two points on the earth (specified in decimal degrees) \"\"\" lon1 = pt [ 0 ] lat1 = pt [ 1 ] # convert decimal degrees to radians lon1 , lat1 , lon2 , lat2 = map ( radians , [ lon1 , lat1 , lon2 , lat2 ]) # haversine formula dlon = lon2 - lon1 dlat = lat2 - lat1 a = sin ( dlat / 2 ) ** 2 + cos ( lat1 ) * cos ( lat2 ) * sin ( dlon / 2 ) ** 2 c = 2 * asin ( sqrt ( a )) r = 3956 # Radius of earth in miles return c * r In [16]: station_counts = np . unique ( hubway_data_with_gps [ 'strt_statn' ] . dropna (), return_counts = True ) counts_df = pd . DataFrame ({ 'id' : station_counts [ 0 ], 'checkouts' : station_counts [ 1 ]}) counts_df = counts_df . join ( station_data . set_index ( 'id' ), on = 'id' ) counts_df . head () Out[16]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } checkouts id lat lng 0 9734 3 42.340021 -71.100812 1 18058 4 42.345392 -71.069616 2 10630 5 42.341814 -71.090179 3 23322 6 42.361285 -71.065140 4 9163 7 42.353412 -71.044624 In [17]: counts_df . loc [:, 'dist_to_center' ] = list ( map ( haversine , counts_df [[ 'lng' , 'lat' ]] . values )) counts_df . head () Out[17]: .dataframe thead tr:only-child th { text-align: right; } .dataframe thead th { text-align: left; } .dataframe tbody tr th { vertical-align: top; } checkouts id lat lng dist_to_center 0 9734 3 42.340021 -71.100812 2.335706 1 18058 4 42.345392 -71.069616 0.853095 2 10630 5 42.341814 -71.090179 1.802423 3 23322 6 42.361285 -71.065140 0.467803 4 9163 7 42.353412 -71.044624 0.807582 In [18]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 5 )) ax . scatter ( counts_df [ 'dist_to_center' ] . values , counts_df [ 'checkouts' ] . values ) reg_line = LinearRegression () reg_line . fit ( counts_df [ 'dist_to_center' ] . values . reshape (( len ( counts_df [ 'dist_to_center' ]), 1 )), counts_df [ 'checkouts' ] . values ) distances = np . linspace ( counts_df [ 'dist_to_center' ] . min (), counts_df [ 'dist_to_center' ] . max (), 50 ) ax . plot ( distances , reg_line . predict ( distances . reshape (( len ( distances ), 1 ))), color = 'red' , label = 'Regression Line' ) ax . set_xlabel ( 'Distance to City Center (Miles)' ) ax . set_ylabel ( 'Number of Checkouts' ) ax . set_title ( 'Distance to City Center vs Checkouts' ) ax . legend () plt . savefig ( 'How.png' , dpi = 300 ) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lecture-1/notebook/"},{"title":"Lecture 1: Introduction","text":"Slides Lecture 1: Introduction [pptx] Lecture 1: Introduction [pdf] Lecture Notebook Lecture 1: Data Science Demo","tags":"lectures","url":"lectures/lecture1/"},{"title":"Lecture 2: Data and Data Exploration","text":"Slides Lecture 2: Data [pptx] Lecture 2: Data [pdf] Lecture Notebook Lecture 2: Data Science Demo","tags":"lectures","url":"lectures/lecture2/"},{"title":"CS109a: Introduction to Data Science","text":"Fall 2019 Pavlos Protopapas , Kevin A. Rader , and Chris Tanner pre { background-color: #F5F5F5; display: block; font-family: monospace; font-size: 14px; white-space: pre; border-color: #999999; border-width: 1px; border-style: solid; border-radius: 6px; margin: 1em 0; padding: 5px; white-space: pre-wrap; } .containerMain { display: flex; width: 100%; height: 300px; } .contentA { flex: 1; flex-direction:column; } .contentB { flex: 3; } Lab Leaders: Chris Tanner and Eleni Kaxiras Welcome to CS109a/STAT121a/AC209a, also offered by the DCE as CSCI E-109a, Introduction to Data Science. This course is the first half of a one‐year course to data science. We will focus on the analysis of data to perform predictions using statistical and machine learning methods. Topics include data scraping, data management, data visualization, regression and classification methods, and deep neural networks. You will get ample practice through weekly homework assignments. The class material integrates the five key facets of an investigation using data: 1. data collection ‐ data wrangling, cleaning, and sampling to get a suitable data set 2. data management ‐ accessing data quickly and reliably 3. exploratory data analysis – generating hypotheses and building intuition 4. prediction or statistical learning 5. communication – summarizing results through visualization, stories, and interpretable summaries Only one of CS 109a, AC 209a, or Stat 121a can be taken for credit. Students who have previously taken CS 109, AC 209, or Stat 121 cannot take CS 109a, AC 209a, or Stat 121a for credit. Announcement: HW0 is now available. Lectures: Mon and Wed 1:30‐2:45 pm in Harvard Northwest Building, NW B-103 Labs : Thur 4:30-5:45 pm in Pierce 301 Head TFs : Chris Gumb - DCE Head TF : Sol Girouard Office Hours: IACS student lobby in Maxwell-Dworkin's ground. Just follow the signs. Online Office Hours zoom link: https://harvard-dce.zoom.us/j/7607382317 Course material can be viewed in the public GitHub repository . STANDARD SECTIONS Friday 9/20 10:30-11:45 am 1 Story St. Room 306 Monday 9/23 4:30-5:45 pm Science Center 110 Cover the material presented in class. Both standard sections are identical. ADVANCED SECTIONS Wednesday 9/25 4:30-5:45 pm Maxwell Dworkin G115 Cover a different topic each week and are required for 209a students. Instructor Office Hours Pavlos & Kevin : Monday 3-5 pm, IACS Lobby Chris : Wednesday 3-4 pm, Maxwell-Dworkin B125 TF Office Hours (On-Campus) Monday: 6-9 pm Tuesday: 4-8:30 pm Wednesday: 4-6:30 pm TF Hours are held in the IACS lobby. Note: Monday & Tuesday the first 1/2 hour of OH will be in the Maxwell-Dworkin main lobby before moving into the IACS lobby. Online Office Hours Tuesday: 3-6 pm Friday: 12-1:30 pm Online office hours are held via zoom: https://harvard-dce.zoom.us/j/7607382317 Please be aware, that we will not publicly release the homework assignments this year. If you want to follow the course online without registering, you can use the assignments from 2013 and 2014, available at the links below. Additionally, the material from 2015 is also available. Previous Material 2018 2017 2015 2014 . 2013","tags":"pages","url":"pages/cs109a-introduction-to-data-science/"},{"title":"Advanced Sections 2:","text":"Slides","tags":"a-section","url":"a-section/a-section2/"},{"title":"Advanced Sections 3:","text":"Slides","tags":"a-section","url":"a-section/a-section3/"},{"title":"Advanced Sections 4:","text":"Slides","tags":"a-section","url":"a-section/a-section4/"},{"title":"Advanced Sections 5:","text":"Slides","tags":"a-section","url":"a-section/a-section5/"},{"title":"Advanced Sections 6:","text":"Slides","tags":"a-section","url":"a-section/a-section6/"},{"title":"Lab 10:","text":"Slides","tags":"labs","url":"labs/lab10/"},{"title":"Lab 11:","text":"Slides","tags":"labs","url":"labs/lab11/"},{"title":"Lab 12:","text":"Slides","tags":"labs","url":"labs/lab12/"},{"title":"Lab 13:","text":"Slides","tags":"labs","url":"labs/lab13/"},{"title":"Lab 4:","text":"Slides","tags":"labs","url":"labs/lab4/"},{"title":"Lab 5:","text":"Slides","tags":"labs","url":"labs/lab5/"},{"title":"Lab 6:","text":"Slides","tags":"labs","url":"labs/lab6/"},{"title":"Lab 7:","text":"Slides","tags":"labs","url":"labs/lab7/"},{"title":"Lab 8:","text":"Slides","tags":"labs","url":"labs/lab8/"},{"title":"Lab 9:","text":"Slides","tags":"labs","url":"labs/lab9/"},{"title":"Lecture 10:","text":"Slides","tags":"lectures","url":"lectures/lecture10/"},{"title":"Lecture 11:","text":"Slides","tags":"lectures","url":"lectures/lecture11/"},{"title":"Lecture 12:","text":"Slides","tags":"lectures","url":"lectures/lecture12/"},{"title":"Lecture 13:","text":"Slides","tags":"lectures","url":"lectures/lecture13/"},{"title":"Lecture 14:","text":"Slides","tags":"lectures","url":"lectures/lecture14/"},{"title":"Lecture 15:","text":"Slides","tags":"lectures","url":"lectures/lecture15/"},{"title":"Lecture 16:","text":"Slides","tags":"lectures","url":"lectures/lecture16/"},{"title":"Lecture 17:","text":"Slides","tags":"lectures","url":"lectures/lecture17/"},{"title":"Lecture 18:","text":"Slides","tags":"lectures","url":"lectures/lecture18/"},{"title":"Lecture 19:","text":"Slides","tags":"lectures","url":"lectures/lecture19/"},{"title":"Lecture 20:","text":"Slides","tags":"lectures","url":"lectures/lecture20/"},{"title":"Lecture 21:","text":"Slides","tags":"lectures","url":"lectures/lecture21/"},{"title":"Lecture 22:","text":"Slides","tags":"lectures","url":"lectures/lecture22/"},{"title":"Lecture 23:","text":"Slides","tags":"lectures","url":"lectures/lecture23/"},{"title":"Lecture 24:","text":"Slides","tags":"lectures","url":"lectures/lecture24/"},{"title":"Lecture 6:","text":"Slides","tags":"lectures","url":"lectures/lecture6/"},{"title":"Lecture 7:","text":"Slides","tags":"lectures","url":"lectures/lecture7/"},{"title":"Lecture 8:","text":"Slides","tags":"lectures","url":"lectures/lecture8/"},{"title":"Lecture 9:","text":"Slides","tags":"lectures","url":"lectures/lecture9/"},{"title":"Lab 3: Scikit-learn for Regression","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI colors. */ .ansibold { font-weight: bold; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); } div.cell.jupyter-soft-selected { border-left-color: #90CAF9; border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected { border-color: #ababab; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%); } @media print { div.cell.selected { border-color: transparent; } } div.cell.selected.jupyter-soft-selected { border-left-width: 0; padding-left: 6px; background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%); } .edit_mode div.cell.selected { border-color: #66BB6A; border-left-width: 0px; padding-left: 6px; background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%); } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ padding: 0.4em; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */ /* .CodeMirror-lines */ padding: 0; border: 0; border-radius: 0; } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html td, .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight .hll { background-color: #ffffcc } .highlight { background: #f8f8f8; } .highlight .c { color: #408080; font-style: italic } /* Comment */ .highlight .err { border: 1px solid #FF0000 } /* Error */ .highlight .k { color: #008000; font-weight: bold } /* Keyword */ .highlight .o { color: #666666 } /* Operator */ .highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight .gd { color: #A00000 } /* Generic.Deleted */ .highlight .ge { font-style: italic } /* Generic.Emph */ .highlight .gr { color: #FF0000 } /* Generic.Error */ .highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight .gi { color: #00A000 } /* Generic.Inserted */ .highlight .go { color: #888888 } /* Generic.Output */ .highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight .gs { font-weight: bold } /* Generic.Strong */ .highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight .gt { color: #0044DD } /* Generic.Traceback */ .highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight .kp { color: #008000 } /* Keyword.Pseudo */ .highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight .kt { color: #B00040 } /* Keyword.Type */ .highlight .m { color: #666666 } /* Literal.Number */ .highlight .s { color: #BA2121 } /* Literal.String */ .highlight .na { color: #7D9029 } /* Name.Attribute */ .highlight .nb { color: #008000 } /* Name.Builtin */ .highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight .no { color: #880000 } /* Name.Constant */ .highlight .nd { color: #AA22FF } /* Name.Decorator */ .highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight .nf { color: #0000FF } /* Name.Function */ .highlight .nl { color: #A0A000 } /* Name.Label */ .highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight .nv { color: #19177C } /* Name.Variable */ .highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight .w { color: #bbbbbb } /* Text.Whitespace */ .highlight .mb { color: #666666 } /* Literal.Number.Bin */ .highlight .mf { color: #666666 } /* Literal.Number.Float */ .highlight .mh { color: #666666 } /* Literal.Number.Hex */ .highlight .mi { color: #666666 } /* Literal.Number.Integer */ .highlight .mo { color: #666666 } /* Literal.Number.Oct */ .highlight .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight .sc { color: #BA2121 } /* Literal.String.Char */ .highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight .sx { color: #008000 } /* Literal.String.Other */ .highlight .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight .ss { color: #19177C } /* Literal.String.Symbol */ .highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight .fm { color: #0000FF } /* Name.Function.Magic */ .highlight .vc { color: #19177C } /* Name.Variable.Class */ .highlight .vg { color: #19177C } /* Name.Variable.Global */ .highlight .vi { color: #19177C } /* Name.Variable.Instance */ .highlight .vm { color: #19177C } /* Name.Variable.Magic */ .highlight .il { color: #666666 } /* Literal.Number.Integer.Long */ /* Temporary definitions which will become obsolete with Notebook release 5.0 */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-bold { font-weight: bold; } CS109A Introduction to Data Science Lab 3: Scikit-learn for Regression Harvard University Fall 2018 Instructors: Pavlos Protopapas and Kevin Rader Authors: David Sondak, Will Claybaugh, Eleni Kaxiras In [2]: # RUN THIS CELL TO PROPERLY HIGHLIGHT THE EXERCISES import requests from IPython.core.display import HTML styles = requests . get ( \"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css\" ) . text HTML ( styles ) Out[2]: blockquote { background: #AEDE94; } h1 { padding-top: 25px; padding-bottom: 25px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } h2 { padding-top: 10px; padding-bottom: 10px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } div.exercise { background-color: #ffcccc; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; } span.sub-q { font-weight: bold; } div.theme { background-color: #DDDDDD; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 18pt; } div.gc { background-color: #AEDE94; border-color: #E9967A; border-left: 5px solid #800080; padding: 0.5em; font-size: 12pt; } p.q1 { padding-top: 5px; padding-bottom: 5px; text-align: left; padding-left: 5px; background-color: #EEEEEE; color: black; } header { padding-top: 35px; padding-bottom: 35px; text-align: left; padding-left: 10px; background-color: #DDDDDD; color: black; } Table of Contents Array creation and reshape Some plotting Simple linear regression $k$-nearest neighbors Learning Goals Overall description and goal for the lab. By the end of this lab, you should be able to: Understand array reshaping Review how to make plots Feel comfortable with simple linear regression Feel comfortable with $k$ nearest neighbors This lab corresponds to lecture 4 and maps on to homework 2 (and beyond). In [8]: # import the necessary libraries import warnings warnings . filterwarnings ( 'ignore' ) % matplotlib inline import numpy as np import scipy as sp import matplotlib as mpl import matplotlib.cm as cm import matplotlib.pyplot as plt import pandas as pd import time pd . set_option ( 'display.width' , 500 ) pd . set_option ( 'display.max_columns' , 100 ) pd . set_option ( 'display.notebook_repr_html' , True ) import seaborn as sns Simple Linear Regression Linear regression and its many extensions are a workhorse of the statistics and data science community, both in application and as a reference point for other models. Most of the major concepts in machine learning can be and often are discussed in terms of various linear regression models. Thus, this section will introduce you to building and fitting linear regression models and some of the process behind it, so that you can 1) fit models to data you encounter 2) experiment with different kinds of linear regression and observe their effects 3) see some of the technology that makes regression models work. Linear regression with a toy dataset We first examine a toy problem, focusing our efforts on fitting a linear model to a small dataset with three observations. Each observation consists of one predictor $x_i$ and one response $y_i$ for $i = 1, 2, 3$, \\begin{align*} (x , y) = \\{(x_1, y_1), (x_2, y_2), (x_3, y_3)\\}. \\end{align*} To be very concrete, let's set the values of the predictors and responses. \\begin{equation*} (x , y) = \\{(1, 2), (2, 2), (3, 4)\\} \\end{equation*} There is no line of the form $\\beta_0 + \\beta_1 x = y$ that passes through all three observations, since the data are not collinear. Thus our aim is to find the line that best fits these observations in the least-squares sense , as discussed in lecture. Exercise (10 min) Make two numpy arrays out of this data, x_train and y_train Check the dimentions of these arrays Try to reshape them into a different shape Make points into a very simple scatterplot Make a better scatterplot In [28]: # your code here x_train = np . array ([ 1 , 2 , 3 ]) y_train = np . array ([ 2 , 3 , 6 ]) type ( x_train ) Out[28]: numpy.ndarray In [12]: x_train . shape Out[12]: (3,) In [14]: x_train = x_train . reshape ( 3 , 1 ) x_train . shape Out[14]: (3, 1) In [15]: xx = np . array ([[ 1 , 3 , 5 ],[ 6 , 2 , 1 ]]) xx . shape Out[15]: (2, 3) In [18]: xx = xx . reshape ( 3 , - 1 ) xx Out[18]: array([[1, 3], [5, 6], [2, 1]]) In [29]: # make a simple scatterplot x_train = np . array ([ 1 , 2 , 3 ]) y_train = np . array ([ 2 , 2 , 4 ]) plt . scatter ( x_train , y_train ) # check dimensions print ( x_train . shape , y_train . shape ) (3,) (3,) In [38]: def nice_scatterplot ( x , y , title ): # font size f_size = 18 # make the figure fig , ax = plt . subplots ( 1 , 1 , figsize = ( 8 , 5 )) # Create figure object # set axes limits to make the scale nice ax . set_xlim ( np . min ( x ) - 1 , np . max ( x ) + 1 ) ax . set_ylim ( np . min ( y ) - 1 , np . max ( y ) + 1 ) # adjust size of tickmarks in axes ax . tick_params ( labelsize = f_size ) # remove tick labels ax . tick_params ( labelbottom = False , bottom = False ) # adjust size of axis label ax . set_xlabel ( r '$x$' , fontsize = f_size ) ax . set_ylabel ( r '$y$' , fontsize = f_size ) # set figure title label ax . set_title ( title , fontsize = f_size ) # you may set up grid with this ax . grid ( True , lw = 1.75 , ls = '--' , alpha = 0.15 ) # make actual plot (Notice the label argument!) #ax.scatter(x, y, label=r'$my points$') #ax.scatter(x, y, label='$my points$') ax . scatter ( x , y , label = r '$my\\,points$' ) ax . legend ( loc = 'best' , fontsize = f_size ); return ax nice_scatterplot ( x_train , y_train , 'hello nice plot' ) Out[38]: Formulae Linear regression is special among the models we study beuase it can be solved explicitly. While most other models (and even some advanced versions of linear regression) must be solved itteratively, linear regression has a formula where you can simply plug in the data. For the single predictor case it is: \\begin{align} \\beta_1 &= \\frac{\\sum_{i=1}&#94;n{(x_i-\\bar{x})(y_i-\\bar{y})}}{\\sum_{i=1}&#94;n{(x_i-\\bar{x})&#94;2}}\\\\ \\beta_0 &= \\bar{y} - \\beta_1\\bar{x}\\ \\end{align} Where $\\bar{y}$ and $\\bar{x}$ are the mean of the y values and the mean of the x values, respectively. From the re-aranged second equation we can see that the best-fit line passes through $(\\bar{x},\\bar{y})$, the center of mass of the data From any of the first equations, we can see that the slope of the line has to do with whether or not an x value that is above/below the center of mass is typically paired with a y value that is likewise above/below, or typically paired with one that is opposite. Building a model from scratch In this part, we will solve the equations for simple linear regression and find the best fit solution to our toy problem. The snippets of code below implement the linear regression equations on the observed predictors and responses, which we'll call the training data set. Let's walk through the code. We have to reshape our arrrays to 2D. We will see later why. Exercise (5 min) make an array with shape (2,3) reshape it to a size that you want In [ ]: # your code here xx = np . array ([[ 1 , 2 , 3 ],[ 4 , 6 , 8 ]]) xxx = xx . reshape ( - 1 , 2 ) xxx . shape In [39]: # Reshape to be a proper 2D array x_train = x_train . reshape ( x_train . shape [ 0 ], 1 ) y_train = y_train . reshape ( y_train . shape [ 0 ], 1 ) print ( x_train . shape ) (3, 1) In [40]: # first, compute means y_bar = np . mean ( y_train ) x_bar = np . mean ( x_train ) # build the two terms numerator = np . sum ( ( x_train - x_bar ) * ( y_train - y_bar ) ) denominator = np . sum (( x_train - x_bar ) ** 2 ) print ( numerator . shape , denominator . shape ) #check shapes () () Why the empty brackets? (The numerator and denominator are scalars, as expected.) In [47]: #slope beta1 beta_1 = numerator / denominator #intercept beta0 beta_0 = y_bar - beta_1 * x_bar print ( \"The best-fit line is {0:3.2f} + {1:3.2f} * x\" . format ( beta_0 , beta_1 )) print ( f 'The best fit is {beta_0} ' ) The best-fit line is -0.33 + 2.00 * x The best fit is -0.3333333333333335 Exercise (5 min) Turn the code from the above cells into a function called simple_linear_regression_fit , that inputs the training data and returns beta0 and beta1 . To do this, copy and paste the code from the above cells below and adjust the code as needed, so that the training data becomes the input and the betas become the output. def simple_linear_regression_fit ( x_train : np . ndarray , y_train : np . ndarray ) -> np . ndarray : return Check your function by calling it with the training data from above and printing out the beta values. In [50]: def simple_linear_regression_fit ( x_train : np . ndarray , y_train : np . ndarray ) -> np . ndarray : \"\"\" Inputs: x_train: a (num observations by 1) array holding the values of the predictor variable y_train: a (num observations by 1) array holding the values of the response variable Returns: beta_vals: a (num_features by 1) array holding the intercept and slope coeficients \"\"\" # Check input array sizes if len ( x_train . shape ) < 2 : print ( \"Reshaping features array.\" ) x_train = x_train . reshape ( x_train . shape [ 0 ], 1 ) if len ( y_train . shape ) < 2 : print ( \"Reshaping observations array.\" ) y_train = y_train . reshape ( y_train . shape [ 0 ], 1 ) # first, compute means y_bar = np . mean ( y_train ) x_bar = np . mean ( x_train ) # build the two terms numerator = np . sum ( ( x_train - x_bar ) * ( y_train - y_bar ) ) denominator = np . sum (( x_train - x_bar ) ** 2 ) #slope beta1 beta_1 = numerator / denominator #intercept beta0 beta_0 = y_bar - beta_1 * x_bar return np . array ([ beta_0 , beta_1 ]) Let's run this function and see the coefficients In [55]: x_train = np . array ([ 1 , 2 , 3 ]) y_train = np . array ([ 2 , 2 , 4 ]) betas = simple_linear_regression_fit ( x_train , y_train ) beta_0 = betas [ 0 ] beta_1 = betas [ 1 ] print ( \"The best-fit line is {0:8.6f} + {1:8.6f} * x\" . format ( beta_0 , beta_1 )) Reshaping features array. Reshaping observations array. The best-fit line is 0.666667 + 1.000000 * x Exercise (5 min) Do the values of beta0 and beta1 seem reasonable? Plot the training data using a scatter plot. Plot the best fit line with beta0 and beta1 together with the training data. In [65]: fig_scat , ax_scat = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) # Plot best-fit line x_train = np . array ([[ 1 , 2 , 3 ]]) . T best_fit = beta_0 + beta_1 * x_train ax_scat . scatter ( x_train , y_train , s = 300 , label = 'Training Data' ) ax_scat . plot ( x_train , best_fit , ls = '--' , label = 'Best Fit Line' ) ax_scat . set_xlabel ( r '$x_ {train} $' ) ax_scat . set_ylabel ( r '$y$' ); The values of beta0 and beta1 seem roughly reasonable. They capture the positive correlation. The line does appear to be trying to get as close as possible to all the points. Building a model with statsmodels and sklearn Now that we can concretely fit the training data from scratch, let's learn two python packages to do it all for us: statsmodels and scikit-learn (sklearn) . Our goal is to show how to implement simple linear regression with these packages. For an important sanity check, we compare the $\\beta$ values from statsmodels and sklearn to the $\\beta$ values that we found from above with our own implementation. For the purposes of this lab, statsmodels and sklearn do the same thing. More generally though, statsmodels tends to be easier for inference [finding the values of the slope and intercept and dicussing uncertainty in those values], whereas sklearn has machine-learning algorithms and is better for prediction [guessing y values for a given x value]. (Note that both packages make the same guesses, it's just a question of which activity they provide more support for. Note: statsmodels and sklearn are different packages! Unless we specify otherwise, you can use either one. Below is the code for statsmodels . Statsmodels does not by default include the column of ones in the $X$ matrix, so we include it manually with sm.add_constant . In [58]: import statsmodels.api as sm In [66]: # create the X matrix by appending a column of ones to x_train X = sm . add_constant ( x_train ) # this is the same matrix as in our scratch problem! print ( X ) # build the OLS model (ordinary least squares) from the training data toyregr_sm = sm . OLS ( y_train , X ) # do the fit and save regression info (parameters, etc) in results_sm results_sm = toyregr_sm . fit () # pull the beta parameters out from results_sm beta0_sm = results_sm . params [ 0 ] beta1_sm = results_sm . params [ 1 ] print ( \"The regression coefficients from the statsmodels package are: beta_0 = {0:8.6f} and beta_1 = {1:8.6f} \" . format ( beta0_sm , beta1_sm )) [[ 1. 1.] [ 1. 2.] [ 1. 3.]] The regression coefficients from the statsmodels package are: beta_0 = 0.666667 and beta_1 = 1.000000 Besides the beta parameters, results_sm contains a ton of other potentially useful information. In [60]: import warnings warnings . filterwarnings ( 'ignore' ) print ( results_sm . summary ()) OLS Regression Results ============================================================================== Dep. Variable: y R-squared: 0.750 Model: OLS Adj. R-squared: 0.500 Method: Least Squares F-statistic: 3.000 Date: Fri, 21 Sep 2018 Prob (F-statistic): 0.333 Time: 11:31:12 Log-Likelihood: -2.0007 No. Observations: 3 AIC: 8.001 Df Residuals: 1 BIC: 6.199 Df Model: 1 Covariance Type: nonrobust ============================================================================== coef std err t P>|t| [0.025 0.975] ------------------------------------------------------------------------------ const 0.6667 1.247 0.535 0.687 -15.181 16.514 x1 1.0000 0.577 1.732 0.333 -6.336 8.336 ============================================================================== Omnibus: nan Durbin-Watson: 3.000 Prob(Omnibus): nan Jarque-Bera (JB): 0.531 Skew: -0.707 Prob(JB): 0.767 Kurtosis: 1.500 Cond. No. 6.79 ============================================================================== Warnings: [1] Standard Errors assume that the covariance matrix of the errors is correctly specified. Now let's turn our attention to the sklearn library. In [67]: from sklearn import linear_model In [68]: # build the least squares model toyregr = linear_model . LinearRegression () # save regression info (parameters, etc) in results_skl results = toyregr . fit ( x_train , y_train ) # pull the beta parameters out from results_skl beta0_skl = toyregr . intercept_ beta1_skl = toyregr . coef_ [ 0 ] print ( \"The regression coefficients from the sklearn package are: beta_0 = {0:8.6f} and beta_1 = {1:8.6f} \" . format ( beta0_skl , beta1_skl )) The regression coefficients from the sklearn package are: beta_0 = 0.666667 and beta_1 = 1.000000 We should feel pretty good about ourselves now, and we're ready to move on to a real problem! The shape of things in scikit-learn Before diving right in to a \"real\" problem, we really ought to discuss more of the details of sklearn . We do this now. Along the way, we'll import the real-world dataset. Scikit-learn is the main python machine learning library. It consists of many learners which can learn models from data, as well as a lot of utility functions such as train_test_split . It can be used in python by the incantation import sklearn . In scikit-learn, an estimator is a Python object that implements the methods fit(X, y) and predict(T) Let's see the structure of scikit-learn needed to make these fits. .fit always takes two arguments: estimator . fit ( Xtrain , ytrain ) We will consider two estimators in this lab: LinearRegression and KNeighborsRegressor . Critically, Xtrain must be in the form of an array of arrays (or a 2x2 array) with the inner arrays each corresponding to one sample, and whose elements correspond to the feature values for that sample (visuals coming in a moment). ytrain on the other hand is a simple array of responses. These are continuous for regression problems. Practice with sklearn We begin by loading up the mtcars dataset and cleaning it up a little bit. In [73]: import pandas as pd #load mtcars dfcars = pd . read_csv ( \"data/mtcars.csv\" ) dfcars = dfcars . rename ( columns = { \"Unnamed: 0\" : \"car name\" }) dfcars . head () Out[73]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } car name mpg cyl disp hp drat wt qsec vs am gear carb 0 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 1 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 2 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 3 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 4 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 Next, let's split the dataset into a training set and test set. In [74]: # split into training set and testing set from sklearn.model_selection import train_test_split #set random_state to get the same split every time traindf , testdf = train_test_split ( dfcars , test_size = 0.2 , random_state = 42 ) In [75]: # testing set is around 20% of the total data; training set is around 80% print ( \"Shape of full dataset is: {0} \" . format ( dfcars . shape )) print ( \"Shape of training dataset is: {0} \" . format ( traindf . shape )) print ( \"Shape of test dataset is: {0} \" . format ( testdf . shape )) Shape of full dataset is: (32, 12) Shape of training dataset is: (25, 12) Shape of test dataset is: (7, 12) Now we have training and test data. We still need to select a predictor and a response from this dataset. Keep in mind that we need to choose the predictor and response from both the training and test set. You will do this in the exercises below. However, we provide some starter code for you to get things going. In [76]: # Extract the response variable that we're interested in y_train = traindf . mpg Notice the shape of y_train . In [77]: np . shape ( y_train ) Out[77]: (25,) Another way to see the shape is to use the shape method. In [78]: y_train . shape Out[78]: (25,) This is not an \"array of arrays\". That's okay! Remember, sklearn requires an array of arrays only for the predictor array! You will have to pay close attention to this in the exercises later. For now, let's discuss two ways out of this debacle. All we'll do is get y_train to be an array of arrays. This doesn't hurt anything because sklearn doesn't care too much about the shape of y_train . First, let's reshape y_train to be an array of arrays using the reshape method. We want the first dimension of y_train to be size $25$ and the second dimension to be size $1$. In [79]: y_train_reshape = y_train . values . reshape ( y_train . shape [ 0 ], 1 ) In [80]: y_train_reshape . shape Out[80]: (25, 1) Notice that y_train.shape[0] gives the size of the first dimension. There's an even easier way to get the correct shape right from the beginning. In [ ]: y_train_reshape = traindf [[ 'mpg' ]] In [ ]: y_train_reshape . shape Finally, there is a nice shortcut to reshaping an array. numpy can infer a dimension based on the other dimensions specified. In [ ]: y_train_reshape = y_train . values . reshape ( - 1 , 1 ) y_train_reshape . shape In this case, we said the second dimension should be size $1$. Since the requirement of the reshape() method is that the requested dimensions be compatible, numpy decides the the first dimension must be size $25$. What would the .shape return if we did y_train.values.reshape(-1,5) ? Okay, enough of that. The whole reason we went through that whole process was to show you how to reshape your data into the correct format. IMPORTANT: Remember that your response variable ytrain can be a vector but your predictor variable xtrain must be an array! Simple linear regression with automobile data We will now use sklearn to predict automobile mileage per gallon (mpg) and evaluate these predictions. We already loaded the data and split them into a training set and a test set. We need to choose the variables that we think will be good predictors for the dependent variable mpg . Exercise (10 min) Pick one variable to use as a predictor for simple linear regression. Create a markdown cell below and discuss your reasons. Justify your choice with some visualizations. Is there a second variable you'd like to use? For example, we're not doing multiple linear regression here, but if we were, is there another variable you'd like to include if we were using two predictors? In [ ]: # Your code here In [82]: y_mpg = dfcars . mpg x_wt = dfcars . wt x_hp = dfcars . hp fig_wt , ax_wt = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax_wt . scatter ( x_wt , y_mpg ) ax_wt . set_xlabel ( r 'Car Weight' ) ax_wt . set_ylabel ( r 'Car MPG' ) fig_hp , ax_hp = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax_hp . scatter ( x_hp , y_mpg ) ax_hp . set_xlabel ( r 'Car HP' ) ax_hp . set_ylabel ( r 'Car MPG' ) Out[82]: Exercise Use sklearn to fit the training data using simple linear regression. Use the model to make mpg predictions on the test set. Plot the data and the prediction. Print out the mean squared error for the training set and the test set and compare. Hints: Use the following to perform the analysis: from sklearn.linear_model import LinearRegression from sklearn.model_selection import train_test_split from sklearn.metrics import mean_squared_error In [83]: from sklearn.linear_model import LinearRegression from sklearn.model_selection import train_test_split from sklearn.metrics import mean_squared_error dfcars = pd . read_csv ( \"data/mtcars.csv\" ) dfcars = dfcars . rename ( columns = { \"Unnamed: 0\" : \"name\" }) dfcars . head () Out[83]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } name mpg cyl disp hp drat wt qsec vs am gear carb 0 Mazda RX4 21.0 6 160.0 110 3.90 2.620 16.46 0 1 4 4 1 Mazda RX4 Wag 21.0 6 160.0 110 3.90 2.875 17.02 0 1 4 4 2 Datsun 710 22.8 4 108.0 93 3.85 2.320 18.61 1 1 4 1 3 Hornet 4 Drive 21.4 6 258.0 110 3.08 3.215 19.44 1 0 3 1 4 Hornet Sportabout 18.7 8 360.0 175 3.15 3.440 17.02 0 0 3 2 In [84]: traindf , testdf = train_test_split ( dfcars , test_size = 0.2 , random_state = 42 ) y_train = np . array ( traindf . mpg ) X_train = np . array ( traindf . wt ) X_train = X_train . reshape ( X_train . shape [ 0 ], 1 ) In [85]: y_test = np . array ( testdf . mpg ) X_test = np . array ( testdf . wt ) X_test = X_test . reshape ( X_test . shape [ 0 ], 1 ) #create linear model regression = LinearRegression () #fit linear model regression . fit ( X_train , y_train ) predicted_y = regression . predict ( X_test ) r2 = regression . score ( X_test , y_test ) print ( r2 ) 0.68797618576 In [86]: print ( regression . score ( X_train , y_train )) print ( mean_squared_error ( predicted_y , y_test )) print ( mean_squared_error ( y_train , regression . predict ( X_train ))) print ( 'Coefficients: \\n ' , regression . coef_ [ 0 ], regression . intercept_ ) 0.770137990979 12.4759856599 7.77369776639 Coefficients: -5.33694140056 36.9373103135 In [87]: fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( y_test , predicted_y , 'o' ) grid = np . linspace ( np . min ( dfcars . mpg ), np . max ( dfcars . mpg ), 100 ) ax . plot ( grid , grid , color = \"black\" ) # 45 degree line ax . set_xlabel ( \"actual y\" ) ax . set_ylabel ( \"predicted y\" ) fig1 , ax1 = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax1 . plot ( dfcars . wt , dfcars . mpg , 'o' ) xgrid = np . linspace ( np . min ( dfcars . wt ), np . max ( dfcars . wt ), 100 ) ax1 . plot ( xgrid , regression . predict ( xgrid . reshape ( 100 , 1 ))) Out[87]: [ ] $k$-nearest neighbors Great, so we did a simple linear regression on the car data. Now that you're familiar with sklearn , you're ready to do a KNN regression. Let's use $5$ nearest neighbors. In [ ]: from sklearn.neighbors import KNeighborsRegressor knnreg = KNeighborsRegressor ( n_neighbors = 5 ) In [ ]: knnreg . fit ( X_train , y_train ) r2 = knnreg . score ( X_test , y_test ) r2 Exercise What is the $R&#94;{2}$ score on the training set? In [ ]: # Your code here In [ ]: # solution knnreg . score ( X_train , y_train ) Lets vary the number of neighbors and see what we get. In [ ]: regdict = {} # Do a bunch of KNN regressions for k in [ 1 , 2 , 4 , 6 , 8 , 10 , 15 ]: knnreg = KNeighborsRegressor ( n_neighbors = k ) knnreg . fit ( X_train , y_train ) regdict [ k ] = knnreg # Store the regressors in a dictionary In [ ]: # Now let's plot it all fig , ax = plt . subplots ( 1 , 1 , figsize = ( 10 , 6 )) ax . plot ( dfcars . wt , dfcars . mpg , 'o' , label = \"data\" ) xgrid = np . linspace ( np . min ( dfcars . wt ), np . max ( dfcars . wt ), 100 ) for k in [ 1 , 2 , 6 , 10 , 15 ]: predictions = regdict [ k ] . predict ( xgrid . reshape ( 100 , 1 )) if k in [ 1 , 6 , 15 ]: ax . plot ( xgrid , predictions , label = \" {} -NN\" . format ( k )) ax . legend (); Notice how the $1$-NN goes through every point on the training set but utterly fails elsewhere. Lets look at the scores on the training set. In [ ]: ks = range ( 1 , 15 ) # Grid of k's scores_train = [] # R2 scores for k in ks : knnreg = KNeighborsRegressor ( n_neighbors = k ) # Create KNN model knnreg . fit ( X_train , y_train ) # Fit the model to training data score_train = knnreg . score ( X_train , y_train ) # Calculate R&#94;2 score scores_train . append ( score_train ) # Plot fig , ax = plt . subplots ( 1 , 1 , figsize = ( 12 , 8 )) ax . plot ( ks , scores_train , 'o-' ) ax . set_xlabel ( r '$k$' ) ax . set_ylabel ( r '$R&#94; {2} $' ) Why do we get a perfect $R&#94;2$ at k=1? Exercise (5 min) Make the same plot as above on the test set. What is the best $k$? In [ ]: ks = range ( 1 , 15 ) # Grid of k's scores_test = [] # R2 scores for k in ks : knnreg = KNeighborsRegressor ( n_neighbors = k ) # Create KNN model knnreg . fit ( X_train , y_train ) # Fit the model to training data score_test = knnreg . score ( X_test , y_test ) # Calculate R&#94;2 score scores_test . append ( score_test ) # Plot fig , ax = plt . subplots ( 1 , 1 , figsize = ( 12 , 8 )) ax . plot ( ks , scores_test , 'o-' , ms = 12 ) ax . set_xlabel ( r '$k$' ) ax . set_ylabel ( r '$R&#94; {2} $' ) if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var mathjaxscript = document.createElement('script'); mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#'; mathjaxscript.type = 'text/javascript'; mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; mathjaxscript[(window.opera ? \"innerHTML\" : \"text\")] = \"MathJax.Hub.Config({\" + \" config: ['MMLorHTML.js'],\" + \" TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },\" + \" jax: ['input/TeX','input/MathML','output/HTML-CSS'],\" + \" extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],\" + \" displayAlign: 'center',\" + \" displayIndent: '0em',\" + \" showMathMenu: true,\" + \" tex2jax: { \" + \" inlineMath: [ ['$','$'] ], \" + \" displayMath: [ ['$$','$$'] ],\" + \" processEscapes: true,\" + \" preview: 'TeX',\" + \" }, \" + \" 'HTML-CSS': { \" + \" linebreaks: { automatic: true, width: '95% container' }, \" + \" styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }\" + \" } \" + \"}); \"; (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript); }","tags":"labs","url":"labs/lab-3/solutions/"}]}